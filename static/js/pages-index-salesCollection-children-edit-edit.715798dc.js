(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-salesCollection-children-edit-edit"],{2980:function(t,e,i){"use strict";var o=i("a868"),n=i.n(o);n.a},"4ae9":function(t,e,i){var o=i("c86c");e=o(!1),e.push([t.i,"uni-page-body[data-v-3636aea8]{background-color:#f6f6f6}body.?%PAGE?%[data-v-3636aea8]{background-color:#f6f6f6}.contain[data-v-3636aea8]{background-color:#f6f6f6}.contain .middle[data-v-3636aea8]{padding-top:%?40?%;background:#fff}.contain .middle .item[data-v-3636aea8]{position:relative;display:flex;height:%?80?%;line-height:%?80?%;padding-left:%?20?%;padding-right:%?20?%}.contain .middle .item[data-v-3636aea8]:last-child{padding-bottom:0}.contain .middle .item .middle-des[data-v-3636aea8]{font-size:%?32?%;width:%?160?%;height:%?80?%;line-height:%?80?%;text-align:right}.contain .middle .item .middle-select[data-v-3636aea8]{flex:1;display:flex;justify-content:space-between;width:%?496?%;font-size:%?30?%;border-radius:5px}.contain .middle .item .middle-select uni-input[data-v-3636aea8]{flex:1;height:%?80?%;line-height:%?80?%;font-size:%?30?%;padding-left:%?20?%}.contain .middle .item .middle-select uni-text[data-v-3636aea8]{color:#ffb822;font-size:%?26?%;padding:0 %?20?%}.contain .middle .item .middle-select uni-image[data-v-3636aea8]{width:%?40?%;height:%?40?%;padding-top:%?20?%}.contain .middle .item .middle-line[data-v-3636aea8]{position:absolute;left:%?20?%;right:%?20?%;bottom:0;height:1px;background-color:#f3f3f3}.contain .middle .item uni-picker[data-v-3636aea8]{padding-left:%?20?%;width:%?496?%}.contain .sweepCode[data-v-3636aea8]{display:flex;justify-content:space-between;padding:0 %?40?%;border-bottom:%?2?% #eee solid;background:#fff}.contain .sweepCode uni-image[data-v-3636aea8]{width:%?48?%;height:%?48?%;padding:%?26?% 0}.contain .shopList[data-v-3636aea8]{margin-bottom:%?40?%;background:#fff}.contain .shopList .order-item[data-v-3636aea8]{position:relative;padding:%?40?%;border-bottom:%?1?% solid #eee}.contain .shopList .order-item .order-item-top[data-v-3636aea8]{flex:1;display:flex;flex-direction:column;align-items:center}.contain .shopList .order-item .order-item-top .order-inside[data-v-3636aea8]{display:flex;box-sizing:border-box;flex-direction:column;justify-content:space-between}.contain .shopList .order-item .order-item-top .inside-left[data-v-3636aea8]{flex:1;box-sizing:border-box}.contain .shopList .order-item .order-item-top .inside-left .order-fir-left[data-v-3636aea8]{font-size:%?32?%;font-weight:500;width:%?350?%}.contain .shopList .order-item .order-item-top .inside-left .fir-left-name[data-v-3636aea8]{display:-webkit-box;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;margin-right:%?10?%;box-sizing:border-box}.contain .shopList .order-item .order-item-top .inside-left .order-sec-left[data-v-3636aea8]{font-size:%?28?%;line-height:%?60?%;color:grey}.contain .shopList .order-item .order-item-top .inside-right[data-v-3636aea8]{width:20%;align-items:flex-end}.contain .shopList .order-item .order-item-top .inside-right .order-fir-right[data-v-3636aea8]{font-size:%?32?%;font-weight:500;display:flex;justify-content:space-between}.contain .shopList .order-item .order-item-top .inside-right .order-sec-right[data-v-3636aea8]{font-size:%?28?%;color:#3378ff}.contain .shopList .order-item .order-item-top .order-item-top-row[data-v-3636aea8]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:100%;font-size:%?28?%;line-height:%?60?%;color:grey}.contain .shopList .order-item .order-item-top .order-item-top-row-remark[data-v-3636aea8]{flex:1;display:flex}.contain .shopList .order-item .order-item-top .order-item-top-row-input[data-v-3636aea8]{flex:1;line-height:1.2}.contain .shopList .order-item .order-item-top .delete[data-v-3636aea8]{color:red;padding:0 10px}.contain .shopList .order-item .order-item-bottom[data-v-3636aea8]{margin-top:%?20?%}.contain .shopList .order-item .order-item-bottom.bottom-fir[data-v-3636aea8]{padding:%?20?%;display:flex;justify-content:space-between;border-top:%?1?% solid #eee}.contain .shopList .order-item .order-item-bottom.bottom-fir .bottom-input[data-v-3636aea8]{flex:1;display:flex;align-items:center;flex-direction:column}.contain .shopList .order-item .order-item-bottom.bottom-fir .bottom-input .bottom-des[data-v-3636aea8]{font-size:%?28?%;color:grey}.contain .shopList .order-item .order-item-bottom.bottom-fir .bottom-input uni-input[data-v-3636aea8]{width:%?120?%;font-size:%?32?%;color:#333;text-align:center;border-bottom:1px solid #ddd}.contain .shopList .order-item .order-item-bottom.bottom-fir .bottom-input .bottom-input-box[data-v-3636aea8]{display:flex;align-items:center;flex-direction:row;margin-top:%?20?%}.contain .shopList .order-item .order-item-bottom .bottom-sec[data-v-3636aea8]{height:%?70?%;line-height:%?70?%;display:flex;font-size:%?28?%;align-items:center;margin-bottom:%?6?%}.contain .shopList .order-item .order-item-bottom .bottom-sec .bottom-sec-des[data-v-3636aea8]{color:grey}.contain .shopList .order-item .order-item-bottom .bottom-sec .send-input[data-v-3636aea8]{display:flex;align-items:center;margin-right:%?20?%}.contain .shopList .order-item .order-item-bottom .bottom-sec .send-input .send-sec-input[data-v-3636aea8]{width:%?150?%;border-bottom:1px solid #eee;text-align:center}.contain .shopList .order-item .order-item-bottom .bottom-sec .bottom-sec-input[data-v-3636aea8]{height:100%;color:grey;font-size:%?28?%;width:100%;flex:1}.contain .shopList .order-item .order-item-foot[data-v-3636aea8]{border-bottom:%?1?% solid #eee}.contain .shopList .order-item .order-item-foot .foot-des[data-v-3636aea8]{margin:0 auto;display:flex;font-size:%?24?%;color:grey;width:20%;justify-content:space-between;padding:%?15?% 0;margin-bottom:%?20?%}.contain .shopList .order-item .order-item-foot .foot-des uni-image[data-v-3636aea8]{width:%?17?%;height:%?10?%;margin-top:%?10?%}.contain .shopList .summary[data-v-3636aea8]{display:flex;align-items:center;padding:%?20?% %?60?%}.contain .shopList .summary .summary-item[data-v-3636aea8]{flex:1;font-size:%?28?%;color:grey;text-align:center}.contain .shopList .summary .summary-item uni-text[data-v-3636aea8]{color:red}.contain .collectionAccountList[data-v-3636aea8]{background-color:#fff;margin-bottom:%?40?%}.contain .collectionAccountList .collectionAccountList-top[data-v-3636aea8]{display:flex;align-items:center;justify-content:space-between;height:%?80?%;padding:0 %?40?%;font-size:%?32?%}.contain .collectionAccountList .collectionAccountList-top uni-image[data-v-3636aea8]{width:%?40?%;height:%?40?%}.contain .collectionAccountList .collectionAccountList-bottom-item[data-v-3636aea8]{padding:%?20?% %?40?%;font-size:%?28?%;color:grey;border-bottom:1px solid #ddd}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row[data-v-3636aea8]{display:flex;align-items:center;justify-content:space-between;margin:%?20?% 0}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .collectionAccountList-bottom-item-row-box[data-v-3636aea8]{display:flex;align-items:center}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .pic[data-v-3636aea8]{flex:1;justify-content:space-between}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .pic .kmName[data-v-3636aea8]{border-bottom:1px solid #ddd}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .pic .kmName uni-input[data-v-3636aea8]{font-size:%?28?%;color:grey}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .pic uni-image[data-v-3636aea8]{width:%?48?%;height:%?48?%}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .debitAmount[data-v-3636aea8]{flex:1;justify-content:center}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .debitAmount uni-input[data-v-3636aea8]{width:%?120?%;height:%?48?%;border-bottom:1px solid #ddd;text-align:center;font-size:%?28?%;color:grey}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .remarks uni-input[data-v-3636aea8]{width:%?420?%;height:%?48?%;border-bottom:1px solid #ddd;font-size:%?28?%;color:grey}.contain .collectionAccountList .collectionAccountList-bottom-item .collectionAccountList-bottom-item-row .delete[data-v-3636aea8]{color:red;padding:8px 10px}.contain .paymentMethod[data-v-3636aea8]{background-color:#fff;margin-bottom:%?40?%;padding:%?40?% %?40?% %?20?%}.contain .paymentMethod .paymentMethod-item[data-v-3636aea8]{display:flex;align-items:center;height:%?80?%;padding-bottom:%?20?%;font-size:%?32?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-name[data-v-3636aea8]{width:%?160?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue[data-v-3636aea8]{flex:1;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-picker[data-v-3636aea8], .contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-input[data-v-3636aea8]{flex:1;height:%?80?%;padding-left:%?20?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue .right[data-v-3636aea8]{width:%?48?%;height:%?48?%}.contain .footfixed[data-v-3636aea8]{display:block;position:fixed;bottom:%?0?%!important;bottom:%?100?%;width:100%;height:%?100?%;background:#fff;z-index:10}.contain .footfixed .foot-bg[data-v-3636aea8]{display:flex}.contain .footfixed .foot-bg .foot-bg-left[data-v-3636aea8]{display:flex;width:70%;font-size:%?32?%;font-weight:500;text-align:center;line-height:%?100?%}.contain .footfixed .foot-bg .foot-bg-left uni-image[data-v-3636aea8]{width:%?48?%;height:%?48?%;margin:%?25?% %?20?% 0 %?90?%}.contain .footfixed .foot-bg .foot-bg-left uni-text[data-v-3636aea8]{color:red}.contain .footfixed .foot-bg .foot-bg-right[data-v-3636aea8]{width:30%;height:%?100?%;line-height:%?100?%;text-align:center;background:#ffb822;font-size:%?32?%;color:#fff}.contain .hide[data-v-3636aea8]{position:inherit;visibility:hidden}",""]),t.exports=e},"5d22":function(t,e,i){"use strict";(function(t){i("6a54");var o=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(i("39d8")),a=o(i("9b1b"));i("e966"),i("aa9c"),i("e838"),i("8f71"),i("bf0f"),i("c223"),i("c9b5"),i("ab80"),i("dd2b");var s,c=o(i("d253")),l=i("8f59"),d=(o(i("63d3")),s={components:{},data:function(){return{pattern:!1,listWlDetailById_id:"",panel:0,organization:{},organizationName:"",organizationId:0,employees:{},handleName:"",handleNameId:0,customer:{},customerName:"",customerId:"",fsId:"",arrears:0,oddNumbers:"",receipt:"",focusinput:!1,absTract:"",createDate:"",createDateF:"",jsId:"",checkStatus:!1,billList:[],collectionAccountList:[],collectionAccountItem:{},collectionAccountUpIndex:-1,allIsSettle:0,allSettlementAmount:0,discountAmount:0,payAmount:0,dictionnaryList:[],dictionnaryIndex:0,getKMListByAvTypeItem:null}},created:function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})},onLoad:function(t){this.pattern="create"===t.pattern,this.listWlDetailById_id="undefined"!==t.id&&void 0!==t.id?parseInt(t.id):"",this.handleNameId="undefined"!==t.jsId&&void 0!==t.jsId?parseInt(t.jsId):"",this.fsId="undefined"!==t.fsId&&void 0!==t.fsId?parseInt(t.fsId):"",this.organizationId="undefined"!==t.orgId&&void 0!==t.orgId?parseInt(t.orgId):"",this.customerId="undefined"!==t.customerId&&void 0!==t.customerId?parseInt(t.customerId):"",this.customerName=t.customerName,this.oddNumbers=t.oddNumbers,this.absTract=t.abstract,this.checkStatus="1"===t.checkStatus,this.pattern?(this.createDate=(new Date).getTime(),this.createDateF=this.timeShift.formatDate(new Date),this.listWlDetailById_id=null,this.oddNumbers=null,this.handleNameId=uni.getStorageSync("userId"),this.handleName=uni.getStorageSync("name")):(this.createDate=t.createDate,this.createDateF=this.timeShift.formatDate(parseInt(t.createDate)),this.initData(),this.listAvDetail(),this.allEmployeesInfo()),this.authorganizationList(),this.dictionnary()},onShow:function(){var t=uni.getStorageSync("billList");t.length>0&&(this.billList=t);var e=uni.getStorageSync("collectionAccountList");e.length>0&&(this.collectionAccountList=e),this.arrearsFn(),this.payAmountFn()},onReady:function(){},onReachBottom:function(){}},(0,n.default)(s,"created",(function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})})),(0,n.default)(s,"mounted",(function(){})),(0,n.default)(s,"computed",{}),(0,n.default)(s,"watch",{organization:function(t){var e=this;null!=t&&t.length>0&&(this.organizationName=t[0].name,this.organizationId=t[0].id,setTimeout((function(){e.initData()}),300))},employees:function(t){null!=t&&t.length>0&&(this.handleName=t[0].name,this.handleNameId=t[0].id)},customer:function(t){var e=this;null!=t&&t.length>0&&(this.customerId=t[0].zbId,this.customerName=t[0].name,this.arrears=t[0].balance,setTimeout((function(){e.initData()}),300))},collectionAccountItem:function(t){var e=this;null!=t&&t.length>0&&setTimeout((function(){var i=e.collectionAccountList[e.collectionAccountUpIndex];i.allId=t[0].allId,i.asId=t[0].id,i.kmName=t[0].name,e.$forceUpdate()}),800)}}),(0,n.default)(s,"methods",(0,a.default)((0,a.default)({},(0,l.mapMutations)(["setparams"])),{},{initData:function(){var t=this;if(t.customerId&&t.organizationId){var e={cId:t.customerId,orgId:t.organizationId};t.listWlDetailById_id&&(e.id=t.listWlDetailById_id),c.default.listWlDetailById(e).then((function(e){if(e.meta.success){for(var i=e.data.all,o=[],n=0;n<i.length;n++){var a=i[n];a.sel&&o.push(a)}t.billList=o,t.arrearsFn(),uni.setStorageSync("billList",t.billList)}else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))}},arrearsFn:function(){this.allIsSettle=0,this.allSettlementAmount=0,this.discountAmount=0;for(var t=0;t<this.billList.length;t++){var e=this.billList[t];this.allIsSettle+=parseFloat(e.isSettle),this.allSettlementAmount+=parseFloat(e.settleAmount),this.discountAmount+=parseFloat(e.preAmount)}},allEmployeesInfo:function(){var t=this;c.default.allEmployeesInfo(null).then((function(e){if(e.meta.success)for(var i=0;i<e.data.list.length;i++){var o=e.data.list[i];t.handleNameId===o.id&&(t.handleName=o.name)}else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},dictionnary:function(){var t=this;c.default.dictionnaryList({dictionaryTypeId:2}).then((function(e){if(e.meta.success)if(t.dictionnaryList=e.data,t.fsId)for(var i=0;i<t.dictionnaryList.length;i++){var o=t.dictionnaryList[i];o.id===t.fsId&&(t.dictionnaryIndex=i)}else t.pattern?t.fsId=t.dictionnaryList[0].id:t.dictionnaryIndex=-1;else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},authorganizationList:function(){var t=this;c.default.authorganizationList(null).then((function(e){if(e.meta.success)if(t.pattern)t.organizationId=e.data[0].id,t.organizationName=e.data[0].name;else for(var i=0;i<e.data.length;i++){var o=e.data[i];o.id===t.organizationId&&(t.organizationName=o.name)}else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})})).then((function(e){t.getKMListByAvType()}))},getKMListByAvType:function(){var t=this,e={direction:"借",orgId:this.organizationId,typeName:"销售收款单",zbId:this.customerId};c.default.getKMListByAvType(e).then((function(e){e.meta.success?t.getKMListByAvTypeItem=e.data[0]:uni.showToast({title:e.meta.message,icon:"none",duration:1e3})})).then((function(e){t.pattern&&t.addCollectionAccount()}))},listAvDetail:function(){var t=this,e={id:t.listWlDetailById_id};c.default.listAvDetailById(e).then((function(e){e.meta.success?(t.collectionAccountList=e.data.avdetail,t.payAmountFn(),uni.setStorageSync("collectionAccountList",t.collectionAccountList)):uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},payAmountFn:function(){this.payAmount=0;for(var t=this.collectionAccountList,e=0;e<t.length;e++){var i=t[e];this.payAmount+=i.debitAmount}},switchPanel:function(t){this.panel=t},bindDateChange:function(t){this.createDate=new Date(t.target.value).getTime(),this.createDateF=t.target.value},organizationList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"organization",filed:"organization"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},handlersList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"employees",filed:"employees"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},customerList:function(){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"getCustomerKMPage",filed:"customer",typeName:"应收账款",orgId:this.organizationId}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},selectListWlDetail:function(t){if(t){var e=this,i={cId:e.customerId,orgId:e.organizationId,code:t};e.listWlDetailById_id&&(i.id=e.listWlDetailById_id),c.default.selectListWlDetail(i).then((function(t){if(t.meta.success){for(var i=function(i){var o=t.data.all[i],n=e.billList.filter((function(t){return t.oddId===o.oddId}));0===n.length&&e.billList.push(o)},o=0;o<t.data.all.length;o++)i(o);e.arrearsFn(),uni.setStorageSync("billList",e.billList)}else uni.showToast({title:t.meta.message,icon:"none",duration:1e3})}))}},orderNumber:function(t){uni.hideKeyboard(),this.organizationId?this.customerId?(this.focusinput=!0,this.$nextTick((function(){this.focusinput=!1,uni.hideKeyboard()})),this.selectListWlDetail(t.detail.value)):uni.showToast({icon:"none",title:"请选择客户",duration:2e3}):uni.showToast({icon:"none",title:"请选择机构",duration:2e3})},toBillList:function(){this.checkStatus&&(this.organizationId?this.customerId?uni.navigateTo({url:"/pages/index/salesCollection/children/billList/billList"+"?id=".concat(this.listWlDetailById_id?this.listWlDetailById_id:"","&orgId=").concat(this.organizationId,"&cId=").concat(this.customerId)}):uni.showToast({title:"请选择客户后再操作",icon:"none",duration:1e3}):uni.showToast({title:"请选择机构后再操作",icon:"none",duration:1e3}))},scanning:function(){var t=this;this.organizationId?this.customerId?uni.scanCode({success:function(e){t.receipt=e.result.toString(),t.selectListWlDetail(e.result.toString())}}):uni.showToast({icon:"none",title:"请选择客户",duration:2e3}):uni.showToast({icon:"none",title:"请选择机构",duration:2e3})},clearInput:function(t){"receipt"===t&&(this.receipt=""),"absTract"===t&&(this.absTract="")},clearValue:function(t,e,i,o){var n=null;if("billList"===i&&(n=this.billList),"collectionAccountList"===i&&(n=this.collectionAccountList),n){var a=n[e];a[o]="",this.$set(n,e,a),this.$forceUpdate()}},setItem:function(t,e,i,o){if("billList"===i){var n=this.billList[e];if("absTract"===o)n[o]!==t.detail.value&&(n[o]=t.detail.value,uni.setStorageSync("billList",this.billList),this.$set(this.billList,e,n));else{var a=parseFloat(t.detail.value).toFixed(3);n[o]!==a&&(n[o]=t.detail.value?a:0,"settleAmount"===o&&(n.preAmount=parseFloat(n.isSettle-n.settleAmount).toFixed(3)),uni.setStorageSync("billList",this.billList),this.$set(this.billList,e,n),this.arrearsFn())}}if("collectionAccountList"===i){n=this.collectionAccountList[e];"remarks"===o?n[o]=t.detail.value:(n[o]=parseFloat(t.detail.value),this.payAmountFn()),this.$set(this.collectionAccountList,e,n),uni.setStorageSync("collectionAccountList",this.collectionAccountList)}},delectItem:function(t,e,i){this.checkStatus&&("billList"===e&&(this.billList.splice(i,1),this.arrearsFn(),uni.setStorageSync("billList",this.billList)),"collectionAccountList"===e&&(this.collectionAccountList.splice(i,1),this.payAmountFn(),uni.setStorageSync("collectionAccountList",this.collectionAccountList)))},closeOpen:function(t,e){this.billList[e].checked=!this.billList[e].checked,this.$forceUpdate()},addCollectionAccount:function(){this.checkStatus&&(this.collectionAccountList.push({pid:this.listWlDetailById_id,zbId:this.customerId,asId:this.getKMListByAvTypeItem.id,allId:"",kmName:this.getKMListByAvTypeItem.name,amount:0,debitAmount:0,discountAmount:this.discountAmount,payAmount:this.payAmount+this.discountAmount,remarks:""}),uni.setStorageSync("collectionAccountList",this.collectionAccountList))},editCollectionAccount:function(t){this.checkStatus&&(this.collectionAccountUpIndex=t,uni.hideKeyboard(),this.setparams({searchtype:"collectionAccount",filed:"collectionAccountItem",direction:"借",orgId:this.organizationId,typeName:"销售收款单",zbId:this.customerId}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},dictionnaryChange:function(t){this.dictionnaryIndex=t.detail.value,this.fsId=this.dictionnaryList[this.dictionnaryIndex].id},creatNewDocm:function(){var e=this;if(e.createDate)if(e.organizationId)if(e.handleNameId)if(e.customerId){e.arrearsFn(),e.payAmountFn();for(var i=[],o=0;o<e.billList.length;o++){var n=e.billList[o];i.push({pid:n.wId,avId:e.listWlDetailById_id,oddId:n.oddId,oddCode:n.oddCode,settlementAmount:n.settleAmount,preferentialAmount:n.preAmount})}for(var a=[],s=0;s<e.collectionAccountList.length;s++){var l=e.collectionAccountList[s];a.push({id:l.id,pid:e.listWlDetailById_id,asId:l.asId,zbId:2,allId:l.allId,amount:l.debitAmount,discountAmount:e.discountAmount,payAmount:e.payAmount+e.discountAmount,remarks:l.remarks})}var d={absTract:e.absTract,createDate:e.createDate,jsId:e.handleNameId,type:0,fsId:e.fsId,oddCode:e.oddNumbers,oddId:e.listWlDetailById_id,orgId:e.organizationId,zbid:e.customerId,avList:a,caList:i};c.default.isSave(d).then((function(i){i.meta.success?(t.log(i.data),setTimeout((function(){i.data.tips?uni.showModal({title:"温馨提示",content:i.data.tips,cancelText:"否",confirmText:"是",confirmColor:"#f1b323",success:function(i){i.confirm?e.saveAvAndCaDetail(d):i.cancel&&t.log("用户点击取消")},fail:function(t){}}):e.saveAvAndCaDetail(d)}),500)):uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))}else uni.showToast({title:"请选择客户",icon:"none",duration:1e3});else uni.showToast({title:"请选择经手人",icon:"none",duration:1e3});else uni.showToast({title:"请选择机构",icon:"none",duration:1e3});else uni.showToast({title:"请选择单据日期",icon:"none",duration:1e3})},saveAvAndCaDetail:function(e){var i=this;c.default.saveAvAndCaDetail(e).then((function(e){e.meta.success?(t.log(e.data),uni.showToast({title:"保存成功",icon:"none",duration:1e3}),i.listWlDetailById_id||(i.listWlDetailById_id=e.data.av.id),uni.removeStorageSync("billList"),uni.removeStorageSync("collectionAccountList"),uni.redirectTo({url:"../billSuccess/billSuccess?saleNo=".concat(e.data.av.oddCode,"&id=").concat(i.listWlDetailById_id,"&absTract=").concat(i.absTract)})):uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))}})),s);e.default=d}).call(this,i("ba7c")["default"])},"6dd9":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"contain"},[i("v-uni-view",{staticClass:"middle"},[i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("单据日期：")]),i("v-uni-view",{staticClass:"middle-select"},[i("v-uni-picker",{attrs:{mode:"date",disabled:!t.checkStatus,value:t.createDateF},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindDateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.createDateF))])],1),i("v-uni-image",{attrs:{src:"/static/img/outNote/data.png",mode:""}})],1),i("v-uni-view",{staticClass:"middle-line"})],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("机构：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.organizationList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择机构",disabled:!0},model:{value:t.organizationName,callback:function(e){t.organizationName=e},expression:"organizationName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),i("v-uni-view",{staticClass:"middle-line"})],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("经手人：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择经手人",disabled:!0},model:{value:t.handleName,callback:function(e){t.handleName=e},expression:"handleName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),i("v-uni-view",{staticClass:"middle-line"})],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("客户：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.customerList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择客户",disabled:!0},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),i("v-uni-view",{staticClass:"middle-line"})],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("单号：")]),i("v-uni-view",{staticClass:"middle-select"},[i("v-uni-input",{attrs:{type:"text",placeholder:"",disabled:!t.checkStatus,focus:t.focusinput},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.clearInput("receipt")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.orderNumber.apply(void 0,arguments)}},model:{value:t.receipt,callback:function(e){t.receipt=e},expression:"receipt"}}),i("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toBillList.apply(void 0,arguments)}}},[t._v("选择单据")])],1),i("v-uni-view",{staticClass:"middle-line"})],1)],1),i("v-uni-view",{staticClass:"sweepCode"},[i("v-uni-image",{attrs:{src:"/static/img/outNote/add.png",mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toBillList.apply(void 0,arguments)}}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/cann.png",mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scanning.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"shopList"},[t._l(t.billList,(function(e,o){return[i("v-uni-view",{key:o,staticClass:"order-item",attrs:{id:"shop_"+e.id}},[i("v-uni-view",{staticClass:"order-item-top"},[i("v-uni-view",{staticClass:"order-item-top-row"},[i("v-uni-view",{staticClass:"order-sec-left"},[t._v("单号："+t._s(e.oddCode))])],1),i("v-uni-view",{staticClass:"order-item-top-row"},[i("v-uni-view",{staticClass:"order-sec-left"},[t._v("日期："+t._s(e.fillDate?t.timeShift.formatDate(e.fillDate):""))])],1),i("v-uni-view",{staticClass:"order-item-top-row"},[i("v-uni-view",{staticClass:"order-sec-left"},[t._v("总金额:￥"+t._s(e.amount))]),i("v-uni-view",{staticClass:"order-sec-left"},[t._v("结余金额:￥"+t._s(e.isSettle))])],1),i("v-uni-view",{staticClass:"order-item-top-row"},[i("v-uni-view",{staticClass:"order-item-top-row-remark"},[i("v-uni-view",{staticClass:"order-item-top-row-des"},[t._v("备注：")]),i("v-uni-view",{staticClass:"order-item-top-row-input"},[t._v(" "+t._s(e.absTract)+" ")])],1),i("v-uni-view",{staticClass:"delete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delectItem(e,"billList",o)}}},[t._v("删除")])],1)],1),i("v-uni-view",{staticClass:"order-item-bottom bottom-fir"},[i("v-uni-view",{staticClass:"bottom-input"},[i("v-uni-view",{staticClass:"bottom-des"},[t._v("本次结算：")]),i("v-uni-view",{staticClass:"bottom-input-box"},[t._v(" ￥ "),i("v-uni-input",{attrs:{type:"digit",value:e.settleAmount,disabled:!t.checkStatus},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.clearValue(e,o,"billList","settleAmount")},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"billList","settleAmount")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"billList","settleAmount")}}}),t._v(" 元 ")],1)],1),i("v-uni-view",{staticClass:"bottom-input"},[i("v-uni-view",{staticClass:"bottom-des"},[t._v("本次优惠：")]),i("v-uni-view",{staticClass:"bottom-input-box"},[t._v(" ￥ "),i("v-uni-input",{attrs:{type:"digit",value:e.preAmount,disabled:!t.checkStatus},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.clearValue(e,o,"billList","preAmount")},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"billList","preAmount")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"billList","preAmount")}}}),t._v(" 元 ")],1)],1)],1)],1)]})),i("v-uni-view",{staticClass:"summary"},[i("v-uni-view",{staticClass:"summary-item"},[t._v("结算总金额")]),i("v-uni-view",{staticClass:"summary-item"},[t._v("结算总优惠")])],1),i("v-uni-view",{staticClass:"summary"},[i("v-uni-view",{staticClass:"summary-item"},[i("v-uni-text",[t._v("￥"+t._s(t.allSettlementAmount))]),t._v("元")],1),i("v-uni-view",{staticClass:"summary-item"},[i("v-uni-text",[t._v("￥"+t._s(t.discountAmount))]),t._v("元")],1)],1)],2),i("v-uni-view",{staticClass:"collectionAccountList"},[i("v-uni-view",{staticClass:"collectionAccountList-top"},[i("v-uni-text",[t._v("付款账号：")]),i("v-uni-image",{attrs:{src:"/static/img/outNote/add.png",mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addCollectionAccount.apply(void 0,arguments)}}})],1),t._l(t.collectionAccountList,(function(e,o){return[i("v-uni-view",{key:o,staticClass:"collectionAccountList-bottom-item",attrs:{id:"shop_"+e.id}},[i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row"},[i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row-box pic"},[i("v-uni-view",{staticClass:"kmName",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editCollectionAccount(o)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择收款账户",value:e.kmName,disabled:!0}})],1),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row-box debitAmount"},[t._v(" ￥ "),i("v-uni-input",{attrs:{type:"digit",value:e.debitAmount?e.debitAmount:0,disabled:!t.checkStatus},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.clearValue(e,o,"collectionAccountList","debitAmount")},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"collectionAccountList","debitAmount")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"collectionAccountList","debitAmount")}}}),t._v(" 元 ")],1)],1),i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row"},[i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row-box remarks"},[t._v(" 备注： "),i("v-uni-input",{attrs:{type:"text",value:e.remarks,disabled:!t.checkStatus},on:{focus:function(e){arguments[0]=e=t.$handleEvent(e),t.clearValue(e,o,"collectionAccountList","remarks")},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"collectionAccountList","remarks")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,o,"collectionAccountList","remarks")}}})],1),i("v-uni-view",{staticClass:"collectionAccountList-bottom-item-row-box"},[i("v-uni-view",{staticClass:"delete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delectItem(e,"collectionAccountList",o)}}},[t._v("删除")])],1)],1)],1)]}))],2),i("v-uni-view",{staticClass:"paymentMethod "},[i("v-uni-view",{staticClass:"paymentMethod-item"},[i("v-uni-view",{staticClass:"paymentMethod-item-name"},[t._v("收付方式：")]),t.dictionnaryList.length>0?i("v-uni-view",{staticClass:"paymentMethod-item-vlue"},[i("v-uni-picker",{attrs:{value:t.dictionnaryIndex,disabled:!t.checkStatus,range:t.dictionnaryList,"range-key":"name"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.dictionnaryChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"pickval"},[t._v(t._s(t.dictionnaryIndex>=0?t.dictionnaryList[t.dictionnaryIndex].name:""))])],1),i("v-uni-image",{staticClass:"right",attrs:{src:"/static/img/outNote/right.png"}})],1):t._e()],1),i("v-uni-view",{staticClass:"paymentMethod-item"},[i("v-uni-view",{staticClass:"paymentMethod-item-name"},[t._v("备注：")]),i("v-uni-view",{staticClass:"paymentMethod-item-vlue"},[i("v-uni-input",{attrs:{type:"text",disabled:!t.checkStatus},model:{value:t.absTract,callback:function(e){t.absTract=e},expression:"absTract"}}),t.checkStatus?i("v-uni-image",{staticClass:"right",staticStyle:{"z-index":"1"},attrs:{src:"/static/img/del.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearInput("absTract")}}}):t._e()],1)],1)],1),t._l(2,(function(e){return i("v-uni-view",{key:"footfixed"+e,class:["footfixed",2===e?"hide":""]},[i("v-uni-view",{staticClass:"foot-bg"},[i("v-uni-view",{staticClass:"foot-bg-left"},[i("v-uni-image",{attrs:{src:"/static/img/outNote/shop.png",mode:""}}),i("v-uni-view",[t._v("金额："),i("v-uni-text",[t._v(t._s(t.allSettlementAmount))])],1)],1),t.checkStatus?i("v-uni-view",{staticClass:"foot-bg-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.creatNewDocm.apply(void 0,arguments)}}},[t._v("保存")]):t._e()],1)],1)}))],2)},n=[]},a868:function(t,e,i){var o=i("4ae9");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("967d").default;n("aacb23f6",o,!0,{sourceMap:!1,shadowMode:!1})},b77a:function(t,e,i){"use strict";i.r(e);var o=i("6dd9"),n=i("e64a");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("2980");var s=i("828b"),c=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"3636aea8",null,!1,o["a"],void 0);e["default"]=c.exports},d253:function(t,e,i){"use strict";i("c223");var o=i("d4d7"),n={salesReceiptsBill:function(t){return(0,o.get)("api/salesReceiptsBill/page",t,1)},listWlDetailById:function(t){return(0,o.get)("api/salesReceiptsBill/listWlDetailById",t,1)},selectListWlDetail:function(t){return(0,o.get)("api/salesReceiptsBill/selectListWlDetail",t,1)},listAvDetailById:function(t){return(0,o.get)("api/salesReceiptsBill/listAvDetailById",t,1)},dictionnaryList:function(t){return(0,o.get)("api/basedata/dictionnary/list",t,1)},authorganizationList:function(t){return(0,o.get)("api/basicData/authorganization/list",t,1)},getKMListByAvType:function(t){return(0,o.get)("api/financial/getKMListByAvType",t,1)},allEmployeesInfo:function(t){return(0,o.get)("api/basicData/allEmployeesInfo",t,1)},isSave:function(t){return(0,o.post)("salesReceiptsBill/isSave",t,8)},saveAvAndCaDetail:function(t){return(0,o.post)("salesReceiptsBill/saveAvAndCaDetail",t,8)},checkBill:function(t){return(0,o.post)("api/salesReceiptsBill/checkBillApp"+"?id=".concat(t.id,"&autoAbsTract=").concat(t.autoAbsTract,"&absTract=").concat(t.absTract),null,1)},getAmount:function(t){return(0,o.get)("api/salesReceiptsBill/pageSum",t,1)}};t.exports=n},e64a:function(t,e,i){"use strict";i.r(e);var o=i("5d22"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a}}]);