(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-canvasShare-canvasShare"],{"044e":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticClass:"canvasShare"},[e("canvas-tab",{attrs:{option:this.canvasObj}})],1)},n=[]},"0661":function(t,e,a){"use strict";a.r(e);var i=a("8a49"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a},"0f99":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,"uni-page-body[data-v-5b8c5ddf]{height:100%;overflow-y:auto}.canvasShare[data-v-5b8c5ddf]{width:100%;height:100%}",""]),t.exports=e},1851:function(t,e,a){"use strict";var i=a("8bdb"),n=a("84d6"),r=a("1cb5");i({target:"Array",proto:!0},{fill:n}),r("fill")},"1a2c":function(t,e,a){"use strict";a.r(e);var i=a("eeb4"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a},"33de":function(t,e,a){"use strict";a.r(e);var i=a("ff5e"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a},"3dc6":function(t,e,a){"use strict";a.r(e);var i=a("4dbf"),n=a("33de");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);var o=a("0661");for(var r in o)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(r);a("5818");var s=a("828b");n["default"].__module="share";var c=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"601ac362",null,!1,i["a"],n["default"]);e["default"]=c.exports},"420f":function(t,e,a){"use strict";var i=a("f458"),n=a.n(i);n.a},"47f0":function(t,e,a){"use strict";a.r(e);var i=a("044e"),n=a("4a26");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("bd8d");var o=a("828b"),s=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"5b8c5ddf",null,!1,i["a"],void 0);e["default"]=s.exports},"4a26":function(t,e,a){"use strict";a.r(e);var i=a("f9ad"),n=a.n(i);for(var r in i)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(r);e["default"]=n.a},"4dbf":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this.$createElement,e=this._self._c||t;return this.canvasData?e("v-uni-view",{staticClass:"canvas_view"},[e("v-uni-view",{wxsProps:{"change:prop":"canvasData"},attrs:{id:"canvasRender",prop:this.canvasData,"change:prop":this.share.update}})],1):this._e()},n=[]},5818:function(t,e,a){"use strict";var i=a("c25b"),n=a.n(i);n.a},"7c11":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".canvas_view[data-v-601ac362]{visibility:hidden}.canvas_view #canvasRender[data-v-601ac362]{display:flex;align-items:center;justify-content:center}",""]),t.exports=e},"8a49":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={props:{option:{type:Object,required:!0}},data:function(){return{canvasData:{}}},created:function(){this.canvasData=this.option},methods:{generatePicture:function(t){this.canvasImage=t.canvasImage,this.isShowLoading=t.isShowLoading,this.$emit("generatePicture",t.canvasImage)}}};e.default=i},"9cf0":function(t,e,a){"use strict";a.r(e);var i=a("c99f"),n=a("1a2c");for(var r in n)["default"].indexOf(r)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(r);a("420f");var o=a("828b"),s=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"101f5fbf",null,!1,i["a"],void 0);e["default"]=s.exports},bb7d:function(t,e,a){var i=a("0f99");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("1fa5a3ef",i,!0,{sourceMap:!1,shadowMode:!1})},bd8d:function(t,e,a){"use strict";var i=a("bb7d"),n=a.n(i);n.a},c25b:function(t,e,a){var i=a("7c11");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("74492e92",i,!0,{sourceMap:!1,shadowMode:!1})},c99f:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"canvasTab"},[a("canvas-render",{staticClass:"canvas_view",attrs:{option:t.canvasData},on:{generatePicture:function(e){arguments[0]=e=t.$handleEvent(e),t.generatePicture.apply(void 0,arguments)}}}),a("v-uni-scroll-view",{staticStyle:{height:"100%"},attrs:{"scroll-y":!0}},[a("v-uni-view",{style:{width:t.windowWidth+"px",paddingTop:t.imagePadding+"px"}}),t.imgurl?a("v-uni-image",{style:"width:"+t.windowWidth+"px",attrs:{src:t.imgurl,mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewPhoto.apply(void 0,arguments)}}}):t.canvasImage?a("v-uni-image",{style:"width:"+t.windowWidth+"px",attrs:{src:t.canvasImage,mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewPhoto.apply(void 0,arguments)}}}):t._e()],1),t.canvasImage?a("v-uni-view",{staticClass:"share_view"},[a("v-uni-view",{staticClass:"share-wechat",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.shareOrder.apply(void 0,arguments)}}},[t._v("保存图片")])],1):t._e(),t.isShowLoading?a("v-uni-view",{staticClass:"toast"},[a("v-uni-view",{staticClass:"uni-mask"}),a("v-uni-view",{staticClass:"uni-toast"},[a("v-uni-view",{staticClass:"uni-icon_toast uni-loading"}),a("v-uni-text",{staticClass:"uni-toast__content"},[t._v(" 玩命加载中... ")])],1)],1):t._e()],1)},n=[]},ed42:function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".canvasTab[data-v-101f5fbf]{position:relative;width:100%;height:100%;overflow:hidden}.canvasTab .canvas_view[data-v-101f5fbf]{visibility:hidden;position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.canvasTab .canvas_view #canvasRender[data-v-101f5fbf]{display:flex;align-items:center;justify-content:center}.canvasTab .convert_image[data-v-101f5fbf]{display:flex;align-items:center;justify-content:center;height:100%;position:absolute;padding-bottom:%?200?%}.canvasTab .share_view[data-v-101f5fbf]{width:100%;height:80px;position:fixed;bottom:%?100?%;display:flex;justify-content:center}.canvasTab .share_view .share-wechat[data-v-101f5fbf]{width:%?670?%;height:%?88?%;background:#ffb822;display:flex;justify-content:center;align-items:center;margin:%?60?% %?40?% 0;font-size:%?36?%;color:#fff;border-radius:%?8?%;border:%?1?% solid #ffb822}.toast[data-v-101f5fbf]{position:fixed;top:0;right:0;bottom:0;left:0;z-index:999;display:block;box-sizing:border-box}.toast .uni-mask[data-v-101f5fbf]{position:absolute;z-index:999;top:0;right:0;left:0;bottom:0;background:rgba(0,0,0,.6)}.toast .uni-toast[data-v-101f5fbf]{display:flex;align-items:center;flex-direction:column;position:fixed;z-index:999;width:%?256?%;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);background:rgba(17,17,17,.7);text-align:center;border-radius:%?10?%}.toast .uni-toast .uni-icon_toast.uni-loading[data-v-101f5fbf]{margin:%?40?% 0 0;width:%?76?%;height:%?76?%;vertical-align:initial}.toast .uni-toast .uni-toast__content[data-v-101f5fbf]{margin:0 0 %?30?%;font-size:%?32?%;color:#fff}",""]),t.exports=e},eeb4:function(module,exports,__webpack_require__){"use strict";(function(console){__webpack_require__("6a54");var _interopRequireDefault=__webpack_require__("f5bd").default;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _objectSpread2=_interopRequireDefault(__webpack_require__("9b1b"));__webpack_require__("e966"),__webpack_require__("aa9c"),__webpack_require__("5c47"),__webpack_require__("a1c1"),__webpack_require__("2c10"),__webpack_require__("bf0f"),__webpack_require__("2797"),__webpack_require__("23f4"),__webpack_require__("7d2f"),__webpack_require__("9c4e"),__webpack_require__("ab80"),__webpack_require__("d4b5");var _canvasRender=_interopRequireDefault(__webpack_require__("3dc6")),_default={props:{option:{type:Object,required:!0}},components:{canvasRender:_canvasRender.default},data:function(){return{canvasData:{},windowWidth:0,windowHeight:0,imagePadding:0,canvasImage:"",imgurl:"",imageUrls:[],isShowLoading:!0}},watch:{},created:function(){var t=uni.getSystemInfoSync(),e=t.windowWidth,a=t.windowHeight;this.windowWidth=e,this.windowHeight=a,this.calculation(this.option.body,(function(t,a){var i=t.option;if(i.body.top=a.header,i.body.center=a.list,i.information={dataHeight:a.tabHeight,tabWidth:a.tabWidth,tabHeight:a.totalHeight,canvasWidth:a.canvasWidth},i.header[0][0].txt_X=a.canvasWidth/2,i.header[2][2].txt_X=a.canvasWidth-10,i.foot[0][1].txt_X=a.canvasWidth-parseInt(t.TextWidth(i.foot[0][1].text+"          ",i.foot[0][1].FontSize))+10,i.record={canvasImage:"",imageUrls:[]},t.canvasData=i,t.windowHeight>=t.canvasData.information.tabHeight){var n=Math.ceil(t.canvasData.information.tabHeight/1e3*e);t.imagePadding=Math.round((t.windowHeight-n)/2)}}))},methods:{calculation:function calculation(obj,callBack){var tab={},canvasWidth=1e3;tab.list=[],tab.totalHeight=150,tab.header=[],tab.tabWidth=0,tab.tabHeight=0;var list=obj.center.list,JList=obj.center.format;canvasWidth=0;for(var j=0;j<JList.length;j++)canvasWidth+=JList[j].XSize;if(canvasWidth<1e3){for(var _j=0;_j<JList.length;_j++)JList[_j].XSize=Math.round(JList[_j].XSize/canvasWidth*980);canvasWidth=1e3}else canvasWidth+=20;tab.canvasWidth=canvasWidth;for(var _j2=0;_j2<JList.length;_j2++)tab.tabWidth+=JList[_j2].XSize,tab.header.push({XSize:JList[_j2].XSize,FontSize:obj.top.FontSize,title:JList[_j2].title,name:JList[_j2].name});for(var startingPointX=10,startingPointY=0,i=0;i<list.length;i++){for(var currentLine=list[i],MaxLineBreak=0,tablist={},_j3=0;_j3<JList.length;_j3++){var item=JList[_j3];tablist[item.name]=currentLine[item.name];var listItem=String(currentLine[item.name]);if(listItem&&JList[_j3].lineBreak){var LineBreak=Math.ceil(listItem.length/JList[_j3].lineBreak);MaxLineBreak<LineBreak&&(MaxLineBreak=LineBreak)}}var rowHeight=30;MaxLineBreak>1&&(rowHeight+=(MaxLineBreak-1)*(obj.center.FontSize+4));for(var _j4=0;_j4<JList.length;_j4++){var _item=JList[_j4],txt="",txtWidth=0,txtHeight=obj.center.FontSize,txtSize=txtHeight;if(tablist.fontSize=obj.center.FontSize+"px Arial","primordial"===_item.type){if("index"===_item.name)txt=String(_j4+1);else if("remark"!==_item.name||currentLine[_item.name]){var itemValue=currentLine[_item.name];txt=itemValue?String(itemValue):""}else txt="无";_item.format&&txt&&(txt=_item.format.replace(/\$\{value\}/g,txt)),txtWidth=this.TextWidth(txt,txtSize);var interceptSize=_item.lineBreak,HSize=0;if(HSize=Math.ceil(txt.length/interceptSize),interceptSize&&HSize>1){for(var txtArr=[],split=[],k=0;k<HSize;k++)k!==HSize-1?split.push(txt.substring(k*interceptSize,(k+1)*interceptSize)):split.push(txt.substring(k*interceptSize,txt.length));var txtWidthOne=this.TextWidth(split[0],txtSize),txtYStart=startingPointY+txtSize;txtYStart+=(rowHeight-(HSize*txtSize+2*(HSize-1)))/2;var txt_moveX=0;txt_moveX="left"===_item.textAlign?txtSize/2:"right"===_item.textAlign?_item.XSize-txtWidthOne-txtSize/2:Math.round((_item.XSize-txtWidthOne)/2);for(var _k=0;_k<HSize;_k++)txtArr.push({txt:split[_k],txt_x:startingPointX+txt_moveX,txt_y:txtYStart+Math.round(_k*(txtSize+2))});tablist[_item.name]=txtArr}else{"index"===_item.name&&(txt=i+1),txtWidth=this.TextWidth(txt,txtSize);var txt_moveX=0;txt_moveX="left"===_item.textAlign?txtSize/2:"right"===_item.textAlign?_item.XSize-txtWidth-txtSize/2:Math.round((_item.XSize-txtWidth)/2),tablist[_item.name]=[{txt:txt,txt_x:startingPointX+txt_moveX,txt_y:startingPointY+Math.round(txtHeight+(rowHeight-txtHeight)/2)}]}}else{var str=_item.expression,oldStr=str.replace(/\$\{/g,"").replace(/\}/g,"");str=str.match(/\$\{([\s\S]*?)\}/g);var res=String(str).replace(/\$\{/g,"").replace(/\}/g,""),strArr=res.split(",");strArr.forEach((function(t){var e=currentLine[t]?currentLine[t]:0;oldStr=oldStr.replace(new RegExp(t,"g"),e)})),"number"===_item.name&&(oldStr="Math.ceil(("+oldStr+")*100)/100"),txt=String(eval(oldStr)),_item.format&&(txt=_item.format.replace(/\$\{value\}/g,txt)),txtWidth=this.TextWidth(txt,txtSize);var txt_moveX=0;txt_moveX="left"===_item.textAlign?txtSize/2:"right"===_item.textAlign?_item.XSize-txtWidth-txtSize/2:Math.round((_item.XSize-txtWidth)/2),tablist[_item.name]=[{txt:txt,txt_x:startingPointX+txt_moveX,txt_y:startingPointY+Math.round(txtHeight+(rowHeight-txtHeight)/2)}]}startingPointX+=_item.XSize}tab.list.push((0,_objectSpread2.default)((0,_objectSpread2.default)({},tablist),{},{rowHeight:rowHeight})),tab.totalHeight+=rowHeight,tab.tabHeight+=rowHeight,startingPointX=10}return tab.totalHeight+=100,callBack(this,tab),tab},TextWidth:function(t,e){for(var a=0,i=0,n=String(t),r=e,o=0;o<n.length;o++)n[o].charCodeAt()>255?i++:a++;var s=a*r*.556+i*r;return Math.round(s)},generatePicture:function(t){var a=this;a.canvasImage=t,a.isShowLoading=!1;var i=String((new Date).getTime()),n=this.canvasData.header[2][0].text+i,r=new plus.nativeObj.Bitmap(n);r.loadBase64Data(a.canvasImage,(function(){console.log("加载Base64图片数据成功"),r.save("_doc/"+n+".png",{},(function(t){console.log("临时保存图片成功："+t.target),a.imgurl=t.target,r.clear()}),(function(t){onsole.log("临时保存图片失败："+JSON.stringify(t)),r.clear()}))}),(function(){console.log("加载Base64图片数据失败："+JSON.stringify(e)),r.clear()}))},previewPhoto:function(){uni.previewImage({current:0,urls:[this.imgurl]})},shareOrder:function(){uni.saveImageToPhotosAlbum({filePath:this.imgurl,success:function(){console.log("save success"),uni.showToast({title:"保存成功",duration:1e3,icon:"none"})},fail:function(t){uni.showToast({title:"保存失败，请点击图片手动保存",duration:2e3,icon:"none"})}})}}};exports.default=_default}).call(this,__webpack_require__("ba7c")["default"])},f458:function(t,e,a){var i=a("ed42");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("b9adb3ec",i,!0,{sourceMap:!1,shadowMode:!1})},f9ad:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("dd2b");var n=i(a("9b1b")),r=a("8f59"),o=i(a("9cf0")),s={computed:(0,n.default)({},(0,r.mapState)(["params"])),components:{canvasTab:o.default},data:function(){return{canvasObj:{},type:0,information:{},tab:{header:[[{text:"",FontSize:33,textAlign:"center",txt_X:500,txt_y:36}],[{text:"",FontSize:22,textAlign:"left",txt_X:10,txt_y:80}],[{text:"",FontSize:18,textAlign:"left",txt_X:10,txt_y:110},{text:"备注:",FontSize:18,txt_X:250,txt_y:110},{text:"开单日期:",FontSize:18,textAlign:"right",txt_X:980,txt_y:110}]],body:{top:{FontSize:22},center:{FontSize:13,format:[{XSize:50,name:"index",title:"序号",type:"primordial"},{XSize:110,name:"barCode",title:"条码",type:"primordial",lineBreak:12},{XSize:210,name:"goodsName",title:"名称",type:"primordial",lineBreak:15},{XSize:50,name:"packingSpecification",title:"规格",type:"primordial"},{XSize:50,name:"smallUnit",title:"单位",type:"primordial"},{XSize:60,name:"number",title:"数量",type:"calculation",expression:"${itemQuantity}*${packingSpecification}+${scatteredQuantity}"},{XSize:60,name:"itemQuantity",title:"件数",type:"primordial"},{XSize:60,name:"scatteredQuantity",title:"散数",type:"primordial"},{XSize:60,name:"getSP",title:"单价",type:"primordial",format:"￥${value}",lineBreak:6},{XSize:130,name:"amount",title:"金额",type:"primordial",format:"￥${value}"},{XSize:140,name:"remark",title:"备注",type:"primordial",lineBreak:10}],formatMult:[{XSize:50,name:"index",title:"序号",type:"primordial"},{XSize:110,name:"barCode",title:"条码",type:"primordial",lineBreak:12},{XSize:210,name:"goodsName",title:"名称",type:"primordial",lineBreak:15},{XSize:50,name:"specUnit",title:"单位",type:"primordial"},{XSize:60,name:"number",title:"规格",type:"calculation",expression:"${itemQuantity}*${packingSpecification}+${scatteredQuantity}"},{XSize:60,name:"specUnitQuantity",title:"数量",type:"primordial"},{XSize:60,name:"specUnitPrice",title:"单价",type:"primordial",format:"￥${value}",lineBreak:6},{XSize:130,name:"amount",title:"金额",type:"primordial",format:"￥${value}"},{XSize:140,name:"remark",title:"备注",type:"primordial",lineBreak:10}]},bottom:[[{text:"总金额:",FontSize:22,txt_X:15}]]},foot:[[{text:"   制单人:",FontSize:22,txt_X:0},{text:"收货人(签字):",FontSize:22,txt_X:600}]]}}},onLoad:function(t){t&&0!=t.type?this.type=t.type.substring(0,1):this.type=0,uni.getStorageSync("useMultUnit")&&(this.tab.body.center.format=this.tab.body.center.formatMult),this.information={remark:this.params.orderDetails.remark?this.params.orderDetails.remark:"",createTime:this.params.orderDetails.createTime?this.timeShift.timeTransfer(this.params.orderDetails.createTime):"                                        ",customerName:this.params.orderDetails.customerName?this.params.orderDetails.customerName:"",supplierName:this.params.orderDetails.supplierName?this.params.orderDetails.supplierName:"",totalAmount:this.params.orderDetails.totalAmount?this.params.orderDetails.totalAmount:"",zdy:this.params.orderDetails.zdy?this.params.orderDetails.zdy:"",saleNo:""};var e="NO.";this.type&&2==this.type?e+=this.params.orderDetails.saleNo?this.params.orderDetails.saleNo:"":e+=this.params.orderDetails.purchaseNo?this.params.orderDetails.purchaseNo:"",this.information.saleNo=e,this.tab.header[0][0].text=this.params.title;var a="";a=this.type&&2==this.type?"客户:"+this.information.customerName:"供应商:"+this.information.supplierName,this.tab.header[1][0].text=a,this.tab.header[1][0].textIndent=10,this.tab.header[2][0].text=this.information.saleNo,this.tab.header[2][1].text="备注:"+this.information.remark,this.tab.header[2][1].textIndent=250,this.tab.header[2][2].text="开单日期:"+this.information.createTime,this.tab.body.center.list=this.params.list,201!==this.params.billType&&202!=this.params.billType&&203!==this.params.billType||this.tab.body.center.format.splice(9,0,{XSize:60,name:"discount",title:"折扣",type:"primordial",format:"${value}%"}),this.tab.body.bottom[0][0].text="总金额: ￥"+this.information.totalAmount,this.tab.foot[0][0].text="   制单人:  "+this.information.zdy,this.canvasObj=this.tab},onShow:function(){},onReady:function(t){},methods:{}};e.default=s},ff5e:function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("1851"),a("bf0f"),a("2797"),a("d4b5");var i=null,n={mounted:function(){var t=document.getElementById("canvasRender"),e=document.createElement("canvas");e.id="canvasRender_canvas",e.width=this.canvasData.information.canvasWidth,e.height=this.canvasData.information.tabHeight,i=e,t.appendChild(e),this.draw()},methods:{draw:function(){var t=i.getContext("2d");t.beginPath(),t.rect(0,0,this.canvasData.information.canvasWidth,this.canvasData.information.tabHeight),t.strokeStyle="#ffffff",t.fillStyle="#ffffff",t.fill(),t.stroke(),this.canvasData.header.forEach((function(e){e.forEach((function(e,a){t.font=0===a?e.FontSize+"px impact":e.FontSize+"px Arial",t.fillStyle="#000000","left"===e.textAlign?t.textAlign="start":"center"===e.textAlign?t.textAlign="center":"right"===e.textAlign&&(t.textAlign="end"),t.fillText(e.text,e.txt_X,e.txt_y)}))})),t.textAlign="start";var e=(this.canvasData.information.canvasWidth-this.canvasData.information.tabWidth)/2,a=e,n=120,r=this.canvasData.body.center,o=this.canvasData.body.top,s=n;t.beginPath(),t.strokeStyle="#000000",t.moveTo(a,n),t.lineTo(a+this.canvasData.information.tabWidth,n),n+=30,t.moveTo(a,n),t.lineTo(a+this.canvasData.information.tabWidth,n);for(var c=0;c<r.length;c++)n+=r[c].rowHeight,t.moveTo(a,n),t.lineTo(a+this.canvasData.information.tabWidth,n);n+=30,t.moveTo(a,n),t.lineTo(a+this.canvasData.information.tabWidth,n),n=s;var l=this.canvasData.information.dataHeight;t.moveTo(a,n),t.lineTo(a,n+l+60);for(var d=0;d<o.length;d++)a+=o[d].XSize,t.moveTo(a,n),d===o.length-1?t.lineTo(a,n+l+60):t.lineTo(a,n+l+30);a=e,n=120;for(var f=0;f<o.length;f++){var u=o[f],h=u.title,v=this.TextWidth(h,u.FontSize),m=u.FontSize;t.font=u.FontSize+"px Arial";var p=a+Math.round((u.XSize-v)/2),_=n+Math.round(m+(30-m)/2)-1;t.fillText(h,p,_),a+=u.XSize}a=e,n+=30;for(var x=0;x<r.length;x++){for(var g=r[x],b=0;b<o.length;b++){for(var S=o[b],w=g[S.name],y=0;y<w.length;y++)t.font=g.fontSize,t.fillText(w[y].txt,w[y].txt_x,n+w[y].txt_y);a+=S.XSize}a=(this.width-this.canvasData.information.tabWidth)/2,n+=g.rowHeight}t.font="22px Arial",t.fillText(this.canvasData.body.bottom[0][0].text,15,n+22+4-1),n+=30,n+=30,t.font="22px Arial",t.fillText(this.canvasData.foot[0][0].text,this.canvasData.foot[0][0].txt_X,n),t.font="22px Arial",t.fillText(this.canvasData.foot[0][1].text,this.canvasData.foot[0][1].txt_X,n),t.stroke(),this.convertCanvasToImage(i)},update:function(t,e,a,i){a.callMethod("generatePicture",{canvasImage:t.record.canvasImage,isShowLoading:t.record.isShowLoading})},convertCanvasToImage:function(t){var e=t.toDataURL("image/png");this.canvasData.record.canvasImage=e,this.canvasData.record.isShowLoading=!1,this.canvasData=JSON.parse(JSON.stringify(this.canvasData))},TextWidth:function(t,e){for(var a=0,i=0,n=String(t),r=e,o=0;o<n.length;o++)n[o].charCodeAt()>255?i++:a++;var s=a*r*.556+i*r;return s}}};e.default=n}}]);