(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-sale-outNote-outNote"],{"1dbd":function(t,e,i){"use strict";var a=i("ac5f"),s=i("1fc1"),o=i("41c7"),n=i("ae5c"),r=function(t,e,i,d,c,u,l,h){var m,f,p=c,v=0,g=!!l&&n(l,h);while(v<d)v in i&&(m=g?g(i[v],v,e):i[v],u>0&&a(m)?(f=s(m),p=r(t,e,m,f,p,u-1)-1):(o(p+1),t[p]=m),p++),v++;return p};t.exports=r},"37b9":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAJ1BMVEX///8zMzP6+vpwcHCSkpJ9fX2IiIhISEjY2Njt7e2/v787OztbW1vTET4fAAAAk0lEQVQ4y82TuQ2EQBAEVwgkDq/FY584FwciIATIAEIgCgwCwMEhBEK4zEigy98xt1Wz8/SEEHsUCwh3BcCj0b0nh7yQP/KpdgI2NRY4JVvth4BLmizwV22BDoCkV/11wk8abKZZpQUyAlYAUgJQwFT8OZbLDeJIcIihpbHjoni1aAa2DxqOLRrI1HgGfDh8avHEC/ZBGXwrpcb3AAAAAElFTkSuQmCC"},"4f23":function(t,e,i){var a=i("ee59");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=i("967d").default;s("486970f3",a,!0,{sourceMap:!1,shadowMode:!1})},"4fe6":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAKBAMAAACgUqiRAAAAGFBMVEWEhISAgIBHcEyAgIB6enqAgICCgoKAgIAUaalZAAAAB3RSTlMT0gDXGbcqhO85WQAAAEpJREFUCNdjSGVSAgHXBIZwARBDxTyAgbEQJOhcyMCgIC4AEhJQYFACCToXMgFZQEGgkBKQBRRMBgqDWAri5UClIBZYJYSlEAAiAOZMDmcJUYE4AAAAAElFTkSuQmCC"},"59b8":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqBAMAAAA37dRoAAAAFVBMVEVHcEyXl5ebm5uXl5eXl5eYmJiXl5dhgIfDAAAABnRSTlMAugiMpToMNkwxAAAAU0lEQVQoz2NgGOwgUAGLIGuaEBZRxrRELIqZxLApZlJMS2HAqtiBQsUMOBUbYFWcTLxiRlIUYxXFah0T5UpTiA0d0pQqEBmb2GMeeyrBnqIGIQAA2U8VBfend9IAAAAASUVORK5CYII="},"5bc3":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABN0lEQVRoge2YMQ6DMAxFOQhzD/BtxUOvwLV6HNaOHKkSbJ3oEqSoSmjSBhKKn+SFKMiPuPSLplH+EAAdEQ1ENNkaAHSl+4qCmW9ENPuKmW+l+1vFPnlv80tVfRJ2bJanfReRVkRaZr47EkPpPoPYeZ+JaBaRdrkuIq0jMJXscRV3VFLWqkEFSqMCpVGB0qhADt6S5Gqu2bHiEu1akqylgok2JknWUt6TIE+SzDKTGYhKtBRIkrXwMdH+g8CxR+jwP+KmOfhr9O0khpJNBirt04y7OXpTZn7qQQUyoAIq8CObCNj/isn3Ps69tokAET3t9adnT9a1rQSCN829pgIqoAInFxiXzcx83VuAma/O9TFZAEDv3rhkAeiTBYwxFwCPCpp/GGMuyQKORO+O0441Aui/bl5RTsILecwmw0E3NbEAAAAASUVORK5CYII="},"60da":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"contain"},[a("v-uni-view",{staticClass:"head"},[a("v-uni-view",{staticClass:"header-left"},[a("v-uni-image",{attrs:{src:i("37b9"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"header-middle"},[a("v-uni-text",[t._v("销售出仓单")])],1),a("v-uni-view",{staticClass:"header-right"},[a("v-uni-image",{attrs:{src:i("5bc3")},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearAllDate.apply(void 0,arguments)}}}),a("v-uni-image",{attrs:{src:"/static/img/history.png"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toHistory.apply(void 0,arguments)}}}),a("v-uni-image",{staticClass:"header-image",attrs:{src:"/static/img/outNote/setimg.png",mode:"widthFix"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.setHeader.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{staticClass:"blank"}),a("v-uni-view",{staticClass:"middle"},[a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 单据日期： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-picker",{attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindDateChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.date))])],1),a("v-uni-image",{attrs:{src:i("846e"),mode:""}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 客户： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.customerList.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择客户"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),a("v-uni-image",{attrs:{src:i("59b8")}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 仓库： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.warehouseList.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择仓库"},model:{value:t.warehouse,callback:function(e){t.warehouse=e},expression:"warehouse"}}),a("v-uni-image",{attrs:{src:i("59b8"),mode:""}})],1)],1),t.fieldConfig.customersiteId?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.customersiteId,expression:"requireConfig && requireConfig.customersiteId"}],staticStyle:{color:"red"}},[t._v("*")]),t._v(" 工地： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.customersiteList.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择工地"},model:{value:t.customersiteName,callback:function(e){t.customersiteName=e},expression:"customersiteName"}}),a("v-uni-image",{attrs:{src:i("59b8"),mode:""}})],1)],1):t._e(),t.fieldConfig&&t.fieldConfig.credit?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.credit,expression:"requireConfig && requireConfig.credit"}],staticStyle:{color:"red"}},[t._v("*")]),t._v(" 信用额： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-input",{attrs:{type:"text",placeholder:"信用额",disabled:!0},model:{value:t.creditAmount,callback:function(e){t.creditAmount=e},expression:"creditAmount"}})],1)],1):t._e(),t.fieldConfig&&t.fieldConfig.arrearsAdvance?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des",staticStyle:{width:"188upx","margin-left":"-28upx"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.arrearsAdvance,expression:"requireConfig && requireConfig.arrearsAdvance"}],staticStyle:{color:"red"}},[t._v("*")]),t._v(" 欠款/预收： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"欠款/预收",disabled:!0},model:{value:t.arrearsAdvance,callback:function(e){t.arrearsAdvance=e},expression:"arrearsAdvance"}})],1)],1):t._e(),t.fieldConfig.remark?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.remark,expression:"requireConfig && requireConfig.remark"}],staticStyle:{color:"red"}},[t._v("*")]),t._v(" 备注： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-input",{attrs:{type:"text",placeholder:"输入备注"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.remarks.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.remarks.apply(void 0,arguments)}},model:{value:t.remarksVal,callback:function(e){t.remarksVal=e},expression:"remarksVal"}})],1)],1):t._e(),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 商品选择： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-input",{attrs:{type:"text",placeholder:"商品名称/货号/条码",focus:t.focusTwo},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.search(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),a("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.commodityList.apply(void 0,arguments)}}},[t._v("添加商品")])],1)],1),t.fieldConfig.operatorId?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.operatorId,expression:"requireConfig && requireConfig.operatorId"}],staticStyle:{color:"red"}},[t._v("*")]),t._v("经手人：")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList(1)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择经手人",disabled:!0},model:{value:t.hander.name,callback:function(e){t.$set(t.hander,"name",e)},expression:"hander.name"}}),a("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1):t._e(),t.fieldConfig.salesmanId?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.salesmanId,expression:"requireConfig && requireConfig.salesmanId"}],staticStyle:{color:"red"}},[t._v("*")]),t._v("业务员：")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList(0)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择业务员",disabled:!0},model:{value:t.saleman.name,callback:function(e){t.$set(t.saleman,"name",e)},expression:"saleman.name"}}),a("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1):t._e(),t.fieldConfig.deptId?a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.requireConfig&&t.requireConfig.deptId,expression:"requireConfig && requireConfig.deptId"}],staticStyle:{color:"red"}},[t._v("*")]),t._v("部门：")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersInfo.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择部门",disabled:!0},model:{value:t.department.name,callback:function(e){t.$set(t.department,"name",e)},expression:"department.name"}}),a("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1):t._e()],1),a("v-uni-view",{staticClass:"sweepCode"},[a("v-uni-image",{attrs:{src:i("9ec0"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.commodityList.apply(void 0,arguments)}}}),a("v-uni-image",{attrs:{src:i("9796"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scanning.apply(void 0,arguments)}}})],1),t._l(t.shopList,(function(e,s){return a("v-uni-view",{key:s,staticClass:"order-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saleDetaEvent(e,s)}}},[a("v-uni-view",{staticClass:"order-item-top"},[a("v-uni-image",{staticClass:"order-item-left",attrs:{src:e.picture,mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewPhoto(s)}}}),a("v-uni-view",{staticClass:"order-item-right"},[a("v-uni-view",{staticClass:"order-inside inside-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeOpen(e,s)}}},[a("v-uni-view",{staticClass:"order-fir-left"},[e.isGift?a("v-uni-text",{staticClass:"gift"},[t._v("赠品")]):t._e(),t._v(t._s(e.goodsName))],1),a("v-uni-view",{staticClass:"order-sec-left"},[t._v("库存："+t._s(e.availableQuantity?e.availableQuantity:0))]),t.useMultUnit?a("v-uni-view",{staticClass:"order-sec-left"},[t._v("规格：1"+t._s(e.specUnit)+"*"+t._s(e.multipleUnitSpecification)+t._s(e.smallUnit))]):a("v-uni-view",{staticClass:"order-sec-left"},[t._v("规格：1"+t._s(e.largeUnit)+"* "+t._s(e.packingSpecification)+t._s(e.smallUnit))])],1),a("v-uni-view",{staticClass:"order-inside inside-right"},[a("v-uni-view",{staticClass:"order-fir-right"},[t._v("￥"),t.priceDisplayNone?a("v-uni-text",[t._v("****")]):a("v-uni-text",[t._v(t._s(e.amount?e.amount:0))])],1),t.useMultUnit?t._e():a("v-uni-view",{staticClass:"order-sec-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.historyPrice(e,s)}}},[t._v("历史售价")]),a("v-uni-view",{staticClass:"order-sec-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delectItem(e,s)}}},[t._v("删除")])],1)],1)],1),e.checked?a("v-uni-view",{staticClass:"order-item-bottom"},[t.useMultUnit?a("v-uni-view",{staticClass:"bottom-fir"},[a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("单价")]),t.priceDisplayNone?a("v-uni-view",[t._v("****")]):a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.modePrice?e.modePrice:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("数量")]),a("v-uni-input",{attrs:{type:"digit",value:e.itemQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("单位")]),a("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getSelectUnit(s)}}},[t._v(t._s(e.specUnit))])],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("折扣(%)")]),t.priceDisplayNone?a("v-uni-text",[t._v("****")]):a("v-uni-input",{attrs:{type:"digit",disabled:t.discountAuthChange,value:e.discount},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.discountChange(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.discountChange(e,s)}}})],1)],1):a("v-uni-view",{staticClass:"bottom-fir"},[a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("件价")]),t.priceDisplayNone?a("v-uni-view",[t._v("****")]):a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.saleIP?e.saleIP:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("件数")]),a("v-uni-input",{attrs:{type:"digit",value:e.itemQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)}}})],1),1!=e.packingSpecification||e.saleIP!=e.saleSP?a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("散价")]),t.priceDisplayNone?a("v-uni-view",[t._v("****")]):a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.saleSP?e.saleSP:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceSP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceSP(e,s)}}})],1):t._e(),1!=e.packingSpecification||e.saleIP!=e.saleSP?a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("散数")]),a("v-uni-input",{attrs:{type:"digit",value:e.scatteredQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberSP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberSP(e,s)}}})],1):t._e(),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("折扣(%)")]),t.priceDisplayNone?a("v-uni-text",[t._v("****")]):a("v-uni-input",{attrs:{type:"digit",disabled:t.discountAuthChange,value:e.discount},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.discountChange(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.discountChange(e,s)}}})],1)],1),a("v-uni-view",{staticClass:"bottom-sec"},[a("v-uni-view",{staticClass:"bottom-sec-des"},[t._v("品牌：")]),a("v-uni-view",{staticClass:"bottom-sec-num"},[t._v(t._s(e.brandName?e.brandName:""))]),t.isSetGift?a("v-uni-view",{staticClass:"bottom-sec-switch"},[a("v-uni-view",[t._v("设置赠品")]),a("v-uni-switch",{staticClass:"switch",attrs:{checked:e.isGift,color:t.color},on:{click:function(i){i.stopPropagation(),arguments[0]=i=t.$handleEvent(i),t.switchchange(e)}}})],1):t._e()],1),a("v-uni-view",{staticClass:"bottom-sec"},[a("v-uni-view",{staticClass:"bottom-sec-des"},[t._v("条码：")]),a("v-uni-view",{staticClass:"bottom-sec-num"},[t._v(t._s(e.barCode))])],1),a("v-uni-view",{staticClass:"bottom-sec"},[a("v-uni-view",{staticClass:"bottom-sec-des"},[t._v("型号：")]),a("v-uni-view",{staticClass:"bottom-sec-num"},[t._v(t._s(e.typeSpecification))])],1),a("v-uni-view",{staticClass:"bottom-sec"},[a("v-uni-view",{staticClass:"bottom-sec-des"},[t._v("备注：")]),a("v-uni-input",{staticClass:"bottom-sec-input",attrs:{type:"text",value:e.remark,placeholder:"点击输入备注"},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.goodsremarks(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.goodsremarks(e,s)}}})],1)],1):t._e(),a("v-uni-view",{staticClass:"order-item-foot",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeOpen(e,s)}}},[e.checked?a("v-uni-view",{staticClass:"foot-des"},[a("v-uni-view",[t._v("点击收起")]),a("v-uni-image",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:i("4fe6"),mode:""}})],1):a("v-uni-view",{staticClass:"foot-des"},[a("v-uni-view",[t._v("展开更多")]),a("v-uni-image",{attrs:{src:i("4fe6"),mode:""}})],1)],1)],1)})),t.shopList&&t.shopList.length>0?a("v-uni-view",{staticClass:"alldiscount"},[a("v-uni-view",[t._v("整单打折")]),a("v-uni-input",{attrs:{type:"number",placeholder:"输入折扣，如9.5折就输95",disabled:t.discountAuthChange},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.submitFeedback.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.submitFeedback.apply(void 0,arguments)}},model:{value:t.discount,callback:function(e){t.discount=e},expression:"discount"}})],1):t._e(),a("v-uni-view",{staticClass:"blank",staticStyle:{background:"#F6F6F6"}}),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.orderStat,expression:"orderStat"}],staticClass:"footfixed"},[a("v-uni-view",{staticClass:"foot-bg"},[a("v-uni-view",{staticClass:"foot-bg-left"},[a("v-uni-view",[t._v("金额："),t.priceDisplayNone?a("v-uni-text",[t._v("****")]):a("v-uni-text",[t._v(t._s(t.total))])],1),a("v-uni-view",{staticClass:"foot-bg-left-text"},[t._v("优惠："),t.priceDisplayNone?a("v-uni-text",[t._v("****")]):a("v-uni-text",[t._v(t._s(t.conponAmt))])],1)],1),a("v-uni-view",{staticClass:"foot-bg-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.creatNewDocm.apply(void 0,arguments)}}},[t._v("开单("+t._s(t.shopList.length)+")")])],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.footFlag,expression:"footFlag"}],staticClass:"modal-box",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeHistoryPrice.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"modal-body"},[a("v-uni-view",{staticClass:"modal-title"},[t._v("历史售价")]),t._l(t.historyprice,(function(e,i){return a("v-uni-view",{key:i,staticClass:"modal-item"},[a("v-uni-view",{staticClass:"modal-item-lef"},[a("v-uni-text",[t._v("件:"+t._s(e.saleIP))]),a("v-uni-text",[t._v("散:"+t._s(e.saleSP))])],1),a("v-uni-view",{staticClass:"modal-item-rig"},[t._v(" "+t._s(e.saleDate)+" ")])],1)})),a("v-uni-view",{staticClass:"modal-foot",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeHistoryPrice.apply(void 0,arguments)}}},[t._v("关闭")])],2)],1)],2)},s=[]},"71cb":function(t,e,i){"use strict";var a=i("8bdb"),s=i("1dbd"),o=i("1099"),n=i("1fc1"),r=i("497b"),d=i("3242");a({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=o(this),i=n(e),a=d(e,0);return a.length=s(a,e,e,i,0,void 0===t?1:r(t)),a}})},"846e":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoAQMAAAC2MCouAAAABlBMVEVHcEyXl5c3HTAeAAAAAXRSTlMAQObYZgAAADNJREFUCNdjYCAG8DAYwEjm////H4CRQBE4CVQAJ5HVIIsjk/w2H+AkbjUIEpcaJLuIAABy9Sm5sM//IAAAAABJRU5ErkJggg=="},8824:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c"),i("c223"),i("aa9c"),i("5ef2"),i("20f3");var a={previewPhoto:function(t,e){var i=e.map((function(t,e){return t.picture}));uni.previewImage({current:i[t],urls:i})},unique:function(t,e){for(var i=t.concat(e),a={},s=[],o=0;o<i.length;o++)a["s_"+i[o].id]=i[o];for(var n in a)s.push(a[n]);return s},IsPicture:function(t){if(t&&t.indexOf(".")>-1){var e=t.lastIndexOf("."),i=t.substring(e,t.length)+"|";if(i=i.toLowerCase(),".jpeg|.gif|.jpg|.png|.bmp|.pic|.svg|".indexOf(i)>-1)return!0}return!1}};e.default=a},"892f":function(t,e,i){"use strict";var a=i("4f23"),s=i.n(a);s.a},9796:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAElBMVEVHcEz/uCL/uSP/uCL/vCL/uCJcCjI6AAAABXRSTlMA50mtJj8sjiYAAABlSURBVDjLY2AgHbAYhmIAYQeghGMoFiAClDDFJhEMlBDFJhEIlAgNxbQXLDbEJEQDMSXAYopCmBLYxAYHUAzFCoSwRyAoCnFK4DRqsHodV0ThjNphk3ZxZU6c2RlnAYCzyCAVAACHaG1xFoswbQAAAABJRU5ErkJggg=="},"9ec0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwAgMAAAAqbBEUAAAADFBMVEVHcEz/uCL/uSP/uCITuKUYAAAAA3RSTlMA4kmZPqyEAAAALklEQVQoz2NgAAHOBAYEYL+AxOH/MKI58//DwTeGegTnLyoHRdlouGFLSNAkBgCQylhTmhAbcAAAAABJRU5ErkJggg=="},d17a:function(t,e,i){"use strict";(function(t){i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c"),i("c223"),i("c9b5"),i("bf0f"),i("ab80"),i("473f"),i("e838"),i("aa9c"),i("71cb"),i("f18a"),i("aa77"),i("dd2b"),i("dc8a"),i("2797"),i("d4b5");var s=a(i("b7c7")),o=a(i("5de6")),n=a(i("9b1b")),r=a(i("8824")),d=i("8f59"),c={data:function(){return{date:this.timeShift.getDate({format:!0}),noPriceChangeAllowed:!1,discountAuthChange:!1,startDate:this.timeShift.getDate("start"),endDate:this.timeShift.getDate("end"),customerName:"",customerId:"",warehouse:"",storehouseId:"",customersiteName:"",customersiteId:"",shopList:[],orderStat:!1,total:0,employeeId:"",employeeName:"",footFlag:!1,historyprice:"",remarksVal:"",arrearsAdvance:"",creditAmount:"",goodsRemark:"",saleBillId:"",saleNo:"",customer:{},storehouse:{},customersite:{},strogeobj:{},inputValue:"",barCodeKeyword:"",focusOne:!1,focusTwo:!1,userFeedbackHidden:!0,discount:"",NewTotal:"",conponAmt:0,color:"rgb(247 192 29)",isSetGift:!1,hander:{name:"",id:0},saleman:{name:"",id:0},handlers:[],salesmans:[],selectType:"customer",goodsAccumulationCheck:!1,priceDisplayNone:0,fieldConfig:{salesmanId:!1,operatorId:!1,customersiteId:!1,remark:!1,deptId:!1},requireConfig:{},useMultUnit:!1,orderSource:0,department:{name:"",id:0},departments:[],promotion:{}}},methods:(0,n.default)((0,n.default)({},(0,d.mapMutations)(["setparams"])),{},{handlersList:function(t){uni.hideKeyboard(),this.setparams({searchtype:"allEmployeesInfo",filed:1==t?"handlers":"salesmans",tips:1==t?"经手人":"业务员"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"})},handlersInfo:function(){uni.hideKeyboard(),this.setparams({searchtype:"dictionnaryInfo",filed:"departments",tips:"部门"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"})},enquiryDocuments:function(){var e=this;this.get("sale/getSaleIdData",{id:this.saleBillId},3).then((function(i){if(i.meta.success){var a=i.data.saleDetailList;e.shopList=(a||[]).map((function(t){return(0,n.default)((0,n.default)({},t),{},{isGift:9==t.orderType,itemQuantity:t.specUnitQuantity||t.itemQuantity})})),t.log("13132",a);for(var s=0;s<a.length;s++)a[s].picture||(a[s].picture="../../../../static/img/outNote/photo.png"),a[s].orderQuantity||(a[s].orderQuantity=0);e.orderStat=!0,e.customerName=i.data.customerName,e.warehouse=i.data.storehouseName,e.customerId=i.data.customerId,e.customersiteId=i.data.customersiteId,e.customersiteName=i.data.customersiteName,e.hander={name:i.data.operatorName,id:i.data.operatorId},e.saleman={name:i.data.salesmanName,id:i.data.salesmanId},e.department={name:i.data.deptName,id:i.data.deptId},e.storehouseId=i.data.storehouseId,e.remarksVal=i.data.remark?i.data.remark:"",e.saleNo=i.data.saleNo,e.orderSource=i.data.orderSource,e.date=e.timeShift.formatDate(i.data.fillDate)||e.timeShift.getDate({format:!0}),uni.setStorageSync("shopList",e.shopList),e.$data.warehouseName=i.data.storehouseName,e.$data.customerName=i.data.customerName,e.$data.ids=i.data.customerId,e.$data.warehouseId=i.data.storehouseId}}))},bindDateChange:function(t){this.date=t.target.value},customerList:function(){this.setparams({searchtype:"customer",filed:"customer"}),uni.navigateTo({url:"../../components/toolssearchlist/toolssearchlist"})},warehouseList:function(){this.setparams({searchtype:"storehouse",filed:"storehouse"}),uni.navigateTo({url:"../../components/toolssearchlist/toolssearchlist"})},customersiteList:function(){this.customerId?(this.setparams({searchtype:"customersite",filed:"customersite",customerId:this.customerId}),uni.navigateTo({url:"../../components/toolssearchlist/toolssearchlist"})):uni.showToast({icon:"none",title:"请选择客户",duration:2e3})},search:function(t){var e=this;this.customerId?this.storehouseId?(this.inputValue=t.detail.value,this.getCommodity().then((function(){e.focusTwo&&(e.focusTwo=!1),setTimeout((function(){e.focusTwo=!0}),0)}))):uni.showToast({icon:"none",title:"请选择仓库",duration:2e3}):uni.showToast({icon:"none",title:"请选择客户",duration:2e3})},commodityList:function(){this.customerId?this.storehouseId?(this.setparams({khId:this.customerId,storehouseId:this.storehouseId,inputValue:"",isNeedJudgeInventory:!0,isShowAvailableStock:!0,isUsePromotionPrice:!0,isNeedJudgeQuantity:!0,goodsAccumulationCheck:this.goodsAccumulationCheck,billtype:"outNote"}),this.priceDisplayNone?uni.navigateTo({url:"../../commodityList/commodityList?priceDisplayNone=".concat(this.priceDisplayNone,"&&isSetGift=").concat(this.isSetGift)}):uni.navigateTo({url:"../../commodityList/commodityList?isSetGift=".concat(this.isSetGift)})):uni.showToast({icon:"none",title:"请选择仓库",duration:2e3}):uni.showToast({icon:"none",title:"请选择客户",duration:2e3})},remarks:function(t){this.remarksVal=t.detail.value,this.strogeobj.remarks=this.remarksVal,uni.setStorageSync("outNoteTemp",this.strogeobj)},scanning:function(){var t=this;this.customerId?this.storehouseId?uni.scanCode({success:function(e){t.barCodeKeyword=e.result.toString(),t.getCommodity(!0)}}):uni.showToast({icon:"none",title:"请选择仓库",duration:2e3}):uni.showToast({icon:"none",title:"请选择客户",duration:2e3})},getCommodity:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this;return this.get("search/goods/list",{pageNum:1,pageSize:10,keyword:this.inputValue,khId:this.customerId,barCodeKeyword:this.barCodeKeyword,storehouseId:this.storehouseId,billTypeCode:"202"},3).then((function(r){if(a.inputValue="",r.meta.success){var d=r.data.list.list;if(t.log("res",r),d.length>0){var c=Array.prototype.reduce.call(d||[],(function(t,a){var s=a.barCode,o=a.saleIP,r=a.saleSP,d=a.id,c=a.picture,u=a.promotionIP,l=a.promotionSP,h=a.packingSpecification,m=a.modePrice,f=a.limitQuantity,p=a.scatteredPrice,v=i?s==e.barCodeKeyword?0:1:0,g=i?v?0:1:0;1!=h||o!=r||e.useMultUnit||(v=1,g=0),e.useMultUnit&&(v=1,g=0);var A=e.useMultUnit?(m*v).toFixed(4):parseFloat(parseFloat(u||o||0)*parseFloat(v)+parseFloat(l||r||0)*parseFloat(g)).toFixed(4),w=Array.prototype.some.call(e.shopList||[],(function(t){return t.id==d}));return t[~~w].push((0,n.default)((0,n.default)({},a),{},{remark:"",discount:100,amount:A,itemQuantity:v,scatteredQuantity:g,limitQuantity:f||0,scatteredPrice:p,saleIP:u||o||0,saleSP:l||r||0,picture:c||"../../../static/img/outNote/photo.png",isGift:!1})),t}),[[],[]]),u=(0,o.default)(c,2),l=u[0],h=u[1];e.goodsAccumulationCheck?e.shopList=[].concat((0,s.default)([l,h].flat()),(0,s.default)(e.shopList)):h.length>0?e.shopList=e.shopList.map((function(t){var e=h.find((function(e){return e.id==t.id&&!t.isGift}));if(e){var i=parseFloat(t.itemQuantity||0)+parseFloat(e.itemQuantity),a=parseFloat(t.scatteredQuantity||0)+parseFloat(e.scatteredQuantity),s=(parseFloat(t.amount||0)+parseFloat(e.amount)*(parseFloat(t.discount||100)/100)).toFixed(4);return(0,n.default)((0,n.default)({},t),{},{itemQuantity:i,scatteredQuantity:a,amount:s})}return t})).concat(l):e.shopList=[].concat((0,s.default)(l),(0,s.default)(e.shopList)),e.orderStat=!0}else uni.showToast({title:"暂无该商品",icon:"none"})}}))},closeOpen:function(t,e){this.shopList[e].checked=!this.shopList[e].checked,this.$forceUpdate()},previewPhoto:function(t){r.default.previewPhoto(t,this.shopList)},saleDetaEvent:function(t,e){},goBack:function(){uni.navigateBack({delta:1})},priceIP:function(t,e){if(this.useMultUnit)this.getMultUnitChange(e,{modePrice:t.detail.value});else{var i=this.shopList[e];i.discount;i.saleIP=this.RegExp.floatRound4(t.detail.value),i.saleSP=this.RegExp.floatRound4(i.saleIP/parseFloat(i.packingSpecification));var a=parseFloat(i.itemQuantity)*parseFloat(i.saleIP),s=parseFloat(i.scatteredQuantity)*parseFloat(i.saleSP),o=this.changeDiscount(i.discount);i.amount=parseFloat((a+s)*o).toFixed(4),uni.setStorageSync("shopList",this.shopList)}},numberIP:function(e,i){if(this.useMultUnit)this.getMultUnitChange(i,{itemQuantity:e.detail.value});else{var a=this.shopList[i];a.itemQuantity=this.RegExp.floatRound4(e.detail.value);a.discount;t.log("item.itemQuantity：：",a.itemQuantity);var s=parseFloat(a.itemQuantity)*parseFloat(a.saleIP),o=parseFloat(a.scatteredQuantity)*parseFloat(a.saleSP),n=this.changeDiscount(a.discount);a.amount=parseFloat((s+o)*n).toFixed(4),uni.setStorageSync("shopList",this.shopList)}},priceSP:function(e,i){t.log("priceSP:",e.detail.value);var a=this.shopList[i];a.discount;a.saleSP=this.RegExp.floatRound4(e.detail.value),a.saleIP=this.RegExp.floatRound4(parseFloat(a.saleSP)*parseFloat(a.packingSpecification));var s=parseFloat(a.itemQuantity)*parseFloat(a.saleIP),o=parseFloat(a.scatteredQuantity)*parseFloat(a.saleSP),n=this.changeDiscount(a.discount);a.amount=parseFloat((s+o)*n).toFixed(4),uni.setStorageSync("shopList",this.shopList)},numberSP:function(e,i){t.log("numberSP:",e.detail.value);var a=this.shopList[i];a.discount;a.scatteredQuantity=this.RegExp.floatRound4(e.detail.value);var s=parseFloat(a.itemQuantity)*parseFloat(a.saleIP),o=parseFloat(a.scatteredQuantity)*parseFloat(a.saleSP),n=this.changeDiscount(a.discount);a.amount=parseFloat((s+o)*n).toFixed(4),uni.setStorageSync("shopList",this.shopList)},discountChange:function(t,e){var i=this.shopList[e],a=this.discountIsNaN(t.detail.value)?"":t.detail.value;a=a>100?"":a,i.discount=a>100?"":a,i.amount=this.setAllDiscountAmount(i,a)},changeDiscount:function(t){var e=1;return e="NaN"===String(parseFloat(t))||0===parseFloat(t)||100===parseFloat(t)?1:parseFloat(t)/100,e},goodsremarks:function(e,i){t.log("event.detail.value：：",e.detail.value),this.shopList[i].remark=e.detail.value},delectItem:function(e,i){this.shopList.splice(i,1),t.log("this.shopList::",this.shopList),this.shopList.length>0&&uni.setStorageSync("shopList",this.shopList),0==this.shopList.length&&(this.orderStat=!1,uni.removeStorageSync("shopList"))},historyPrice:function(e,i){var a=this;this.get("search/goods/history",{goodsId:this.shopList[i].id,khId:this.customerId},3).then((function(e){t.log("历史：",e),e.meta.message&&e.data.length>0?(a.historyprice=e.data,a.footFlag=!0):(uni.showToast({icon:"none",title:"暂无历史售价",duration:2e3}),a.footFlag=!1)}))},closeHistoryPrice:function(){this.footFlag=!1},handleRequireController:function(){if(this.requireConfig&&Object.keys(this.requireConfig).length>0&&this.fieldConfig&&Object.keys(this.fieldConfig).length>0){if(this.fieldConfig.salesmanId&&this.requireConfig.salesmanId&&(!this.saleman||!this.saleman.id||!this.saleman.name))return uni.showToast({title:"请选择业务员",icon:"none"}),!1;if(this.fieldConfig.operatorId&&this.requireConfig.operatorId&&(!this.hander||!this.hander.id||!this.hander.name))return uni.showToast({title:"请选择经手人",icon:"none"}),!1;if(this.fieldConfig.customersiteId&&this.requireConfig.customersiteId&&(!this.customersiteName||!this.customersiteId))return uni.showToast({title:"请选择工地",icon:"none"}),!1;if(this.fieldConfig.remark&&this.requireConfig.remark&&!this.remarksVal)return uni.showToast({title:"请输入备注",icon:"none"}),!1;if(this.fieldConfig.credit&&this.requireConfig.credit&&!this.creditAmount)return uni.showToast({title:"请输入信用额",icon:"none"}),!1;if(this.fieldConfig.arrearsAdvance&&this.requireConfig.arrearsAdvance&&!this.arrearsAdvance)return uni.showToast({title:"请输入欠款/预收",icon:"none"}),!1;if(this.fieldConfig.deptId&&this.requireConfig.deptId&&(!this.department||!this.department.id||!this.department.name))return uni.showToast({title:"请选择部门",icon:"none"}),!1}return!0},creatNewDocm:function(){var e=this,i=this.handleRequireController();if(i){for(var a=[],s=[],o=0;o<this.shopList.length;o++){var n={goodsId:0,saleIP:0,saleSP:0,itemQuantity:0,scatteredQuantity:0};n.discount=this.shopList[o].discount,n.saleDetailId=this.shopList[o].saleDetailId||"",n.goodsId=this.shopList[o].id,n.barCode=this.shopList[o].barCode,n.saleIP=this.shopList[o].saleIP,n.saleSP=this.shopList[o].saleSP,n.itemQuantity=this.shopList[o].itemQuantity,n.scatteredQuantity=this.shopList[o].scatteredQuantity,n.packingSpecification=this.shopList[o].packingSpecification,n.smallUnit=this.shopList[o].smallUnit,n.picture=this.shopList[o].picture,n.goodsName=this.shopList[o].goodsName,n.brandName=this.shopList[o].brandName,n.orderQuantity=this.shopList[o].orderQuantity,n.remark=this.shopList[o].remark,this.shopList[o].isGift?n.orderType=9:this.shopList[o].promotionIP||this.shopList[o].promotionSP?n.orderType=3:n.orderType=1,this.useMultUnit&&(n.specUnitPrice=this.shopList[o].modePrice,n.multiunitId=this.shopList[o].multiunitId,n.specUnitQuantity=this.shopList[o].itemQuantity),a.push(n)}for(var r=0,d=a;r<d.length;r++){var c=d[r];0==c.itemQuantity&&0==c.scatteredQuantity||s.push(c)}t.log("endList",s),uni.showLoading({title:"开单中",mask:!0}),this.post("sale",{employeeId:this.employeeId,employeeName:this.employeeName,customerId:this.customerId,customerName:this.customerName,operatorId:this.hander.id,operatorName:this.hander.name,salesmanId:this.saleman.id,salesmanName:this.saleman.name,saleDetailList:s,storehouseId:this.storehouseId,customersiteId:this.customersiteId,remark:this.remarksVal,type:"202",id:this.saleBillId?this.saleBillId:-1,orderSource:this.orderSource?this.orderSource:0,deptId:this.department.id,deptName:this.department.name,fillDate:this.date},3).then((function(t){if(uni.hideLoading(),t&&t.meta&&0==t.meta.success)uni.showToast({title:t.meta.message,icon:"none",duration:3e3});else if(t.meta.success){e.switchTab=!0,e.categoryList=t.data;var i=e.saleNo?e.saleNo:t.data.obj.saleNo;uni.navigateTo({url:"../../../publicPage/billSuccess/billSuccess?sourceType=202&saleNo="+i+"&id="+t.data.obj.id}),e.doRefresh()}else uni.showToast({title:t.meta.message,icon:"none",duration:1e3})}))}},showDiv:function(){this.userFeedbackHidden=!1,this.discount=100,t.log(this.shopList)},hideDiv:function(){this.userFeedbackHidden=!0},ToDiscount:function(){this.showDiv()},setHeader:function(){uni.navigateTo({url:"../../commodityListSet/commodityListSet?billTypeCode=app202&isHeader=1"})},clearAllDate:function(){var t=this;t.customerName||t.warehouse||t.remarksVal||t.shopList.length>0?uni.showModal({title:"温馨提示",content:"是否清空当前页面数据",success:function(e){e.confirm?(t.doRefresh(!0),t.$forceUpdate(),t.orderStat=!1):e.cancel}}):uni.showToast({title:"当前页面无数据可清空",icon:"none",duration:1e3})},doRefresh:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.customerName="",this.customerId="",this.warehouse="",this.storehouseId="",this.remarksVal="",this.arrearsAdvance="",this.creditAmount="",this.shopList=[],this.$data.warehouseName="",this.saleBillId="",this.inputValue="",this.barCodeKeyword="",this.customersiteId="",this.customersiteName="",this.saleNo="",this.hander={name:"",id:0},this.saleman={name:"",id:0},this.department={name:"",id:0},uni.removeStorageSync("shopList"),t&&uni.removeStorageSync("outNoteTemp")},initData:function(){this.employeeId=uni.getStorageSync("id"),this.employeeName=uni.getStorageSync("name");var e=uni.getStorageSync("outNoteTemp");t.log("tempData",e),null!=e&&""!=e&&(this.strogeobj=e,this.customerName=e.customerName,this.customerId=e.customerId,this.customersiteId=e.customersiteId,this.customersiteName=e.customersiteName,this.warehouse=e.warehouse,this.storehouseId=e.storehouseId||""),uni.getStorageSync("saleBillId")&&(this.saleBillId=uni.getStorageSync("saleBillId"),this.enquiryDocuments()),uni.removeStorageSync("saleBillId")},getMainOtherInfo:function(t,e){var i=this;e&&t&&this.get("api/sale/app/mainOtherInfo",{storehouseId:t,customerId:e},1).then((function(t){t&&t.meta&&t.meta.success&&t&&t.data&&(i.creditAmount=t.data.creditAmount?t.data.creditAmount:0,i.arrearsAdvance=(t.data.arrears?t.data.arrears:0)+"/"+(t.data.advance?t.data.advance:0))}))},discountIsNaN:function(t){return!(t&&!isNaN(t)&&parseFloat(t))&&(uni.showToast({title:"折扣应为数字并且不能为零",icon:"none",duration:1e3}),!0)},submitFeedback:function(){var t=this;this.discountIsNaN(this.discount)||(this.shopList=this.shopList.map((function(e){return(0,n.default)((0,n.default)({},e),{},{discount:parseFloat(t.discount),amount:t.setAllDiscountAmount(e,t.discount)})})))},setAllDiscountAmount:function(t,e){var i=t.saleIP,a=t.saleSP,s=t.itemQuantity,o=t.scatteredQuantity,n=t.modePrice;if(this.useMultUnit){var r=this.changeDiscount(e);return(n*s*r).toFixed(4)}var d=this.RegExp.floatRound4(i),c=this.RegExp.floatRound4(a),u=parseFloat(s)*parseFloat(d),l=parseFloat(o)*parseFloat(c),h=this.changeDiscount(e);return parseFloat((u+l)*h).toFixed(4)},toHistory:function(){uni.setStorageSync("Type",202),uni.switchTab({url:"/pages/documentHistorys/index"})},switchchange:function(t){t.isGift=!t.isGift},getAllAmount:function(){var t=this,e=0,i=0;Array.prototype.forEach.call(this.shopList||[],(function(a){var s=a.amount,o=a.saleIP,n=a.saleSP,r=a.itemQuantity,d=a.scatteredQuantity,c=a.isGift,u="NaN"===s||c?0:parseFloat(s),l=0;if(!c&&!t.useMultUnit){var h=t.RegExp.floatRound4(o),m=t.RegExp.floatRound4(n),f=parseFloat(r)*parseFloat(h),p=parseFloat(d)*parseFloat(m);l=f+p}t.useMultUnit&&(l=a.modePrice*a.itemQuantity),e+=u,i+=l})),this.total=e.toFixed(4),this.conponAmt=(i-e).toFixed(4)},getShowPriceAuth:function(){var t=this,e=this.customerId;if(!e){var i=uni.getStorageSync("outNoteTemp");if(!i)return;e=i.customerId}this.get("search/price/auth",{khId:e},3).then((function(e){e.meta.success?void 0!=e.data.hasPriceAuth&&(t.priceDisplayNone=!e.data.hasPriceAuth):(t.priceDisplayNone=1,uni.showToast({title:"价格显示权限接口错误",icon:"none",duration:1e3}))}))},datBillScreenConfigList:function(){var t=this,e={},i={};this.get("pub/billSetting/list",{singleType:"app202"},4).then((function(a){a.meta.success&&a.data.length>0?(a.data.forEach((function(t){t.prop&&(e[t.prop]=t.display),t.required&&(i[t.prop]=t.required)})),t.fieldConfig=(0,n.default)({},e),t.requireConfig=(0,n.default)({},i)):uni.showToast({icon:"none",title:a.meta.message,duration:2e3})}))},getSelectUnit:function(e){var i=this,a=this.shopList[e],s={goodsId:a.id,customerId:i.customerId,storehouseId:i.storehouseId,type:202,longDate:(new Date).getTime()};i.$store.dispatch("getPrice",s).then((function(a){if(a.meta.success){if(!a.data.specUnitList.length)return void uni.showToast({icon:"none",title:"该商品没有设置多单位!",duration:2e3});var s=a.data.specUnitList;i.promotion=JSON.parse(JSON.stringify(a.data)),uni.showActionSheet({itemList:s.map((function(t){return"".concat(t.name," (1x").concat(t.packingSpecification,")")})),success:function(a){var o=s[a.tapIndex];t.log("selected",o),i.getMultUnitChange(e,o)},fail:function(e){t.log(e.errMsg)}})}else uni.showToast({icon:"none",title:a.meta.message,duration:2e3})}))},getMultUnitChange:function(t,e){var i=this.shopList[t];e.modePrice&&(i.modePrice=e.modePrice),e.itemQuantity&&(i.itemQuantity=e.itemQuantity),e.id&&(i.multiunitId=e.id,i.specUnit=e.name,i.modePrice=e.modePrice,i.multipleUnitSpecification=e.packingSpecification);var a=this.changeDiscount(i.discount);if(i.amount=(i.modePrice*i.itemQuantity*a).toFixed(4),this.useMultUnit&&e.id&&this.promotion&&this.promotion.isPromotion&&this.promotion.promotionSP){var s=e.itemQuantity?e.itemQuantity:i.itemQuantity?i.itemQuantity:0;i.itemQuantity=s||0;var o=i.itemQuantity,n=i.limitQuantity?i.limitQuantity:this.promotion.limitQuantity?this.promotion.limitQuantity:0,r=i.multipleUnitSpecification?i.multipleUnitSpecification:1,d=i.scatteredPrice?i.scatteredPrice:this.promotion.scatteredPrice?this.promotion.scatteredPrice:0;i.modePrice=0==n||o*r>=n?this.promotion.promotionSP*r:d*r,i.amount=(i.modePrice*i.itemQuantity*a).toFixed(4)}this.$set(this.shopList,t,i),uni.hideKeyboard()}}),watch:{shopList:{handler:function(t,e){this.getAllAmount(),uni.setStorageSync("shopList",t)},deep:!0},customer:function(t){null!=t&&t.length>0&&(this.customerId=t[0].id,this.customerName=t[0].name,this.strogeobj.customerId=this.customerId,this.strogeobj.customerName=this.customerName,this.customersiteId="",this.customersiteName="",this.strogeobj.customersiteId=this.customersiteId,this.strogeobj.customersiteName=this.customersiteName,this.customer=t[0],uni.setStorageSync("outNoteTemp",this.strogeobj),this.getShowPriceAuth())},customersite:function(t){null!=t&&t.length>0&&(this.customersiteId=t[0].id,this.customersiteName=t[0].name,this.strogeobj.customersiteId=this.customersiteId,this.strogeobj.customersiteName=this.customersiteName,uni.setStorageSync("outNoteTemp",this.strogeobj))},storehouse:function(t){null!=t&&t.length>0&&(this.warehouse=t[0].name,this.storehouseId=t[0].id,this.strogeobj.warehouse=this.warehouse,this.strogeobj.storehouseId=this.storehouseId,uni.setStorageSync("outNoteTemp",this.strogeobj))},customerId:function(t){null!=t&&this.storehouseId&&this.getMainOtherInfo(this.storehouseId,t)},storehouseId:function(t){null!=t&&this.customerId&&this.getMainOtherInfo(t,this.customerId)}},onLoad:function(){var e=this;t.log("执行初始化");var i=uni.getStorageSync("privilegeMap");if(1==i.priceAuth&&(this.noPriceChangeAllowed=!0),1==i.discountAuth&&(this.discountAuthChange=!0),this.isSetGift=!!uni.getStorageSync("isSetGift"),this.get("api/sysconfig/find",{key:"sale.goods.accumulation"},1).then((function(t){t.meta.success?1==t.data.check?e.goodsAccumulationCheck=!0:e.goodsAccumulationCheck=!1:uni.showToast({title:t.meta.message,icon:"none",duration:1e3})})),!uni.getStorageSync("outNoteTemp")){var a=uni.getStorageSync("defaultStorehouseId");if(!a)return void t.error("默认仓库ID未设置");this.get("api/basicData/organization/".concat(a),{isApp:1},1).then((function(i){if(i.meta.success){var s=i.data.organizationId;e.get("api/basicData/listOrganizationByorganizationId",{organizationIds:s},1).then((function(s){if(s.meta.success){var o=s.data,n=o.find((function(t){return t.id===a}));if(n){var r=i.data,d=r.name,c=r.id;e.warehouse=d,e.storehouseId=c,e.strogeobj={warehouse:e.warehouse,storehouseId:e.storehouseId},uni.setStorageSync("outNoteTemp",e.strogeobj)}}else t.error("获取机构列表失败",s.meta.message)})).catch((function(e){t.error("在获取仓库列表时发生错误",e)}))}else t.error("获取仓库信息失败",i.meta.message)})).catch((function(e){t.error("在获取仓库信息时发生错误",e)}))}this.getShowPriceAuth(),this.useMultUnit=uni.getStorageSync("useMultUnit")},computed:(0,n.default)({},(0,d.mapState)(["params"])),onShow:function(){if("handlers"==this.selectType||"salesmans"==this.selectType)this.hander=this.handlers&&this.handlers.length>0?this.handlers[0]:{name:""},this.saleman=this.salesmans&&this.salesmans.length>0?this.salesmans[0]:{name:""};else if("customer"==this.selectType){var e=this.customer&&Array.isArray(this.customer)?this.customer[0]:this.customer;this.saleman=e?{name:e.salesmanName,id:e.salesmanId}:{name:"",id:-1}}else"departments"==this.selectType&&(this.department=this.departments&&this.departments.length>0?this.departments[0]:{name:""});var i=uni.getStorageSync("shopList");if(0!=i.length){var a=uni.getStorageSync("shopList");this.shopList=a.map((function(t){return(0,n.default)((0,n.default)({},t),{},{isGift:!!t.isGift})})),t.log("~~~~~~~",this.shopList),this.orderStat=!0}else this.orderStat=!1;this.initData(),this.selectType="",this.datBillScreenConfigList()}};e.default=c}).call(this,i("ba7c")["default"])},d4af:function(t,e,i){"use strict";i.r(e);var a=i("d17a"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},d56f:function(t,e,i){"use strict";i.r(e);var a=i("60da"),s=i("d4af");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("892f");var n=i("828b"),r=Object(n["a"])(s["default"],a["b"],a["c"],!1,null,"5fd5cad2",null,!1,a["a"],void 0);e["default"]=r.exports},ee59:function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,"uni-page-body[data-v-5fd5cad2]{background-color:#f6f6f6}body.?%PAGE?%[data-v-5fd5cad2]{background-color:#f6f6f6}.head[data-v-5fd5cad2]{display:flex;justify-content:space-between;font-weight:590}.header-left[data-v-5fd5cad2]{width:20%}.header-middle[data-v-5fd5cad2]{width:25%}.head uni-image[data-v-5fd5cad2]{width:%?48?%;height:%?48?%;margin:%?7?% %?15?%;display:block}.header-right[data-v-5fd5cad2]{display:flex;\r\n\t/* width: 28%; */width:31%}.middle[data-v-5fd5cad2]{padding:%?40?%;margin-top:%?40?%}.item[data-v-5fd5cad2]{display:flex;height:%?80?%;line-height:%?80?%;padding-bottom:%?20?%}.item[data-v-5fd5cad2]:last-child{padding-bottom:0}.middle-des[data-v-5fd5cad2]{font-size:%?32?%;width:%?160?%;text-align:right}.middle-select[data-v-5fd5cad2]{display:flex;justify-content:space-between;background:#f7f6fb;width:%?496?%;font-size:%?30?%;border-radius:5px}uni-picker[data-v-5fd5cad2]{padding-left:%?20?%;width:%?496?%}.middle-select uni-input[data-v-5fd5cad2]{height:%?80?%;line-height:%?80?%;font-size:%?30?%;padding-left:%?20?%}.middle-select uni-text[data-v-5fd5cad2]{color:#ffb822;font-size:%?26?%;width:%?200?%}.middle-select uni-image[data-v-5fd5cad2]{width:%?40?%;height:%?40?%;padding-right:%?20?%;padding-top:%?20?%}.sweepCode[data-v-5fd5cad2]{border-bottom:%?2?% #eee solid;display:flex;justify-content:space-between}.sweepCode uni-image[data-v-5fd5cad2]{width:%?48?%;height:%?48?%;padding:%?26?% %?100?%}.order-item[data-v-5fd5cad2]{padding:%?40?% %?40?% 0 %?40?%}.order-item-top[data-v-5fd5cad2]{\r\n\t/* display: flex; */display:-webkit-box}.order-item-left[data-v-5fd5cad2]{width:%?160?%;height:%?160?%}.order-item-right[data-v-5fd5cad2]{\r\n\t/* flex: 1; */margin-left:%?20?%;display:flex}.order-inside[data-v-5fd5cad2]{display:flex;box-sizing:border-box;flex-direction:column;justify-content:space-between}.inside-left[data-v-5fd5cad2]{width:70%}.inside-right[data-v-5fd5cad2]{width:30%;align-items:flex-end}\r\n\r\n/* .order-fir {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n} */.order-fir-left[data-v-5fd5cad2]{font-size:%?32?%;font-weight:500;width:%?350?%}.order-fir-right[data-v-5fd5cad2]{font-size:%?32?%;font-weight:500;display:flex;justify-content:space-between}\r\n\r\n/* \r\n.order-sec {\r\n\tmargin-top: 20upx;\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n} */.order-sec-left[data-v-5fd5cad2]{font-size:%?28?%;color:grey}.order-sec-right[data-v-5fd5cad2]{font-size:%?28?%;color:#3378ff}.order-item-bottom[data-v-5fd5cad2]{margin-top:%?20?%}.bottom-fir[data-v-5fd5cad2]{padding:%?20?% 0;display:flex;justify-content:space-between;border-bottom:%?1?% solid #eee;border-top:%?1?% solid #eee}.bottom-des[data-v-5fd5cad2]{font-size:%?28?%;color:grey}.bottom-input[data-v-5fd5cad2]{display:flex;align-items:center;flex-direction:column;justify-content:space-between;flex:1}.bottom-input uni-input[data-v-5fd5cad2]{margin-top:%?20?%;font-size:%?32?%;color:#333;text-align:center}.bottom-sec[data-v-5fd5cad2]{height:%?70?%;line-height:%?70?%;display:flex;font-size:%?28?%}.bottom-sec-des[data-v-5fd5cad2]{color:grey}.bottom-sec-input[data-v-5fd5cad2]{height:%?40?%;line-height:%?40?%;margin-top:%?10?%;color:grey;font-size:%?28?%}.bottom-sec-num[data-v-5fd5cad2]{flex:1;text-overflow:ellipsis;word-break:break-all;overflow:hidden}.bottom-sec-switch[data-v-5fd5cad2]{margin-left:%?20?%;display:flex;font-size:%?28?%;line-height:%?40?%;align-items:center}.bottom-sec-switch .switch[data-v-5fd5cad2]{-webkit-transform:scale(.6);transform:scale(.6)}.order-item-foot[data-v-5fd5cad2]{margin-top:%?40?%;border-bottom:%?1?% solid #eee}.foot-des[data-v-5fd5cad2]{margin:0 auto;display:flex;font-size:%?24?%;color:grey;width:20%;justify-content:space-between;padding:%?15?% 0;margin-bottom:%?20?%}.foot-des uni-image[data-v-5fd5cad2]{width:%?17?%;height:%?10?%;margin-top:%?10?%}.footfixed[data-v-5fd5cad2]{display:block;position:fixed;bottom:%?0?%!important;\r\nbottom:%?100?%;\r\nwidth:100%;height:%?100?%;background:#fff;z-index:10}.foot-bg[data-v-5fd5cad2]{display:flex;padding-left:%?40?%;align-items:center}.foot-bg-left[data-v-5fd5cad2]{display:flex;flex:1;font-size:%?32?%;font-weight:500;text-align:left;line-height:%?45?%;flex-direction:column}.foot-bg-left uni-image[data-v-5fd5cad2]{width:%?48?%;height:%?48?%;margin:%?25?% %?20?% 0 %?90?%}.foot-bg-left-text[data-v-5fd5cad2]{font-size:%?24?%;font-weight:400;color:grey;line-height:%?33?%}.foot-bg-right[data-v-5fd5cad2]{width:30%;height:%?100?%;line-height:%?100?%;text-align:center;background:#ffb822;font-size:%?32?%;color:#fff}.foot-bg-left uni-text[data-v-5fd5cad2]{color:red}\r\n\r\n/* 历史售价 */.modal-box[data-v-5fd5cad2]{width:100%;height:100%;position:fixed;background:rgba(51,51,51,.6);top:0;left:0;z-index:999}.modal-body[data-v-5fd5cad2]{width:%?670?%;height:%?970?%;background:#fff;margin:%?200?% auto 0 auto;border-radius:%?10?%}.modal-title[data-v-5fd5cad2]{display:block;width:100%;height:%?120?%;line-height:%?120?%;text-align:center;font-size:%?32?%;font-weight:500;color:#333}.modal-item[data-v-5fd5cad2]{display:flex;font-size:%?28?%;font-weight:400;color:#666;height:%?60?%;line-height:%?60?%;justify-content:space-between;padding:0 %?30?%;height:%?740?%}.modal-item-lef uni-text[data-v-5fd5cad2]:last-child{margin-left:%?30?%}.modal-foot[data-v-5fd5cad2]{height:%?100?%;line-height:%?100?%;text-align:center;border-top:%?1?% solid #eee;font-size:%?28?%;font-weight:400}.popup_overlay[data-v-5fd5cad2]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:1001;-moz-opacity:.8;opacity:.8;filter:alpha(opacity=88)}.popup_content[data-v-5fd5cad2]{position:fixed;top:50%;left:50%;width:%?520?%;height:%?550?%;margin-left:%?-270?%;margin-top:%?-270?%;border:10px solid #fff;background-color:#fff;z-index:1002;overflow:auto;border-radius:%?20?%}.popup_title[data-v-5fd5cad2]{padding-top:%?20?%;width:%?440?%;text-align:center;font-size:%?32?%}.popup_textarea_item[data-v-5fd5cad2]{padding-top:%?5?%;height:%?120?%;width:%?440?%;background-color:#f1f1f1;margin-top:%?30?%;margin-left:%?20?%}.popup_textarea[data-v-5fd5cad2]{width:%?410?%;font-size:%?26?%;margin-left:%?20?%}.popup_button[data-v-5fd5cad2]{color:#fff;background-color:#ffb822;border-radius:%?20?%}.alldiscount[data-v-5fd5cad2]{font-size:%?28?%;font-family:PingFangSC-Regular,PingFang SC;line-height:%?40?%;padding:%?40?%;background-color:#fff;display:flex;align-items:center}.alldiscount uni-input[data-v-5fd5cad2]{font-size:%?28?%;flex:1;text-align:right;margin-left:%?10?%}.gift[data-v-5fd5cad2]{font-size:%?24?%;font-weight:400;color:#ef2f46;line-height:%?33?%;margin-right:%?10?%;padding:%?8?% %?10?%;background:#fef5f4;border-radius:%?2?%}",""]),t.exports=e},f18a:function(t,e,i){"use strict";var a=i("1cb5");a("flat")}}]);