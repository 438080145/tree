(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-customerTerritory-customerTerritory"],{1675:function(t,e,i){"use strict";i.r(e);var n=i("2b6b"),o=i("f684");for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("fe11");var s=i("828b"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"588ddc44",null,!1,n["a"],void 0);e["default"]=c.exports},17283:function(t,e,i){"use strict";var n=i("d4d7"),o={FindCustomerSaleLevelAll:function(t){return(0,n.get)("fx/fxVisitCustomer/findCustomerSaleLevelAll",t,3)},fxVisitCustomerPosition:function(t){return(0,n.get)("fx/fxVisitCustomer/customerPosition",t,3)}};t.exports=o},"2b6b":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"contain"},[t.priceModelist.length>0?i("v-uni-view",{staticClass:"top",staticStyle:{position:"absolute",bottom:"70upx","z-index":"222"}},[i("v-uni-picker",{staticClass:"top-picker",attrs:{value:t.priceMode,range:t.priceModelist,"range-key":"levelName"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindPickerChange.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"top-picker-value"},[t._v(t._s(t.priceModelist[t.priceMode].levelName))])],1)],1):t._e(),t.positionUrl?i("v-uni-web-view",{attrs:{src:t.positionUrl,"update-title":!1},on:{message:function(e){arguments[0]=e=t.$handleEvent(e),t.handleMapMessage.apply(void 0,arguments)}}}):t._e(),i("v-uni-view",{staticClass:"foot-buttons",staticStyle:{position:"absolute",bottom:"0",width:"100%"}},[i("v-uni-text",{staticClass:"foot-item foot-left",on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.submitConfirm.apply(void 0,arguments)}}},[t._v("首页")]),i("v-uni-text",{staticClass:"foot-item foot-right",on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.submitCancel.apply(void 0,arguments)}}},[t._v("返回")])],1)],1)},o=[]},"79ba":function(t,e,i){var n=i("d3cd");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("967d").default;o("34edb5cd",n,!0,{sourceMap:!1,shadowMode:!1})},ba27:function(t,e,i){"use strict";(function(t){i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(i("b7c7"));i("fd3c"),i("d4b5"),i("c223"),i("aa9c"),i("c9b5"),i("bf0f"),i("ab80"),i("e966"),i("8f71");var a=n(i("17283")),s=n(i("82d0")),c={components:{},data:function(){return{priceModelist:[],priceMode:0,windowWidth:0,windowHeight:0,longitude:113.352058,latitude:22.521721,covers:[],icons:[{icon:"../../../static/img/RedLevel.png",name:"RedLevel.png"},{icon:"../../../static/img/BlueLevel.png",name:"BlueLevel.png"},{icon:"../../../static/img/OrangeLevel.png",name:"OrangeLevel.png"},{icon:"../../../static/img/AshLevel.png",name:"AshLevel.png"}],positionUrl:"/hybrid/html/map.html",beforeMsg:null}},onLoad:function(e){t.log(e)},onShow:function(){this.getType()},mounted:function(){var t=this;uni.getSystemInfo({success:function(e){t.windowWidth=e.windowWidth,t.windowHeight=e.windowHeight}});var e=this.$scope.$getAppWebview();setTimeout((function(){var t=e.children()[0];t&&t.setStyle({bottom:uni.upx2px(160)})}),1e3)},methods:{handleMapMessage:function(e){t.log("地图postMessage",e);var i=e.detail,n=i.data[0];this.beforeMsg=n,n&&n.id?uni.navigateTo({url:"../customerManagement/updateInformation/updateInformation?id="+n.id+"&fromMap=true"}):uni.showToast({icon:"none",title:"当前客户数据异常",duration:2e3})},getTxMapMakerByList:function(t,e){var i=t.map((function(t){return{id:t.id,title:t.callout.content,longitude:t.longitude,latitude:t.latitude}})),n=JSON.stringify({markers:i,icon:e,beforeMsg:this.beforeMsg}),o=this.$scope.$getAppWebview().children()[0];setTimeout((function(){o.evalJS("init(".concat(n,")"))}),600)},getType:function(){var t=this;a.default.FindCustomerSaleLevelAll().then((function(e){if(e.meta.success){var i=[{type:0,levelName:"全部用户",salesDown:"",salesCap:"",statisticalRange:"",icon:"../../../static/img/location.png"}].concat((0,o.default)(e.data));t.priceModelist=i,t.initData()}else uni.showToast({icon:"none",title:e.meta.message,duration:2e3})}))},initData:function(){var t=this.priceModelist[this.priceMode],e=this,i={type:0===t.type?0:t.id,salesDown:t.salesDown,salesCap:t.salesCap,statisticalRange:t.statisticalRange};a.default.fxVisitCustomerPosition(i).then((function(i){if(i.meta.success)if(i.data.length>0){for(var n=[],o=0;o<i.data.length;o++){var a=i.data[o],c=s.default.bd09togcj02(e.parseFloatNum(a.longitude),e.parseFloatNum(a.latitude));null!=c&&c.length>0&&n.push({id:a.id,longitude:c[0],latitude:c[1],iconPath:t.icon,callout:{content:a.customerName,color:"#000",fontSize:10,borderRadius:20,padding:8,bgColor:"#fff",display:"ALWAYS",textAlign:"center"}})}e.getTxMapMakerByList(n,t.icon),e.covers=n,e.longitude=n[0].longitude,e.latitude=n[0].latitude}else uni.showToast({icon:"none",title:"暂无数据",duration:2e3}),e.covers=[];else uni.showToast({icon:"none",title:i.meta.message,duration:2e3})}))},saveHttpImg:function(e){uni.downloadFile({url:e,success:function(e){if(200===e.statusCode){var i=e.tempFilePath;t.log(i,"临时地址")}}})},parseFloatNum:function(t){if(t){var e=t.toString().split("."),i=e[1].length,n=parseInt(e[0])+parseInt(e[1])/Math.pow(10,i);return n}},toCustomerInfo:function(t){var e=this.covers.filter((function(e){return e.id===t.detail.markerId}));if(e.length>0){var i=e[0];uni.navigateTo({url:"../customerManagement/updateInformation/updateInformation?id="+i.id+"&fromMap=true"})}else uni.showToast({icon:"none",title:"当前客户数据异常",duration:2e3})},goBack:function(){uni.navigateBack({delta:1})},bindPickerChange:function(t){this.priceMode=t.detail.value,this.initData()},submitConfirm:function(){this.goBack()},submitCancel:function(){this.goBack()}}};e.default=c}).call(this,i("ba7c")["default"])},d3cd:function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,"uni-page-body[data-v-588ddc44]{background-color:#f6f6f6}body.?%PAGE?%[data-v-588ddc44]{background-color:#f6f6f6}.contain[data-v-588ddc44]{flex:1;display:flex;flex-direction:column;height:100%;background-color:#f6f6f6}.top[data-v-588ddc44]{position:fixed;left:0;right:0;display:flex;flex-direction:row;align-items:center;justify-content:space-between;margin:%?20?%;height:%?80?%;background-color:#fff;z-index:99}.top-image-box[data-v-588ddc44]{position:absolute;left:0;right:0;top:0;bottom:0;display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 %?20?%}.top-image[data-v-588ddc44]{width:%?40?%;height:%?40?%}.top-image-right[data-v-588ddc44]{width:%?30?%;height:%?30?%}.top-picker[data-v-588ddc44]{flex:1;display:flex;flex-direction:row;align-items:center;justify-content:center}.top-picker-value[data-v-588ddc44]{flex:1;display:flex;flex-direction:row;align-items:center;justify-content:center;height:%?80?%;line-height:%?80?%;font-size:%?30?%;text-align:center}.map[data-v-588ddc44]{flex:1}.foot-buttons[data-v-588ddc44]{display:flex;flex-direction:row;justify-content:center;align-items:center}.foot-item[data-v-588ddc44]{flex:1;display:flex;flex-direction:row;justify-content:center;align-items:center;height:%?80?%;font-size:%?32?%;line-height:%?80?%;text-align:center;color:#fff;background-color:#ffc235}.foot-left[data-v-588ddc44]{background-color:#f13a3a}",""]),t.exports=e},f684:function(t,e,i){"use strict";i.r(e);var n=i("ba27"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},fe11:function(t,e,i){"use strict";var n=i("79ba"),o=i.n(n);o.a}}]);