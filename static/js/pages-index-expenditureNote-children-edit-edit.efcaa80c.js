(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-expenditureNote-children-edit-edit"],{2263:function(t,e,i){"use strict";var a=i("d4d7"),n={listBillPage:function(t){return(0,a.get)("api/somebill/page",t,1)},authorganizationList:function(t){return(0,a.get)("api/basicData/authorganization/list",t,1)},dictionnaryList:function(t){return(0,a.get)("api/basedata/dictionnary/list",t,1)},billDetail:function(t){return(0,a.get)("api/accountVoucher/billDetail",t,1)},getKMListByAvType:function(t){return(0,a.get)("api/financial/getKmByFYZCD",t,1)},savePreOrCollectBill:function(t){return(0,a.post)("somebill/someBillSave",t,8)},checkBill:function(t){return(0,a.post)("api/somebill/checkSomeBill"+"?id=".concat(t.id),null,1)}};t.exports=n},3972:function(t,e,i){var a=i("7d03");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("967d").default;n("06be6419",a,!0,{sourceMap:!1,shadowMode:!1})},"3d69":function(t,e,i){"use strict";i.r(e);var a=i("ab39"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},"76cb":function(t,e,i){"use strict";i.r(e);var a=i("f9881"),n=i("3d69");for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);i("8ca5");var o=i("828b"),d=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"a655268e",null,!1,a["a"],void 0);e["default"]=d.exports},"7d03":function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,"uni-page-body[data-v-a655268e]{background-color:#f6f6f6}body.?%PAGE?%[data-v-a655268e]{background-color:#f6f6f6}.contain[data-v-a655268e]{background-color:#f6f6f6}.contain .middle[data-v-a655268e]{padding:0 %?40?%;padding-top:%?40?%;background:#fff}.contain .middle .item[data-v-a655268e]{display:flex;height:%?80?%;line-height:%?80?%;padding-bottom:%?20?%}.contain .middle .item[data-v-a655268e]:last-child{padding-bottom:0}.contain .middle .item .middle-des[data-v-a655268e]{font-size:%?32?%;width:%?160?%;text-align:right}.contain .middle .item .middle-select[data-v-a655268e]{display:flex;justify-content:space-between;background:#f7f6fb;width:%?496?%;font-size:%?30?%;border-radius:5px}.contain .middle .item .middle-select uni-input[data-v-a655268e]{height:%?80?%;line-height:%?80?%;font-size:%?30?%;padding-left:%?20?%}.contain .middle .item .middle-select uni-text[data-v-a655268e]{color:#ffb822;font-size:%?26?%;padding:0 %?20?%}.contain .middle .item .middle-select uni-image[data-v-a655268e]{width:%?40?%;height:%?40?%;padding-right:%?20?%;padding-top:%?20?%}.contain .middle .item uni-picker[data-v-a655268e]{padding-left:%?20?%;width:%?496?%}.contain .sweepCode[data-v-a655268e]{display:flex;justify-content:space-between;padding:0 %?40?%;border-bottom:%?2?% #eee solid;background:#fff}.contain .sweepCode uni-image[data-v-a655268e]{width:%?48?%;height:%?48?%;padding:%?26?% 0}.contain .shopList[data-v-a655268e]{margin-bottom:%?40?%;background:#fff}.contain .shopList .order-item[data-v-a655268e]{position:relative;padding:%?40?%;border-bottom:%?1?% solid #eee}.contain .shopList .order-item .order-item-row[data-v-a655268e]{display:flex;flex-direction:row;align-items:center;width:100%;color:grey}.contain .shopList .order-item .order-item-row-left[data-v-a655268e]{width:%?150?%;font-size:%?28?%;line-height:%?60?%}.contain .shopList .order-item .order-item-row-input[data-v-a655268e]{flex:1;font-size:%?28?%;border-bottom:1px solid #ddd}.contain .shopList .order-item .delete[data-v-a655268e]{position:absolute;top:0;right:0;padding:%?10?% %?20?%;color:red}.contain .paymentMethod[data-v-a655268e]{background-color:#fff;margin-bottom:%?40?%;padding:%?40?% %?40?% %?20?%}.contain .paymentMethod .paymentMethod-item[data-v-a655268e]{display:flex;align-items:center;height:%?80?%;padding-bottom:%?20?%;font-size:%?32?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-name[data-v-a655268e]{width:%?160?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue[data-v-a655268e]{flex:1;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-picker[data-v-a655268e], .contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-input[data-v-a655268e]{flex:1;height:%?80?%;padding-left:%?20?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue .right[data-v-a655268e]{width:%?48?%;height:%?48?%}.contain .footfixed[data-v-a655268e]{display:block;position:fixed;bottom:%?0?%!important;bottom:%?100?%;width:100%;height:%?100?%;background:#fff;z-index:10}.contain .footfixed .foot-bg[data-v-a655268e]{display:flex}.contain .footfixed .foot-bg .foot-bg-left[data-v-a655268e]{display:flex;width:70%;font-size:%?32?%;font-weight:500;text-align:center;line-height:%?100?%}.contain .footfixed .foot-bg .foot-bg-left uni-image[data-v-a655268e]{width:%?48?%;height:%?48?%;margin:%?25?% %?20?% 0 %?90?%}.contain .footfixed .foot-bg .foot-bg-left uni-text[data-v-a655268e]{color:red}.contain .footfixed .foot-bg .foot-bg-right[data-v-a655268e]{width:30%;height:%?100?%;line-height:%?100?%;text-align:center;background:#ffb822;font-size:%?32?%;color:#fff}.contain .hide[data-v-a655268e]{position:inherit;visibility:hidden}",""]),t.exports=e},"8ca5":function(t,e,i){"use strict";var a=i("3972"),n=i.n(a);n.a},ab39:function(t,e,i){"use strict";(function(t){i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("e838"),i("aa9c"),i("dd2b"),i("c223");var n,s=a(i("39d8")),o=a(i("9b1b")),d=a(i("2263")),l=i("8f59"),c=(a(i("63d3")),n={components:{},data:function(){return{item:null,createDate:"",createDateF:"",employees:{},handleName:"",handleNameId:0,fsId:"",fsName:"",dictionnaryList:[],dictionnaryIndex:0,organization:{},organizationId:0,organizationName:"",customer:{},customerId:"",customerName:"",amount:null,abstract:"",checkStatus:!0,billList:[],billListItem:{},billListUpIndex:-1,employeeLabel:{},employeeLabelUpIndex:-1,getKMListByAvTypeItem:null}},created:function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})},onLoad:function(t){var e=this.params.item;this.item=this.params.item,e?(this.createDate=e.createDate,this.createDateF=this.timeShift.formatDate(e.createDate),this.handleNameId=e.jsId,this.handleName=e.name,this.fsId=e.FSId,this.fsName=e.FSName,this.organizationId=e.orgId,this.customerId=e.kmId,this.customerName=e.Account,this.amount=e.amount,this.abstract=e.abstract,this.checkStatus=1===e.checkStatus):(this.item={id:null},this.createDate=(new Date).getTime(),this.createDateF=this.timeShift.formatDate(new Date),this.handleNameId=uni.getStorageSync("userId"),this.handleName=uni.getStorageSync("name")),this.initData(),this.dictionnary(),this.authorganizationList(),this.getKMListByAvType()},onShow:function(){},onReady:function(){},onReachBottom:function(){}},(0,s.default)(n,"created",(function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})})),(0,s.default)(n,"mounted",(function(){})),(0,s.default)(n,"computed",(0,o.default)({},(0,l.mapState)(["params"]))),(0,s.default)(n,"watch",{employees:function(t){null!=t&&t.length>0&&(this.handleName=t[0].name,this.handleNameId=t[0].id)},organization:function(t){var e=this;null!=t&&t.length>0&&(this.organizationName=t[0].name,this.organizationId=t[0].id,setTimeout((function(){e.initData()}),300))},customer:function(t){null!=t&&t.length>0&&(this.customerId=t[0].id,this.customerName=t[0].name)},billListItem:function(t){var e=this;null!=t&&t.length>0&&setTimeout((function(){var i=e.billList[e.billListUpIndex];i.allId=t[0].allId,i.asId=t[0].id,i.kmName=t[0].name,e.$forceUpdate()}),100)},employeeLabel:function(t){var e=this;null!=t&&t.length>0&&setTimeout((function(){var i=e.billList[e.employeeLabelUpIndex];i.tagId=t[0].id,i.labelName=t[0].labelName,e.$forceUpdate()}),100)}}),(0,s.default)(n,"methods",(0,o.default)((0,o.default)({},(0,l.mapMutations)(["setparams"])),{},{allEmployeesInfo:function(){var t=this;d.default.allEmployeesInfo(null).then((function(e){if(e.meta.success)for(var i=0;i<e.data.list.length;i++){var a=e.data.list[i];t.handleNameId===a.id&&(t.handleName=a.name)}else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},dictionnary:function(){var t=this;d.default.dictionnaryList({dictionaryTypeId:2}).then((function(e){if(e.meta.success)if(t.dictionnaryList=e.data,t.fsId)for(var i=0;i<t.dictionnaryList.length;i++){var a=t.dictionnaryList[i];a.id===t.fsId&&(t.dictionnaryIndex=i)}else t.fsId=t.dictionnaryList[0].id;else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},authorganizationList:function(){var t=this;d.default.authorganizationList(null).then((function(e){if(e.meta.success)if(t.organizationId)for(var i=0;i<e.data.length;i++){var a=e.data[i];a.id===t.organizationId&&(t.organizationName=a.name)}else t.organizationId=e.data[0].id,t.organizationName=e.data[0].name;else uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))},getKMListByAvType:function(){var t=this,e={orgId:t.organizationId};d.default.getKMListByAvType(e).then((function(e){e.meta.success?t.getKMListByAvTypeItem=e.data[0]:uni.showToast({title:e.meta.message,icon:"none",duration:1e3})})).then((function(e){t.item.id||t.addbillList()}))},initData:function(){var t=this;if(t.item.id){var e={id:t.item.id};d.default.billDetail(e).then((function(e){e.meta.success?(t.billList=e.data,t.arrearsFn()):uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))}},bindDateChange:function(t){this.createDate=new Date(t.target.value).getTime(),this.createDateF=t.target.value},handlersList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"allEmployeesInfo",filed:"employees",tips:"经手人"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},dictionnaryChange:function(t){this.dictionnaryIndex=t.detail.value,this.fsId=this.dictionnaryList[this.dictionnaryIndex].id},organizationList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"organization",filed:"organization"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},customerList:function(){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"collectionAccount",filed:"customer",typeName:"费用支出单",orgId:this.organizationId}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},arrearsFn:function(){this.amount=0;for(var t=0;t<this.billList.length;t++)this.amount+=parseFloat(this.billList[t].debitAmount)},addbillList:function(){this.checkStatus&&this.billList.push({id:null,pid:this.item.id,asId:this.getKMListByAvTypeItem.id,allId:this.getKMListByAvTypeItem.allId,tagId:"",labelName:"",kmName:this.getKMListByAvTypeItem.name,debitAmount:0,zbid:0,remarks:""})},editbillList:function(t,e){this.checkStatus&&(uni.hideKeyboard(),"km"===e?(this.billListUpIndex=t,this.setparams({searchtype:"getKmByFYZCD",filed:"billListItem",orgId:this.organizationId})):"label"===e&&(this.employeeLabelUpIndex=t,this.setparams({searchtype:"employeeLabel",filed:"employeeLabel",orgId:this.organizationId})),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},setItem:function(t,e,i,a){var n=this.billList[e];if("remarks"===a)n[a]=t.detail.value,this.$set(this.billList,e,n);else{var s=parseFloat(t.detail.value);n[a]!==s&&(n[a]=t.detail.value?s:0,this.$set(this.billList,e,n),this.arrearsFn())}},delectItem:function(t,e,i){this.checkStatus&&(this.billList.splice(i,1),this.arrearsFn())},creatNewDocm:function(){if(this.createDate)if(this.handleNameId)if(this.organizationId)if(this.customerId){this.arrearsFn();for(var e=[],i=0;i<this.billList.length;i++){var a=this.billList[i],n={pid:this.item.id,asId:a.asId,allId:a.allId,tagId:a.tagId,kmName:a.kmName,amount:a.debitAmount,zbid:0,remarks:a.remarks};a.id&&(n.id=a.id),e.push(n)}var s={id:this.item.id,date:this.createDate,avList:e,jsId:this.handleNameId,fsId:this.fsId,orgId:this.organizationId,kmId:this.customerId,typeId:11};this.abstract&&(s.abstractStr=this.abstract),d.default.savePreOrCollectBill(s).then((function(e){e.meta.success?(t.log(e.data),uni.showToast({title:"保存成功",icon:"none",duration:1e3}),uni.redirectTo({url:"../billSuccess/billSuccess?saleNo=".concat(e.data.av.oddCode,"&id=").concat(e.data.av.id,"&absTract=").concat(e.data.av.absTract)})):uni.showToast({title:e.meta.message,icon:"none",duration:1e3})}))}else uni.showToast({title:"请选择账户",icon:"none",duration:1e3});else uni.showToast({title:"请选择机构",icon:"none",duration:1e3});else uni.showToast({title:"请选择经手人",icon:"none",duration:1e3});else uni.showToast({title:"请选择单据日期",icon:"none",duration:1e3})}})),n);e.default=c}).call(this,i("ba7c")["default"])},f9881:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"contain"},[i("v-uni-view",{staticClass:"middle"},[i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("单据日期：")]),i("v-uni-view",{staticClass:"middle-select"},[i("v-uni-picker",{attrs:{mode:"date",disabled:!t.checkStatus,value:t.createDateF},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindDateChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.createDateF))])],1),i("v-uni-image",{attrs:{src:"/static/img/outNote/data.png",mode:""}})],1)],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("经手人：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择经手人",disabled:!0},model:{value:t.handleName,callback:function(e){t.handleName=e},expression:"handleName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("收付方式：")]),t.dictionnaryList.length>0?i("v-uni-view",{staticClass:"middle-select"},[i("v-uni-picker",{attrs:{value:t.dictionnaryIndex,disabled:!t.checkStatus,range:t.dictionnaryList,"range-key":"name"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.dictionnaryChange.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"pickval"},[t._v(t._s(t.dictionnaryIndex>=0?t.dictionnaryList[t.dictionnaryIndex].name:""))])],1),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1):t._e()],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("机构：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.organizationList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择机构",disabled:!0},model:{value:t.organizationName,callback:function(e){t.organizationName=e},expression:"organizationName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("账户：")]),i("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.customerList.apply(void 0,arguments)}}},[i("v-uni-input",{attrs:{type:"text",placeholder:"点击选择客户",disabled:!0},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}}),i("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1)],1),i("v-uni-view",{staticClass:"item"},[i("v-uni-view",{staticClass:"middle-des"},[t._v("摘要：")]),i("v-uni-view",{staticClass:"middle-select"},[i("v-uni-input",{attrs:{type:"text",placeholder:"",disabled:!t.checkStatus},model:{value:t.abstract,callback:function(e){t.abstract=e},expression:"abstract"}})],1)],1)],1),i("v-uni-view",{staticClass:"sweepCode"},[i("v-uni-view"),i("v-uni-image",{attrs:{src:"/static/img/outNote/add.png",mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addbillList.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"shopList"},t._l(t.billList,(function(e,a){return i("v-uni-view",{key:a,staticClass:"order-item",attrs:{id:"shop_"+e.id}},[i("v-uni-view",{staticClass:"order-item-row",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editbillList(a,"km")}}},[i("v-uni-text",{staticClass:"order-item-row-left"},[t._v("会计科目：")]),i("v-uni-input",{staticClass:"order-sec-left",attrs:{type:"text",placeholder:"点击选择收款账户",value:e.kmName,disabled:!0}})],1),i("v-uni-view",{staticClass:"order-item-row"},[i("v-uni-text",{staticClass:"order-item-row-left"},[t._v("金额：")]),i("v-uni-input",{staticClass:"order-item-row-input",attrs:{type:"digit",value:e.debitAmount,disabled:!t.checkStatus},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,a,"billList","debitAmount")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,a,"billList","debitAmount")}}})],1),i("v-uni-view",{staticClass:"order-item-row"},[i("v-uni-text",{staticClass:"order-item-row-left"},[t._v("备注：")]),i("v-uni-input",{staticClass:"order-item-row-input",attrs:{type:"text",value:e.remarks,disabled:!t.checkStatus},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,a,"billList","remarks")},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.setItem(e,a,"billList","remarks")}}})],1),i("v-uni-view",{staticClass:"order-item-row",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.editbillList(a,"label")}}},[i("v-uni-text",{staticClass:"order-item-row-left"},[t._v("部门：")]),i("v-uni-input",{staticClass:"order-item-row-input",attrs:{type:"text",placeholder:"点击选择部门",value:e.labelName,disabled:!0}})],1),i("v-uni-text",{staticClass:"delete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delectItem(e,"billList",a)}}},[t._v("删除")])],1)})),1),t._l(2,(function(e){return i("v-uni-view",{key:"footfixed"+e,class:["footfixed",2===e?"hide":""]},[i("v-uni-view",{staticClass:"foot-bg"},[i("v-uni-view",{staticClass:"foot-bg-left"},[i("v-uni-image",{attrs:{src:"/static/img/PriceHistory.png",mode:""}}),i("v-uni-view",[t._v("金额："),i("v-uni-text",[t._v(t._s(t.amount))])],1)],1),t.checkStatus?i("v-uni-view",{staticClass:"foot-bg-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.creatNewDocm.apply(void 0,arguments)}}},[t._v("保存")]):t._e()],1)],1)}))],2)},n=[]}}]);