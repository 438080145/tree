(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-pickRegister-pickRegister"],{"03df":function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".screen[data-v-4438a814]{display:flex}.screen uni-image[data-v-4438a814]{width:%?48?%;height:%?48?%}.pickRegister-layout[data-v-4438a814]{overflow-y:hidden;background-color:#f5f5f5;padding-top:%?20?%}.pickRegister-layout .card-content > uni-view[data-v-4438a814]{margin-bottom:%?20?%}.pickRegister-layout .card-content > uni-view[data-v-4438a814]:last-child{margin-bottom:0}.justify-C[data-v-4438a814]{display:flex;justify-content:space-between;align-items:center}.justify-C .status-tip[data-v-4438a814]{color:#fff;border-radius:%?8?%;padding:%?8?% %?20?%;font-size:12px}.justify-C .tip-status0[data-v-4438a814]{background-color:#909399}.justify-C .tip-status1[data-v-4438a814]{background-color:#ffb822}.justify-C .tip-status2[data-v-4438a814]{background-color:#67c23a}.pickRegister-complete[data-v-4438a814]{position:absolute;bottom:0;width:100%;height:40px;line-height:40px;text-align:center;background-color:#ffb822;color:#fff;font-weight:700;transition:background-color .35s}.pickRegister-complete[data-v-4438a814]:active{background-color:#f4af1b}.nodata[data-v-4438a814]{text-align:center}.nodata uni-image[data-v-4438a814]{width:100%;height:100%}",""]),t.exports=e},"361b":function(t,e,i){"use strict";i.r(e);var n=i("86c1"),a=i("7a32");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(s);i("674c");var o=i("828b"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"4438a814",null,!1,n["a"],void 0);e["default"]=c.exports},"604a":function(t,e,i){"use strict";(function(t){i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c"),i("c223"),i("c9b5"),i("bf0f"),i("ab80"),i("5c47"),i("473f"),i("71cb"),i("f18a"),i("bd06");var a=n(i("9b1b")),s=n(i("f92a")),o=n(i("2901")),c=n(i("5ed7")),u=n(i("8367")),r=n(i("2a4e")),l=i("8f59"),d={components:{customHeader:s.default,toolsSearch:o.default,cardItem:c.default},computed:(0,a.default)({},(0,l.mapState)({customParams:function(t){return t.custom.customParams}})),data:function(){return{screenData:(0,u.default)([{controlkey:"dateStart",changControlConfigParams:{filedName:"startDate"}},{controlkey:"dateEnd",changControlConfigParams:{filedName:"endDate"}},{controlkey:"customer",changControlConfigParams:{filedName:"customerIds",limit:5}},{controlkey:"organizationInfo",changControlConfigParams:{filedName:"storehouseId"}},{controlkey:"pickStatus",changControlConfigParams:{filedName:"status"}},{controlkey:"commonInput",changControlConfigParams:{filedName:"saleNo"}}]),cardOptions:[{title:"删除",color:"#fff",bgColor:"#ee0a24",handleEvent:"deleteOrder"}],swiperHeight:560,usedRef:null,pickList:[],checkdPickIds:[],pageSize:20,pageNum:1,total:0}},created:function(){this.setCustomScreenList(this.screenData),this.init()},mounted:function(){this.autoSwiperHeight()},onPullDownRefresh:function(){this.init(1),uni.stopPullDownRefresh()},methods:(0,a.default)((0,a.default)({},(0,l.mapActions)(["setCustomScreenList"])),{},{init:function(e){var i=this;e&&(this.pageNum=1);var n=(0,a.default)({type:1,pageSize:this.pageSize,pageNum:this.pageNum},this.customParams);r.default.getWmsPickDeliveryList(n).then((function(n){if(t.log(n),n.meta.success){var a=n.data.page;a.list.map((function(t){t.checked=!1})),i.total=a.total,i.pickList=e?a.list:i.pickList.concat(a.list)}}))},deleteOrder:function(e){var i=this;uni.showModal({title:"确认删除？",content:"单号：".concat(e.saleNo),success:function(n){n.confirm?r.default.delReceiptPicking({id:e.id}).then((function(t){t.meta.success?(i.init(1),uni.showToast({icon:"none",title:"删除成功",duration:2e3})):uni.showToast({icon:"none",title:t.meta.message,duration:2e3})})):n.cancel&&t.log("取消删除")}})},completeRegistration:function(){var t=this;this.checkdPickIds.length?r.default.setMultipleReceiptPicking({ids:this.checkdPickIds.toString(),type:1,status:1}).then((function(e){e.meta.success?(uni.showToast({icon:"none",title:e.data.msg,duration:2e3}),t.clearCheckbox(),t.checkdPickIds=[],t.init(1)):uni.showToast({icon:"none",title:e.meta.message,duration:2e3})})):uni.showToast({icon:"none",title:"至少选择一张单据",duration:2e3})},autoSwiperHeight:function(){var t=this;this.$nextTick((function(){uni.createSelectorQuery().select("#pickRegister").boundingClientRect((function(e){e&&(t.swiperHeight=t.$store.state.sysinfo.windowHeight-e.top-50)})).exec()}))},checkedChange:function(t){var e=[t.detail.value,this.checkdPickIds].flat().reduce((function(t,e){return t^e})),i=this.pickList.findIndex((function(t){return t.id==e}));this.checkdPickIds.length<t.detail.value.length?this.$set(this.pickList[i],"checked",!0):this.$set(this.pickList[i],"checked",!1),this.checkdPickIds=t.detail.value},enterHandle:function(t){var e=this;r.default.setReceiptPicking({type:1,saleNo:t}).then((function(t){t.meta.success?(uni.showToast({icon:"success",title:"已添加一张单据",duration:2e3}),e.init(1)):uni.showToast({icon:"none",title:t.meta.message,duration:2e3})}))},scanning:function(t){this.enterHandle(t)},listenHandle:function(t){"unfold"===t.status&&(this.usedRef&&(this.usedRef.moveX=0,this.usedRef.moveDirection=1),this.usedRef=t.data.ref)},toList:function(){var t=this;uni.navigateTo({url:"/pages/customReport/screenPage",events:{refreshList:function(){t.init(1)}}})},scrollLoadData:function(){this.total<=this.pageNum*this.pageSize||(this.pageNum++,this.init())},statusText:function(t){switch(t){case 0:return"未完成";case 1:return"已完成"}},clearCheckbox:function(){var t=this;this.checkdPickIds.map((function(e){var i=t.pickList.findIndex((function(t){return t.id==e}));t.$set(t.pickList[i],"checked",!1)}))}})};e.default=d}).call(this,i("ba7c")["default"])},"674c":function(t,e,i){"use strict";var n=i("ac84"),a=i.n(n);a.a},"7a32":function(t,e,i){"use strict";i.r(e);var n=i("604a"),a=i.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=a.a},"86c1":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"contain"},[i("customHeader",{attrs:{title:"拣货登记",isSticky:!0}},[i("v-uni-view",{staticClass:"screen",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.toList.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:"/static/img/outNote/shop-shaixuan.png"}})],1)],1),i("toolsSearch",{attrs:{isSticky:!0},on:{enter:function(e){arguments[0]=e=t.$handleEvent(e),t.enterHandle.apply(void 0,arguments)},scanning:function(e){arguments[0]=e=t.$handleEvent(e),t.scanning.apply(void 0,arguments)}}}),i("v-uni-view",{attrs:{id:"pickRegister"}},[t.pickList.length>0?i("v-uni-view",{staticClass:"pickRegister-layout",style:"height: "+t.swiperHeight+"px"},[i("v-uni-scroll-view",{style:"height:"+(t.swiperHeight-10)+"px",attrs:{"scroll-y":"true"},on:{scrolltolower:function(e){arguments[0]=e=t.$handleEvent(e),t.scrollLoadData.apply(void 0,arguments)}}},[i("v-uni-checkbox-group",{on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.checkedChange.apply(void 0,arguments)}}},t._l(t.pickList,(function(e,n){return i("cardItem",{key:n,ref:"card-"+n,refInFor:!0,attrs:{options:t.cardOptions,item:e,isCheckbox:!0},on:{deleteHandle:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteOrder.apply(void 0,arguments)},listenHandle:function(e){arguments[0]=e=t.$handleEvent(e),t.listenHandle.apply(void 0,arguments)}},scopedSlots:t._u([{key:"content",fn:function(){return[i("v-uni-view",{staticClass:"justify-C"},[i("v-uni-view",[t._v(t._s(e.saleNo))]),i("v-uni-view",{staticClass:"status-tip",class:0==e.status?"tip-status0":1==e.status?"tip-status1":"tip-status2"},[t._v(" "+t._s(t.statusText(e.status))+" ")])],1),i("v-uni-view",[t._v("客户："+t._s(e.customerName))]),i("v-uni-view",[t._v("制单员："+t._s(e.creatorName))]),i("v-uni-view",[t._v("开单时间："+t._s(t.timeShift.timeTransfer(e.fillDate)))]),1===e.status?i("v-uni-view",[t._v("完成时间："+t._s(t.timeShift.timeTransfer(e.finishTime)))]):t._e(),i("v-uni-view",{staticClass:"justify-C"},[i("v-uni-view",[t._v("金额："+t._s(e.totalAmount))]),i("v-uni-view",[t._v("数量："+t._s(e.totalQuantity))])],1)]},proxy:!0}],null,!0)})})),1)],1)],1):[i("v-uni-view",{staticClass:"nodata"},[i("v-uni-image",{attrs:{src:"/static/img/nodata.png"}}),i("v-uni-view",[t._v("暂无数据")])],1)]],2),i("v-uni-view",{staticClass:"pickRegister-complete",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.completeRegistration.apply(void 0,arguments)}}},[i("span",[t._v("完成登记")])])],1)},a=[]},ac84:function(t,e,i){var n=i("03df");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("967d").default;a("79194b82",n,!0,{sourceMap:!1,shadowMode:!1})}}]);