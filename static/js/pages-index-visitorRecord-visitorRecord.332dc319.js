(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-visitorRecord-visitorRecord"],{"0a06":function(t,i,e){"use strict";var n=e("d4d7"),a={fxVisitCustomerPage:function(t){return(0,n.get)("fx/fxVisitCustomer/page",t,3)},fxVisitMainSave:function(t){return(0,n.post)("fx/fxVisitMain/save",t,3)},fxVisitCustomerCollectCoordinate:function(t){return(0,n.post)("fx/fxVisitCustomer/collectCoordinate",t,3)},fxVisitFilesImgCollection:function(t){return(0,n.post)("fx/fxVisitFiles/imgCollection",t,3)},fxVisitFilesExceptionReport:function(t){return(0,n.post)("fx/fxVisitFiles/exceptionReport",t,3)},getFxVisitMain:function(t,i){return(0,n.get)("fx/fxVisitMain/"+t,i,3)},fxVisitMainVisitingRecord:function(t){return(0,n.get)("fx/fxVisitMain/visitingRecord",t,3)},fxVisitMainVisitingDetails:function(t){return(0,n.get)("fx/fxVisitMain/visitingDetails",t,3)},fxVisitCustomerCustomerList:function(t){return(0,n.get)("fx/fxVisitCustomer/customerList",t,3)},fxVisitFilesDelete:function(t){return(0,n.post)("fx/fxVisitFiles/delete?ids="+t,null,3)},fxVisitCustomerImport:function(){return(0,n.post)("fx/fxVisitCustomer/customerImport",null,3)},fxVisitCustomerTargetDeleteSaveOrUpdate:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/saveOrUpdate",t,3)},fxVisitCustomerTargetDelete:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/delete?id="+t.id,null,3)},findOrderTargetByDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDate",t,3)},fxVisitCustomerTargetList:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/list",t,3)},fxVisitCustomerTargetBatchAddTarget:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/batchAddTarget",t,3)},findOrderTargetByDifDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDifDate",t,3)},updateSort:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/updateSort",t,3)},dictionnary:function(t){return(0,n.get)("api/basedata/dictionnary/page",t,1)},category:function(t){return(0,n.get)("fx/fxVisitMain/category",t,3)},fxVisitOption:function(t){return(0,n.post)("fx/fxVisitOption",t,3)},checkCustomer:function(t){return(0,n.get)("dat/datCustomer/checkCustomer",t,9)},collectMainPage:function(t){return(0,n.get)("collect/collectMain/page",t,9)},collectMainSave:function(t){return(0,n.post)("collect/collectMain/save",t,9)},collectMainDelete:function(t){return(0,n.get)("collect/collectMain/delete",t,9)},getCollectMainById:function(t){return(0,n.get)("collect/collectMain/findInfo",t,9)},collectDetailDelete:function(t){return(0,n.get)("collect/collectDetail/delete",t,9)},fxVisitCustomerDelete:function(t){return(0,n.get)("fx/fxVisitCustomer/delete",t,3)},customerNameUnite:function(t){return(0,n.get)("fx/fxVisitMain/customerNameUnite",t,3)}};t.exports=a},"18a0":function(t,i,e){"use strict";var n=e("8021"),a=e.n(n);a.a},"2afe":function(t,i,e){"use strict";e.r(i);var n=e("847e"),a=e("77d3");for(var s in a)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(s);e("18a0");var o=e("828b"),c=Object(o["a"])(a["default"],n["b"],n["c"],!1,null,"261aa98c",null,!1,n["a"],void 0);i["default"]=c.exports},"37b9":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAJ1BMVEX///8zMzP6+vpwcHCSkpJ9fX2IiIhISEjY2Njt7e2/v787OztbW1vTET4fAAAAk0lEQVQ4y82TuQ2EQBAEVwgkDq/FY584FwciIATIAEIgCgwCwMEhBEK4zEigy98xt1Wz8/SEEHsUCwh3BcCj0b0nh7yQP/KpdgI2NRY4JVvth4BLmizwV22BDoCkV/11wk8abKZZpQUyAlYAUgJQwFT8OZbLDeJIcIihpbHjoni1aAa2DxqOLRrI1HgGfDh8avHEC/ZBGXwrpcb3AAAAAElFTkSuQmCC"},"398f":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAATwAAAE8BY4r91wAAA8dJREFUeJztmVtIFUEcxmdmZ3Z2TzcklNLMOIQn0wqMsqsVPvRYEN2osCDE1wh6iwiLXqQbEQW+9BAVgZEYEWQEQfTgS4Rh0o2sqCgrIdFjne0/szvnbGaXnd2zEvnBn9k9sDu/+c43l8Mh6B8TGWuAoBoHzrfGgfOtUMBlhd07oTpDVH2swKBVUAs1q8RxnFtxA5eHeLYtnc68DPpQKGBioEqMtR79mnGck2/6K53AfWp1B0qV9lRSiqcYFCPDwIjAmwLAn+t9X9Gl0682sEHRfABGDIoyce+Ci8K/f+tAJuPs0+1XG5iZeBljAhaKesUEMELU+K3rF3o/VPTFDmyaeCVAS3cFuAuPcgMQ137XXfDPsDIc0+1TG3hpdc9EACwXcC60z2nmg5WFpOviGhy/ijKoJ3Zgy6arTQvbnGPETYJEC45nSwxCua5iA+0rGMj+F30Vw7EDc07KTQBlfjhzhNu+Ym622x2MAq+70QBbeC6UABfXyBQlXYZ70239jlMTf6PUaX7cOyczJsAAUS5huHKW5KLgj4XnOKPoBjz2JCysFnD99t5CO0HKLJtAljEa2UrnVXFZfQDecL8nFXhXiwQYYjADnC2SE82r7KST9yoOkHH380cwwEV1K56uX7Ps6framiczYwWGzlPgpsWFqxa4Kt2E7Ip7L9PczjlsWmQpTLorlJFWWNoaiYGHYgUmhnPDoE4VzPoqAOrIQnN38mUnI/cGor4BjjsBfNPtu8m3sQIfO1788cTJ4q5Tp4u7rAQpzOWXIFu0agC224rPweVuZqLN1ztm9YeB1QJWamp6Q8DN2TKznptuK2PguSrz/JZStKO1rexZWNhQwIzReeBowk74V4qfVo13Jkcbz18q7YwCNhQwuDlbTTgJ6H39snVjMQB14GxLyZ2oYEMBw2qx2s0tltlVBbkWA0jDkra1+ei0M1HCCmkDA+w8rpa0HzeLYWiPHzpU1BYlqJIW8MXL/TZAVQuHuYWzqwJcZ6COwHZ8MGpQJb2zhCXySyZxL6/cyma3DRw+vHfP1IGoQZW0gG3bWMz9O5wtN4t2QjNbG3YXpKOG9EvPYY6SagdzzxHkHmXOlvptBYNRA46U7gG+Qm0Y0D43TbRrw7rJX6KGG02BgTsfDFIATXqntIcAu3xt3YTufMCNpsDAcFgvgu1W1CeD4cbaJfbrfID9SsGBGSmBA7kNR8WNNQt4pLvY30gDGJXCT/h9C1LsZj6A/qTAwHAWvoZIuiUfMH+jwMDJ6WwoVZqI5PeZjv6vvwzGQuPA+dZ3nfy+WSrvec4AAAAASUVORK5CYII="},"55de":function(t,i,e){var n=e("c86c");i=n(!1),i.push([t.i,".head[data-v-261aa98c]{z-index:9999999}.header-right[data-v-261aa98c]{justify-content:flex-end}.head[data-v-261aa98c]{display:flex;justify-content:space-between;font-weight:590}.head .header-left[data-v-261aa98c]{width:20%}.head .header-middle[data-v-261aa98c]{width:20%}.head .header-right[data-v-261aa98c]{display:flex;width:20%;justify-content:flex-end}.head uni-image[data-v-261aa98c]{width:%?48?%;height:%?48?%;margin:%?7?% %?15?%;display:block}.com-icon[data-v-261aa98c]{top:%?165?%}.customer_content[data-v-261aa98c]{border-bottom:%?10?% solid #f6f6f6;display:flex;height:%?136?%;justify-content:space-between;font-size:%?28?%;padding:%?30?% %?20?%}.customer_content[data-v-261aa98c]:first-child{border-top:%?10?% solid #f6f6f6}.content_left[data-v-261aa98c]{display:flex;flex-direction:column;justify-content:space-between;width:100%;flex:1}.companyName[data-v-261aa98c]{font-size:%?30?%}.statisticsTime[data-v-261aa98c], .lastTime[data-v-261aa98c]{font-size:%?28?%;color:#a9a9a9}.startVisit[data-v-261aa98c]{padding:%?14?%;line-height:1;color:#fff}.startVisit.disabled[data-v-261aa98c]{opacity:.5}.content_right[data-v-261aa98c]{align-items:flex-end;display:flex;flex-direction:column;justify-content:space-between;position:relative}.content_right uni-text[data-v-261aa98c]:last-child{background:#ffc235;font-size:%?32?%}.content_right .state[data-v-261aa98c]{display:flex;flex-wrap:wrap;justify-content:space-between}.content_right .state .wz[data-v-261aa98c]{font-size:%?28?%;line-height:%?40?%}.content_right .state .com-icon[data-v-261aa98c]{position:relative;width:20px;height:20px;top:inherit;left:inherit;margin-left:10px}",""]),t.exports=i},"77d3":function(t,i,e){"use strict";e.r(i);var n=e("d697"),a=e.n(n);for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(s);i["default"]=a.a},8021:function(t,i,e){var n=e("55de");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=e("967d").default;a("5ebba799",n,!0,{sourceMap:!1,shadowMode:!1})},"847e":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return a})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("v-uni-view",{staticClass:"contain"},[n("tx-map-position",{ref:"position"}),n("v-uni-view",{staticClass:"head"},[n("v-uni-view",{staticClass:"header-left"},[n("v-uni-image",{attrs:{src:e("37b9"),mode:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goBack.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"header-middle"},[n("v-uni-text",[t._v("访销管理")])],1),n("v-uni-view",{staticClass:"header-right"})],1),n("v-uni-view",{staticStyle:{height:"130upx"}}),n("v-uni-view",{staticClass:"com-input"},[n("v-uni-image",{staticClass:"com-icon",attrs:{src:e("f695")}}),n("v-uni-input",{attrs:{placeholder:"编号、名称、联系信息、备注"},on:{confirm:function(i){arguments[0]=i=t.$handleEvent(i),t.getCustomer.apply(void 0,arguments)}},model:{value:t.keyword,callback:function(i){t.keyword=i},expression:"keyword"}})],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.customerList.length,expression:"customerList.length"}],staticClass:"sel_customerList"},t._l(t.customerList,(function(i,a){return n("v-uni-view",{key:a,staticClass:"customer_content"},[n("v-uni-view",{staticClass:"content_left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.processingBusiness(i)}}},[n("v-uni-text",{staticClass:"companyName"},[t._v(t._s(t.substring(i.customerName,18)))]),t.sky(i.sky)?n("v-uni-text",{staticClass:"statisticsTime"},[t._v(t._s(i.sky?i.sky+" 天未拜访":"今天已拜访"))]):n("v-uni-text",{staticClass:"statisticsTime"},[t._v("未拜访")]),i.visitDate?n("v-uni-text",{staticClass:"lastTime"},[t._v("最近拜访时间："+t._s(t.formatDate(i.visitDate)))]):n("v-uni-text",{staticClass:"lastTime"},[t._v("最近拜访时间：")])],1),n("v-uni-view",{staticClass:"content_right"},[0!==i.visitStatus&&1!==i.visitStatus?n("v-uni-view",{staticClass:"state"},[n("v-uni-text",{staticClass:"wz",staticStyle:{color:"red"}},[t._v("未拜访")]),n("v-uni-view",{},[n("v-uni-image",{staticClass:"com-icon",attrs:{src:e("398f")}})],1)],1):n("v-uni-view",{staticClass:"state"},[n("v-uni-text",{staticClass:"wz",staticStyle:{color:"green"}},[t._v("拜访中")]),n("v-uni-view",{},[n("v-uni-image",{staticClass:"com-icon",attrs:{src:e("bdcf")}})],1)],1),void 0===i.visitStatus?n("v-uni-text",{staticClass:"startVisit",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startVisiting(i)}}},[t._v("开始拜访")]):t._e(),0===i.visitStatus?n("v-uni-text",{staticClass:"startVisit",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startVisiting(i)}}},[t._v("请签到")]):t._e(),1===i.visitStatus?n("v-uni-text",{staticClass:"startVisit disabled",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.startVisiting(i)}}},[t._v("已签到")]):t._e()],1)],1)})),1)],1)},a=[]},bdcf:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAxlBMVEUAAAD/vyv/xDf/v0D/szP/xDP/v0D/xjn/wzX/wjX/0S7/wjX/wjX/wzX/wjX/zj3/wTT/wTT/xTX/wjX/wzX/wjX/wj3/xDT/xDP//wD/wTb/wzn/wzX/wjb/wjb/wzX/wjf/wjT/wzz/xTb/wzb//wD/xjn/xDH/xjP/xjT/wjb/zET/wjX/wjX/wzf/wjb/wjb/wjX/xDf/wzf/wjb/wzb/wzb/wjX/wjb/wTX/wzb/wjb/wDT/wzb/wjb/wTX/wjX///94y+ecAAAAQHRSTlMADEEICh4MCf7+C873+dIVSk5q++j8FSc8ASFRg4pklE9YEW3HAigaLTb8D/b6M+Pd7DiH1VWYvPdWhNtFf+lb7/jbyQAAAAFiS0dEQYnebE4AAAAHdElNRQfkCAQAMSVzSvxXAAAA3klEQVQ4y93R1w6CQBAF0LEgNuwNe++9d+//f5VKYggwLhJ9UO/LwuSwOzsQfW+A38YuNws83HdeQOIwfNaqDL4lP1cGAuJOg6EwlEhUe46JrxrHIwnbQYShJ2k7NEOENmXCaYHNwJzsy02IG3kX54jU/C1Gc1sLDC4SlQwnPHCZwRWiKtuOxOCak57rn5lGw2Kbgl/oYGOilsm2RZg6Btslm5gm0XvC+lDvy2CoydH4/jLBlLUzYG4pLoAluy9WTHkNbKzVLXbsgXvI4ksecLSbgx4Fp2/AZ1xex/+UK5z+Y00Po+3oAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTA4LTAzVDE2OjQ5OjM3KzA4OjAw00+45AAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wOC0wM1QxNjo0OTozNyswODowMKISAFgAAAAASUVORK5CYII="},d697:function(t,i,e){"use strict";(function(t){e("6a54");var n=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("aa9c"),e("c223"),e("d4b5");var a=n(e("b7c7")),s=n(e("9b1b")),o=n(e("0a06")),c=e("8f59"),r={data:function(){return{customerList:[],page:{pageNum:1,pageSize:10},keyword:"",hasNextPage:!1,visitSignIn:{signInId:null}}},watch:{},onLoad:function(t){this.initDate()},onShow:function(){this.page.pageNum=1,this.initDate()},onReachBottom:function(){this.hasNextPage&&(this.page.pageNum++,this.addDate())},onBackPress:function(){},computed:(0,s.default)((0,s.default)({},(0,c.mapState)(["params"])),{},{formatDate:function(){var t=this;return function(i){return t.timeShift.formatDate(i)}},substring:function(){return function(t,i){return t?t.length>i?t.substring(0,i)+"...":t:""}},sky:function(){return function(t){return void 0!==t}}}),methods:(0,s.default)((0,s.default)({},(0,c.mapMutations)(["setparams"])),{},{addDate:function(){var t=this,i=(0,s.default)((0,s.default)({},t.page),{},{keyword:t.keyword});o.default.fxVisitCustomerPage(i).then((function(i){var e;i.meta.success?((e=t.customerList).push.apply(e,(0,a.default)(i.data.list)),t.hasNextPage=i.data.hasNextPage):uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},initDate:function(){var t=this,i=(0,s.default)((0,s.default)({},t.page),{},{keyword:t.keyword});o.default.fxVisitCustomerPage(i).then((function(i){if(i.meta.success)if(t.customerList=i.data.list,t.hasNextPage=i.data.hasNextPage,t.customerList.length>0&&void 0!==t.customerList[0].visitStatus){var e=t.customerList[0],n={signInId:e.mainId,id:e.id,khId:e.khId,customerName:e.customerName,longitude:e.longitude,latitude:e.latitude};if(void 0!==e.visitStatus){var a={visitId:e.id,name:e.customerName,mobilePhone:e.phone,address:e.address,remark:e.summary};void 0!==e.khId&&(a.khId=e.khId),n.customerFiles=a}uni.setStorageSync("visitSignIn",n)}else uni.setStorageSync("visitSignIn",null),t.visitSignIn={signInId:null};else uni.setStorageSync("visitSignIn",null),uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},goBack:function(){uni.navigateBack({delta:1})},txPosition:function(i){var e=this;this.$refs.position.startPositioning((function(n){var a=n.province+n.city+n.addr,s={id:0,customerId:i.id,startCoordinate:"".concat(n.lng,",").concat(n.lat),startAddress:"".concat(a),salesmanId:uni.getStorageSync("userId"),visitType:0};t.log("开始拜访 ：params",s),o.default.fxVisitMainSave(s).then((function(t){t.meta.success?t.data.obj?(e.visitSignIn.fxVisitMainId=t.data.obj.id,uni.setStorageSync("visitSignIn",e.visitSignIn),uni.navigateTo({url:"./coordinatePositioning/coordinatePositioning"+"?longitude=".concat(i.longitude,"&latitude=").concat(i.latitude,"&fxVisitMainId=").concat(t.data.obj.id,"&customerName=").concat(i.customerName)})):(uni.showToast({title:"错误",icon:"none",duration:1e3}),e.visitSignIn=null,uni.removeStorageSync("visitSignIn")):(uni.showToast({title:t.meta.message,icon:"none",duration:1e3}),e.visitSignIn=null,uni.removeStorageSync("visitSignIn"))})),uni.hideLoading()}))},startVisiting:function(i){var e={visitId:i.id,name:i.customerName,mobilePhone:i.phone,address:i.address,remark:i.summary};void 0!==i.khId&&(e.khId=i.khId),this.setparams({customerFiles:e});var n=this;if(1!==i.visitStatus){if(n.visitSignIn&&null!==n.visitSignIn.id&&void 0!==n.visitSignIn.id&&""!==n.visitSignIn.id){if(n.visitSignIn.id!==i.id)return void uni.showToast({title:"当前拜访尚未结束...",icon:"none",duration:1e3})}else n.visitSignIn={signInId:i.mainId,id:i.id,khId:i.khId,customerName:i.customerName,longitude:i.longitude,latitude:i.latitude},uni.setStorageSync("visitSignIn",n.visitSignIn);t.log("开始拜访",i),0===i.visitStatus||1===i.visitStatus?uni.navigateTo({url:"./coordinatePositioning/coordinatePositioning"+"?longitude=".concat(i.longitude,"&latitude=").concat(i.latitude,"&fxVisitMainId=").concat(i.mainId,"&customerName=").concat(i.customerName)}):uni.showModal({title:"温馨提示",content:"是否拜访当前客户？",success:function(t){if(t.confirm)return uni.showLoading({title:"获取地址中...",mask:!0}),void n.txPosition(i);t.cancel&&(uni.setStorageSync("visitSignIn",null),n.visitSignIn={signInId:null})}})}},processingBusiness:function(i){if(1===i.visitStatus){this.visitSignIn?(this.$forceUpdate(),this.$set(this.visitSignIn,"signInId",i.mainId),this.$set(this.visitSignIn,"id",i.id),this.$set(this.visitSignIn,"khId",i.khId),this.$set(this.visitSignIn,"customerName",i.customerName),this.$set(this.visitSignIn,"fxVisitMainId",i.mainId),this.$set(this.visitSignIn,"longitude",i.longitude),this.$set(this.visitSignIn,"latitude",i.latitude)):this.visitSignIn={signInId:i.mainId,id:i.id,khId:i.khId,customerName:i.customerName,longitude:i.longitude,latitude:i.latitude},t.log("处理模块");var e={visitId:i.id,name:i.customerName,mobilePhone:i.phone,address:i.address,remark:i.summary};void 0!==i.khId&&(e.khId=i.khId),this.$set(this.visitSignIn,"customerFiles",e),uni.setStorageSync("visitSignIn",this.visitSignIn),uni.navigateTo({url:"./businessProcessing/businessProcessing?id="+i.id})}},getCustomer:function(){this.initDate()}})};i.default=r}).call(this,e("ba7c")["default"])},f695:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAANlBMVEVHcEzo6Ovr6+zn5+vp6evn5+vo6Ovo6Oro6Ovr6+z////n5+ro6Ovn5+qqqv/o6Orf3//n5+o5OQ7mAAAAEXRSTlMA2SPMVPvAPaQVBXpp7APECOXfK04AAAEPSURBVDjLzZXbFoQgCEUzvKB2/f+fndSmZQalPcwa3shdnoNIXfer6AeEUakRcOjvyUnOaxaznHjWiLUIYRjU4UoELhRrIa1qb6xz1ngdUwWWYJMEzFz1aStxoRfYJeaWpmQCSiXxI/ryDRu0KCzqEFlHuI7KTzWZBKnt8CJycfLyerGpzB6Ec0PuqIKdOatReJnthGJ1CO74Lggeh9NGnof9SSTw9r4W4cjGLbM8bLfl8cjUljkeduEU38FNMpoMNpWu6VCajvu5kfTbFn1s/tNNub9WytRf2EtZHVDTap9nsn7IbDJk5fhi6IUajMpLRdLMyOXoYpjrRHA0/ZvgaSoirbsGGqt/YlKj7f4lPukhHDuaScDKAAAAAElFTkSuQmCC"}}]);