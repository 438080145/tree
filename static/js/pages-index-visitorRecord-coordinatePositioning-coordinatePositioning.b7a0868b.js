(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-visitorRecord-coordinatePositioning-coordinatePositioning"],{"0a06":function(t,e,i){"use strict";var n=i("d4d7"),a={fxVisitCustomerPage:function(t){return(0,n.get)("fx/fxVisitCustomer/page",t,3)},fxVisitMainSave:function(t){return(0,n.post)("fx/fxVisitMain/save",t,3)},fxVisitCustomerCollectCoordinate:function(t){return(0,n.post)("fx/fxVisitCustomer/collectCoordinate",t,3)},fxVisitFilesImgCollection:function(t){return(0,n.post)("fx/fxVisitFiles/imgCollection",t,3)},fxVisitFilesExceptionReport:function(t){return(0,n.post)("fx/fxVisitFiles/exceptionReport",t,3)},getFxVisitMain:function(t,e){return(0,n.get)("fx/fxVisitMain/"+t,e,3)},fxVisitMainVisitingRecord:function(t){return(0,n.get)("fx/fxVisitMain/visitingRecord",t,3)},fxVisitMainVisitingDetails:function(t){return(0,n.get)("fx/fxVisitMain/visitingDetails",t,3)},fxVisitCustomerCustomerList:function(t){return(0,n.get)("fx/fxVisitCustomer/customerList",t,3)},fxVisitFilesDelete:function(t){return(0,n.post)("fx/fxVisitFiles/delete?ids="+t,null,3)},fxVisitCustomerImport:function(){return(0,n.post)("fx/fxVisitCustomer/customerImport",null,3)},fxVisitCustomerTargetDeleteSaveOrUpdate:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/saveOrUpdate",t,3)},fxVisitCustomerTargetDelete:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/delete?id="+t.id,null,3)},findOrderTargetByDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDate",t,3)},fxVisitCustomerTargetList:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/list",t,3)},fxVisitCustomerTargetBatchAddTarget:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/batchAddTarget",t,3)},findOrderTargetByDifDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDifDate",t,3)},updateSort:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/updateSort",t,3)},dictionnary:function(t){return(0,n.get)("api/basedata/dictionnary/page",t,1)},category:function(t){return(0,n.get)("fx/fxVisitMain/category",t,3)},fxVisitOption:function(t){return(0,n.post)("fx/fxVisitOption",t,3)},checkCustomer:function(t){return(0,n.get)("dat/datCustomer/checkCustomer",t,9)},collectMainPage:function(t){return(0,n.get)("collect/collectMain/page",t,9)},collectMainSave:function(t){return(0,n.post)("collect/collectMain/save",t,9)},collectMainDelete:function(t){return(0,n.get)("collect/collectMain/delete",t,9)},getCollectMainById:function(t){return(0,n.get)("collect/collectMain/findInfo",t,9)},collectDetailDelete:function(t){return(0,n.get)("collect/collectDetail/delete",t,9)},fxVisitCustomerDelete:function(t){return(0,n.get)("fx/fxVisitCustomer/delete",t,3)},customerNameUnite:function(t){return(0,n.get)("fx/fxVisitMain/customerNameUnite",t,3)}};t.exports=a},"0bdc":function(t,e,i){"use strict";i.r(e);var n=i("8ed1"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},1851:function(t,e,i){"use strict";var n=i("8bdb"),a=i("84d6"),o=i("1cb5");n({target:"Array",proto:!0},{fill:a}),o("fill")},"556d":function(t,e,i){var n=i("c86c");e=n(!1),e.push([t.i,".contain[data-v-28d0da9a]{flex:1;display:flex;flex-direction:column;height:100%;background-color:#f6f6f6}.foot-two-buttons[data-v-28d0da9a]{height:%?78?%;z-index:999999999}.map[data-v-28d0da9a]{flex:1}.foot-buttons[data-v-28d0da9a]{position:absolute;bottom:0;width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center}.foot-item[data-v-28d0da9a]{flex:1;display:flex;flex-direction:row;justify-content:center;align-items:center;height:%?80?%;background-color:#ffc235}.foot-left[data-v-28d0da9a]{background-color:#f13a3a}.foot-item-image[data-v-28d0da9a]{width:%?50?%;height:%?50?%}.foot-item-text[data-v-28d0da9a]{font-size:%?32?%;line-height:%?80?%;text-align:center;color:#fff}",""]),t.exports=e},"8dbc":function(t,e,i){"use strict";var n=i("cfe6"),a=i.n(n);a.a},"8ed1":function(t,e,i){"use strict";(function(t){i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("9b1b"));i("d4b5"),i("c223");n(i("98e0"));var o=n(i("0a06")),r=(n(i("82d0")),i("8f59")),s=(i("f55d"),{data:function(){return{windowWidth:0,id:0,title:"map",latitude:22.52746004363895,longitude:113.35856565096798,covers:[{latitude:22.52746004363895,longitude:113.35856565096798}],fxVisitMainId:"",visitSignIn:"",customerName:"",customerFiles:null,url:"",locationUrl:""}},watch:{},onLoad:function(e){this.customerFiles=this.params.customerFiles,this.fxVisitMainId=e.fxVisitMainId,this.customerName=e.customerName,this.latitude=e.latitude||"39.908519",this.longitude=e.longitude||"116.397527",t.log("坐标信息",this.longitude,this.latitude),this.positionUrl="/hybrid/html/map.html",this.mapMarkers=[{latitude:this.latitude,longitude:this.longitude,title:this.customerName,id:"customer-location"}],this.covers=[{id:"999999",iconPath:"../../../../static/img/location.png",latitude:this.latitude,longitude:this.longitude}],this.visitSignIn=uni.getStorageSync("visitSignIn")},onShow:function(){},onReachBottom:function(){},mounted:function(){var t=this;uni.getSystemInfo({success:function(e){t.windowWidth=e.windowWidth}});var e=this.$scope.$getAppWebview();setTimeout((function(){var i=e.children()[0];i&&(i.setStyle({bottom:40}),i.evalJS("init(".concat(JSON.stringify({markers:t.mapMarkers}),")")))}),1e3)},computed:(0,a.default)((0,a.default)({},(0,r.mapState)(["params"])),{},{formatDate:function(){var t=this;return function(e){return t.timeShift.formatDate(e)}}}),methods:(0,a.default)((0,a.default)({},(0,r.mapMutations)(["setparams"])),{},{startNavigation:function(){t.log(this.customerName,"========"),uni.openLocation({latitude:this.latitude,longitude:this.longitude,name:this.customerName,success:function(){t.log("success")}})},txPosition:function(){var e=this;this.$refs.position.startPositioning((function(i){var n=i.province+i.city+i.addr,a={id:e.fxVisitMainId,startCoordinate:"".concat(i.lng,",").concat(i.lat),singninAddress:n,type:1};t.log("params：",a),uni.setStorageSync("singninAddress",n),o.default.fxVisitMainSave(a).then((function(t){t.meta.success?(e.visitSignIn?e.visitSignIn.signInId=t.data.obj.id:e.visitSignIn={signInId:t.data.obj.id},e.visitSignIn.customerFiles=e.customerFiles,uni.setStorageSync("visitSignIn",e.visitSignIn),uni.redirectTo({url:"../businessProcessing/businessProcessing?id="+e.visitSignIn.id})):uni.showToast({title:t.meta.message,icon:"none",duration:1e3})})),uni.hideLoading()}))},signIn:function(){t.log("sdf"),uni.showLoading({title:"获取地址中...",mask:!0}),this.txPosition()},signIn1:function(){var e=this;t.log("sdf"),uni.showLoading({title:"获取地址中...",mask:!0}),uni.getLocation({type:"gcj02",geocode:!0,success:function(i){var n=new plus.maps.Point(i.longitude,i.latitude);plus.maps.Map.reverseGeocode(n,{},(function(n){var a={id:e.fxVisitMainId,singninCoordInate:"".concat(i.longitude,",").concat(i.latitude),singninAddress:n.address,type:1};t.log("params：",a),uni.setStorageSync("singninAddress",n.address),o.default.fxVisitMainSave(a).then((function(t){t.meta.success?(e.visitSignIn?e.visitSignIn.signInId=t.data.obj.id:e.visitSignIn={signInId:t.data.obj.id},e.visitSignIn.customerFiles=e.customerFiles,uni.setStorageSync("visitSignIn",e.visitSignIn),uni.redirectTo({url:"../businessProcessing/businessProcessing?id="+e.visitSignIn.id})):uni.showToast({title:t.meta.message,icon:"none",duration:1e3})}))}),(function(t){}))},fail:function(t){uni.showToast({title:"获取坐标失败,检查是否开启定位",icon:"none",duration:1e3})},complete:function(t){uni.hideLoading()}})},getDistance:function(t,e){var i=t.longitude,n=t.latitude,a=e.longitude,o=e.latitude,r=6370996.81*Math.acos(Math.cos(n*Math.PI/180)*Math.cos(o*Math.PI/180)*Math.cos(i*Math.PI/180-a*Math.PI/180)+Math.sin(n*Math.PI/180)*Math.sin(o*Math.PI/180));return r}})});e.default=s}).call(this,i("ba7c")["default"])},"98e0":function(t,e,i){"use strict";(function(t){function n(e,i,n){var a="";if("Android"==plus.os.name){var o=plus.runtime.isApplicationExist({pname:"com.baidu.BaiduMap",action:"baidumap://"}),r=plus.runtime.isApplicationExist({pname:"com.autonavi.minimap",action:"androidamap://"}),s="baidumap://map/marker?location="+e+","+i+"&title="+n+"&src=婚梯",u="androidamap://viewMap?sourceApplication=婚梯&poiname="+n+"&lat="+e+"&lon="+i+"&dev=0";r&&o?plus.nativeUI.actionSheet({title:"选择地图应用",cancel:"取消",buttons:[{title:"百度地图"},{title:"高德地图"}]},(function(t){switch(t.index){case 1:plus.runtime.openURL(s);break;case 2:plus.runtime.openURL(u);break}})):r?plus.runtime.openURL(u):o?plus.runtime.openURL(s):(a="geo:"+e+","+i+"?q=%e6%95%b0%e5%ad%97%e5%a4%a9%e5%a0%82",plus.runtime.openURL(a))}else plus.nativeUI.actionSheet({title:"选择地图应用",cancel:"取消",buttons:[{title:"高德地图"},{title:"百度地图"}]},(function(n){switch(t.log("e.index: "+n.index),n.index){case 1:a="iosamap://navi?sourceApplication=applicationName&poiname=fangheng&poiid=BGVIS&lat="+e+"&lon="+i+"&dev=0&style=0";break;default:a="baidumap://map/geocoder?location="+e+","+i+"&coord_type=bd09ll&src=ios.baidu.openAPIdemo";break}""!=a&&plus.runtime.openURL(a,(function(t){plus.nativeUI.alert("本机未安装指定的地图应用！")}))}))}i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){plus.maps.Map.geocode(t,(function(e){e.address;var i=e.coord;e.coordType;n(i.latitude,i.longitude,t)}),(function(e){e.address;var i=e.coord;e.coordType;n(i.latitude,i.longitude,t)}))}}).call(this,i("ba7c")["default"])},"9c08":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAQAAAC0jZKKAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfkCAUVMyidnOSWAAABZElEQVRIx+2WPy8EQRjGn70gBFfolCQkRK33BUShVSl9DK3qEhoRjdIH0IlKfAGNSk8kmruQy09xG2bmduZmd8Yp3NNsdt95f/vMvPNPmujPxAa9kW16rNYHA3SCLU4BfNFWkD4VjBahYBicIOuvvGsxCWbQDMfcpGEl+tWfAW6tt7Mg5sosHvt2KZ0xLnZqGPywMq/tYLh44Zn8GTtCVldY989RI2PFl6+IQCNjzhLw1LWB3LWVbcG44McE1qbne94x/rW94h+BaYVr0hDMkuJnfPysYIuB2lH5boA7jivbHZTYmUhjzibUBuBoqNX5gFqjx0OOuwBY64l7H7bW7lZ2+bvAvAHwosh8P3ja9EcPgAcpGWy4LsrnpZQLvMePDqVsYImLErutoBocTezyzLxGaExn3rh2N5ZzgY1rXNmRbkPSrArzWmgepmt6kjSXYPOk0rEk8dr4xtnXQpHtVjJRjL4A5rcxZR83a+QAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMDgtMDVUMTM6NTE6NDArMDg6MDCAysqwAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTA4LTA1VDEzOjUxOjQwKzA4OjAw8ZdyDAAAAABJRU5ErkJggg=="},c4f4:function(t,e,i){"use strict";i.r(e);var n=i("f9d7"),a=i("0bdc");for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("8dbc");var r=i("828b"),s=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"28d0da9a",null,!1,n["a"],void 0);e["default"]=s.exports},cfe6:function(t,e,i){var n=i("556d");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("967d").default;a("39baf57a",n,!0,{sourceMap:!1,shadowMode:!1})},f55d:function(t,e,i){"use strict";(function(t){i("6a54");var n=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.yearTranforDate=e.weeks=e.weekTranforDate=e.wait=e.txMapMarkerUrlByList=e.txMapMarkerUrl=e.showModal=e.seasons=e.seasonTranforDate=e.monthTranforDate=e.getSystemYears=e.getDateRangeFordiffDays=e.getCurrentWeekForYear=e.getCurrentSeason=e.default=void 0,i("bf0f"),i("fd3c"),i("1851"),i("e966"),i("c223"),i("d4b5");var a=n(i("63d3")),o=function(t){return new Promise((function(e){setTimeout(e,t)}))};e.wait=o;e.showModal=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.title,i=void 0===e?"提示":e,n=t.content,a=void 0===n?"":n;return new Promise((function(t,e){uni.showModal({title:i,content:a,success:function(e){e.confirm?t(!0):e.cancel&&t(!1)},fail:e})}))};e.getSystemYears=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.startYear,i=void 0===e?1876:e,n=t.timeRang,a=void 0===n?300:n;return Array(a).fill(i).map((function(t,e){return t+e}))};var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.month,i=void 0===e?1:e;return~~(parseInt(i)/4)};e.getCurrentSeason=r;var s=["第一季度","第二季度","第三季度","第四季度"];e.seasons=s;var u=function(){return Array(52).fill(1).map((function(t,e){return"".concat(t+e,"周")}))}();e.weeks=u;e.getCurrentWeekForYear=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t?new Date(t):new Date,i=t?new Date(t):new Date;i.setMonth(0),i.setDate(1);var n=Math.ceil((e-i)/864e5);return Math.ceil(n/7)+1};var c=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&e){var n=864e5,a=new Date(t,0,1),o=new Date(a.getTime()+7*e*n),r=new Date(weekEndDate.getTime()-6*n);return i?{dateStart:o.getTime(),dateEnd:r.getTime()}:{dateStart:o,dateEnd:r}}};e.weekTranforDate=c;var d=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&e){var n=[0,3,6,9],a=[31,30,30,31],o=new Date(t,n[e-1],1),r=new Date(t,n[e-1]+2,a[e-1]);return i?{dateStart:o.getTime(),dateEnd:r.getTime()}:{dateStart:o,dateEnd:r}}};e.seasonTranforDate=d;var l=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t){var i=new Date(t,0,1),n=new Date(t,11,31);return e?{dateStart:i.getTime(),dateEnd:n.getTime()}:{dateStart:i,dateEnd:n}}};e.yearTranforDate=l;e.monthTranforDate=function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&e){var n=864e5,a=new Date(t,e-1,1),o=new Date(t,e,1),r=new Date(o.getTime()-n);return i?{dateStart:a.getTime(),dateEnd:r.getTime()}:{dateStart:a,dateEnd:r}}};var f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.date,i=void 0===e?"":e,n=t.diffDays,o=void 0===n?0:n,r=t.isBefore,s=void 0===r||r,u=t.isFormatDate,c=void 0===u||u,d=i?new Date(i):new Date,l=864e5,f=o*l,g=new Date(s?d.getTime()-f:d.getTime()+f),m=s?g:d,p=s?d:g;return c?[a.default.formatDate(m),a.default.formatDate(p)]:[m,p]};e.getDateRangeFordiffDays=f;var g=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(t.key,t.latitude),n=t.longitude,a=t.title,o="baidumap://map/marker?location=".concat(i,",").concat(n,"&title=").concat(encodeURIComponent(a||"位置"),"&content=").concat(encodeURIComponent(a||""),"&src=").concat(encodeURIComponent("悦商云APP"));if(!e)return o;uni.navigateTo({url:"/pages/navigator/navigator?params="+JSON.stringify({marker:t})})};e.txMapMarkerUrl=g;var m=function(e,i){e.key;var n=e.referer;if(!i||0===i.length)return"";var a=i[0],o=a.latitude,r=a.longitude,s=a.title,u="baidumap://map/marker?location=".concat(o,",").concat(r,"&title=").concat(encodeURIComponent(s||"位置"),"&content=").concat(encodeURIComponent("共".concat(i.length,"个位置")),"&src=").concat(encodeURIComponent(n||"悦商云APP"));return t.log("百度地图标记:",u),u};e.txMapMarkerUrlByList=m;var p={wait:o,getCurrentSeason:r,seasons:s,weekTranforDate:c,seasonTranforDate:d,yearTranforDate:l,getDateRangeFordiffDays:f,txMapMarkerUrl:g,txMapMarkerUrlByList:m};e.default=p}).call(this,i("ba7c")["default"])},f9d7:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"contain"},[n("tx-map-position",{ref:"position"}),n("v-uni-web-view",{attrs:{src:t.positionUrl}}),n("v-uni-view",{staticClass:"foot-buttons"},[n("v-uni-view",{staticClass:"foot-item foot-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.signIn.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"foot-item-image",attrs:{src:i("9c08"),mode:""}}),n("v-uni-text",{staticClass:"foot-item-text"},[t._v("签到")])],1)],1)],1)},a=[]}}]);