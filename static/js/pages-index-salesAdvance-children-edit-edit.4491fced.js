(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-salesAdvance-children-edit-edit"],{"3f8e":function(t,i,e){"use strict";e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){}));var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"contain"},[e("v-uni-view",{staticClass:"middle"},[e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("单据日期：")]),e("v-uni-view",{staticClass:"middle-select"},[e("v-uni-picker",{attrs:{mode:"date",disabled:!t.checkStatus,value:t.createDateF},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.bindDateChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.createDateF))])],1),e("v-uni-image",{attrs:{src:"/static/img/outNote/data.png",mode:""}})],1),e("v-uni-view",{staticClass:"middle-line"})],1),e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("经手人：")]),e("v-uni-view",{staticClass:"middle-select",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.handlersList.apply(void 0,arguments)}}},[e("v-uni-input",{attrs:{type:"text",placeholder:"点击选择经手人",disabled:!0},model:{value:t.handleName,callback:function(i){t.handleName=i},expression:"handleName"}}),e("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),e("v-uni-view",{staticClass:"middle-line"})],1),e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("收付方式：")]),t.dictionnaryList.length>0?e("v-uni-view",{staticClass:"middle-select"},[e("v-uni-picker",{attrs:{value:t.dictionnaryIndex,disabled:!t.checkStatus,range:t.dictionnaryList,"range-key":"name"},on:{change:function(i){arguments[0]=i=t.$handleEvent(i),t.dictionnaryChange.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"pickval"},[t._v(t._s(t.dictionnaryIndex>=0?t.dictionnaryList[t.dictionnaryIndex].name:""))])],1),e("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1):t._e(),e("v-uni-view",{staticClass:"middle-line"})],1),e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("机构：")]),e("v-uni-view",{staticClass:"middle-select",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.organizationList.apply(void 0,arguments)}}},[e("v-uni-input",{attrs:{type:"text",placeholder:"点击选择机构",disabled:!0},model:{value:t.organizationName,callback:function(i){t.organizationName=i},expression:"organizationName"}}),e("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),e("v-uni-view",{staticClass:"middle-line"})],1),e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("客户：")]),e("v-uni-view",{staticClass:"middle-select",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.customerList.apply(void 0,arguments)}}},[e("v-uni-input",{attrs:{type:"text",placeholder:"点击选择客户",disabled:!0},model:{value:t.customerName,callback:function(i){t.customerName=i},expression:"customerName"}}),e("v-uni-image",{attrs:{src:"/static/img/outNote/right.png"}})],1),e("v-uni-view",{staticClass:"middle-line"})],1),e("v-uni-view",{staticClass:"item"},[e("v-uni-view",{staticClass:"middle-des"},[t._v("摘要：")]),e("v-uni-view",{staticClass:"middle-select"},[e("v-uni-input",{attrs:{type:"text",placeholder:"",disabled:!t.checkStatus},model:{value:t.abstract,callback:function(i){t.abstract=i},expression:"abstract"}})],1),e("v-uni-view",{staticClass:"middle-line"})],1)],1),e("v-uni-view",{staticClass:"sweepCode"},[e("v-uni-view"),e("v-uni-image",{attrs:{src:"/static/img/outNote/add.png",mode:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.addbillList.apply(void 0,arguments)}}})],1),e("v-uni-view",{staticClass:"shopList"},t._l(t.billList,(function(i,a){return e("v-uni-view",{key:a,staticClass:"order-item",attrs:{id:"shop_"+i.id}},[e("v-uni-view",{staticClass:"order-item-row",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.editbillList(a)}}},[e("v-uni-text",{staticClass:"order-item-row-left"},[t._v("会计科目：")]),e("v-uni-input",{staticClass:"order-sec-left",attrs:{type:"text",placeholder:"点击选择收款账户",value:i.kmName,disabled:!0}})],1),e("v-uni-view",{staticClass:"order-item-row"},[e("v-uni-text",{staticClass:"order-item-row-left"},[t._v("金额：")]),e("v-uni-input",{staticClass:"order-item-row-input",attrs:{type:"digit",value:i.debitAmount,disabled:!t.checkStatus},on:{blur:function(i){arguments[0]=i=t.$handleEvent(i),t.setItem(i,a,"billList","debitAmount")},confirm:function(i){arguments[0]=i=t.$handleEvent(i),t.setItem(i,a,"billList","debitAmount")}}})],1),e("v-uni-view",{staticClass:"order-item-row"},[e("v-uni-text",{staticClass:"order-item-row-left"},[t._v("备注：")]),e("v-uni-input",{staticClass:"order-item-row-input",attrs:{type:"text",value:i.remarks,disabled:!t.checkStatus},on:{blur:function(i){arguments[0]=i=t.$handleEvent(i),t.setItem(i,a,"billList","remarks")},confirm:function(i){arguments[0]=i=t.$handleEvent(i),t.setItem(i,a,"billList","remarks")}}})],1),e("v-uni-text",{staticClass:"delete",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.delectItem(i,"billList",a)}}},[t._v("删除")])],1)})),1),t._l(2,(function(i){return e("v-uni-view",{key:"footfixed"+i,class:["footfixed",2===i?"hide":""]},[e("v-uni-view",{staticClass:"foot-bg"},[e("v-uni-view",{staticClass:"foot-bg-left"},[e("v-uni-image",{attrs:{src:"/static/img/PriceHistory.png",mode:""}}),e("v-uni-view",[t._v("金额："),e("v-uni-text",[t._v(t._s(t.amount))])],1)],1),t.checkStatus?e("v-uni-view",{staticClass:"foot-bg-right",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.creatNewDocm.apply(void 0,arguments)}}},[t._v("保存")]):t._e()],1)],1)}))],2)},n=[]},"508a":function(t,i,e){"use strict";e.r(i);var a=e("eea1"),n=e.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(s);i["default"]=n.a},"7a95":function(t,i,e){"use strict";var a=e("898a"),n=e.n(a);n.a},"898a":function(t,i,e){var a=e("dd05");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=e("967d").default;n("69a528a0",a,!0,{sourceMap:!1,shadowMode:!1})},a262:function(t,i,e){"use strict";e("c223");var a=e("d4d7"),n={listBillPage:function(t){return(0,a.get)("api/accountVoucher/listBillPage",t,1)},authorganizationList:function(t){return(0,a.get)("api/basicData/authorganization/list",t,1)},dictionnaryList:function(t){return(0,a.get)("api/basedata/dictionnary/list",t,1)},billDetail:function(t){return(0,a.get)("api/accountVoucher/billDetail",t,1)},getKMListByAvType:function(t){return(0,a.get)("api/financial/getKMListByAvType",t,1)},savePreOrCollectBill:function(t){return(0,a.post)("finance/accountingVoucher/savePreOrCollectBill",t,8)},checkNegative:function(t){return(0,a.patch)("api/accountVoucher/checkNegative?id="+t.id,null,1)},checkBill:function(t){return(0,a.patch)("api/accountVoucher/checkBill"+"?absTract=".concat(t.absTract,"&autoAbsTract=").concat(t.autoAbsTract,"&id=").concat(t.id),null,1)}};t.exports=n},dd05:function(t,i,e){var a=e("c86c");i=a(!1),i.push([t.i,"uni-page-body[data-v-bd0d14c4]{background-color:#f6f6f6}body.?%PAGE?%[data-v-bd0d14c4]{background-color:#f6f6f6}.contain[data-v-bd0d14c4]{background-color:#f6f6f6}.contain .middle[data-v-bd0d14c4]{padding-top:%?40?%;background:#fff}.contain .middle .item[data-v-bd0d14c4]{position:relative;display:flex;height:%?80?%;line-height:%?80?%;padding-left:%?20?%;padding-right:%?20?%}.contain .middle .item[data-v-bd0d14c4]:last-child{padding-bottom:0}.contain .middle .item .middle-des[data-v-bd0d14c4]{font-size:%?32?%;width:%?160?%;height:%?80?%;line-height:%?80?%;text-align:right}.contain .middle .item .middle-select[data-v-bd0d14c4]{flex:1;display:flex;justify-content:space-between;width:%?496?%;font-size:%?30?%;border-radius:5px}.contain .middle .item .middle-select uni-input[data-v-bd0d14c4]{flex:1;height:%?80?%;line-height:%?80?%;font-size:%?30?%;padding-left:%?20?%}.contain .middle .item .middle-select uni-text[data-v-bd0d14c4]{color:#ffb822;font-size:%?26?%;padding:0 %?20?%}.contain .middle .item .middle-select uni-image[data-v-bd0d14c4]{width:%?40?%;height:%?40?%;padding-top:%?20?%}.contain .middle .item .middle-line[data-v-bd0d14c4]{position:absolute;left:%?20?%;right:%?20?%;bottom:0;height:1px;background-color:#f3f3f3}.contain .middle .item uni-picker[data-v-bd0d14c4]{padding-left:%?20?%;width:%?496?%}.contain .sweepCode[data-v-bd0d14c4]{display:flex;justify-content:space-between;padding:0 %?40?%;border-bottom:%?2?% #eee solid;background:#fff}.contain .sweepCode uni-image[data-v-bd0d14c4]{width:%?48?%;height:%?48?%;padding:%?26?% 0}.contain .shopList[data-v-bd0d14c4]{margin-bottom:%?40?%;background:#fff}.contain .shopList .order-item[data-v-bd0d14c4]{position:relative;padding:%?40?%;border-bottom:%?1?% solid #eee}.contain .shopList .order-item .order-item-row[data-v-bd0d14c4]{display:flex;flex-direction:row;align-items:center;width:100%;color:grey}.contain .shopList .order-item .order-item-row-left[data-v-bd0d14c4]{width:%?150?%;font-size:%?28?%;line-height:%?60?%}.contain .shopList .order-item .order-item-row-input[data-v-bd0d14c4]{flex:1;font-size:%?28?%;border-bottom:1px solid #ddd}.contain .shopList .order-item .delete[data-v-bd0d14c4]{position:absolute;top:0;right:0;padding:%?10?% %?20?%;color:red}.contain .paymentMethod[data-v-bd0d14c4]{background-color:#fff;margin-bottom:%?40?%;padding:%?40?% %?40?% %?20?%}.contain .paymentMethod .paymentMethod-item[data-v-bd0d14c4]{display:flex;align-items:center;height:%?80?%;padding-bottom:%?20?%;font-size:%?32?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-name[data-v-bd0d14c4]{width:%?160?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue[data-v-bd0d14c4]{flex:1;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #ddd}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-picker[data-v-bd0d14c4], .contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue uni-input[data-v-bd0d14c4]{flex:1;height:%?80?%;padding-left:%?20?%;line-height:%?80?%}.contain .paymentMethod .paymentMethod-item .paymentMethod-item-vlue .right[data-v-bd0d14c4]{width:%?48?%;height:%?48?%}.contain .footfixed[data-v-bd0d14c4]{display:block;position:fixed;bottom:%?0?%!important;bottom:%?100?%;width:100%;height:%?100?%;background:#fff;z-index:10}.contain .footfixed .foot-bg[data-v-bd0d14c4]{display:flex}.contain .footfixed .foot-bg .foot-bg-left[data-v-bd0d14c4]{display:flex;width:70%;font-size:%?32?%;font-weight:500;text-align:center;line-height:%?100?%}.contain .footfixed .foot-bg .foot-bg-left uni-image[data-v-bd0d14c4]{width:%?48?%;height:%?48?%;margin:%?25?% %?20?% 0 %?90?%}.contain .footfixed .foot-bg .foot-bg-left uni-text[data-v-bd0d14c4]{color:red}.contain .footfixed .foot-bg .foot-bg-right[data-v-bd0d14c4]{width:30%;height:%?100?%;line-height:%?100?%;text-align:center;background:#ffb822;font-size:%?32?%;color:#fff}.contain .hide[data-v-bd0d14c4]{position:inherit;visibility:hidden}",""]),t.exports=i},eea1:function(t,i,e){"use strict";(function(t){e("6a54");var a=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("e838"),e("aa9c"),e("dd2b"),e("c223");var n,s=a(e("39d8")),d=a(e("9b1b")),o=a(e("a262")),c=e("8f59"),l=(a(e("63d3")),n={components:{},data:function(){return{item:null,createDate:"",createDateF:"",employees:{},handleName:"",handleNameId:0,fsId:"",fsName:"",dictionnaryList:[],dictionnaryIndex:0,organization:{},organizationId:0,organizationName:"",customer:{},customerId:"",customerName:"",amount:null,abstract:"",checkStatus:!0,billList:[],billListItem:{},billListUpIndex:-1,getKMListByAvTypeItem:null}},created:function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})},onLoad:function(t){var i=this.params.item;this.item=this.params.item,i?(this.createDate=i.createDate,this.createDateF=this.timeShift.formatDate(i.createDate),this.handleNameId=i.jsId,this.handleName=i.jsName,this.fsId=i.fsId,this.fsName=i.fsName,this.organizationId=i.orgId,this.customerId=i.zbid,this.customerName=i.zkmName,this.amount=i.amount,this.abstract=i.abstract,this.checkStatus=1===i.checkStatus):(this.item={id:null},this.createDate=(new Date).getTime(),this.createDateF=this.timeShift.formatDate(new Date),this.handleNameId=uni.getStorageSync("userId"),this.handleName=uni.getStorageSync("name")),this.initData(),this.dictionnary(),this.authorganizationList(),this.getKMListByAvType()},onShow:function(){},onReady:function(){},onReachBottom:function(){}},(0,s.default)(n,"created",(function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})})),(0,s.default)(n,"mounted",(function(){})),(0,s.default)(n,"computed",(0,d.default)({},(0,c.mapState)(["params"]))),(0,s.default)(n,"watch",{employees:function(t){null!=t&&t.length>0&&(this.handleName=t[0].name,this.handleNameId=t[0].id)},organization:function(t){var i=this;null!=t&&t.length>0&&(this.organizationName=t[0].name,this.organizationId=t[0].id,setTimeout((function(){i.initData()}),300))},customer:function(t){var i=this;null!=t&&t.length>0&&(this.customerId=t[0].zbId,this.customerName=t[0].name,setTimeout((function(){i.initData()}),300))},billListItem:function(t){var i=this;null!=t&&t.length>0&&setTimeout((function(){var e=i.billList[i.billListUpIndex];e.allId=t[0].allId,e.asId=t[0].id,e.kmName=t[0].name,i.$forceUpdate()}),800)}}),(0,s.default)(n,"methods",(0,d.default)((0,d.default)({},(0,c.mapMutations)(["setparams"])),{},{allEmployeesInfo:function(){var t=this;o.default.allEmployeesInfo(null).then((function(i){if(i.meta.success)for(var e=0;e<i.data.list.length;e++){var a=i.data.list[e];t.handleNameId===a.id&&(t.handleName=a.name)}else uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},dictionnary:function(){var t=this;o.default.dictionnaryList({dictionaryTypeId:2}).then((function(i){if(i.meta.success)if(t.dictionnaryList=i.data,t.fsId)for(var e=0;e<t.dictionnaryList.length;e++){var a=t.dictionnaryList[e];a.id===t.fsId&&(t.dictionnaryIndex=e)}else t.fsId=t.dictionnaryList[0].id;else uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},authorganizationList:function(){var t=this;o.default.authorganizationList(null).then((function(i){if(i.meta.success)if(t.organizationId)for(var e=0;e<i.data.length;e++){var a=i.data[e];a.id===t.organizationId&&(t.organizationName=a.name)}else t.organizationId=i.data[0].id,t.organizationName=i.data[0].name;else uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},getKMListByAvType:function(){var t=this,i={direction:"借",typeName:"销售预收单",orgId:t.organizationId,zbId:t.customerId};o.default.getKMListByAvType(i).then((function(i){i.meta.success?t.getKMListByAvTypeItem=i.data[0]:uni.showToast({title:i.meta.message,icon:"none",duration:1e3})})).then((function(i){t.item.id||t.addbillList()}))},initData:function(){var t=this;if(t.item.id){var i={id:t.item.id};o.default.billDetail(i).then((function(i){i.meta.success?(t.billList=i.data,t.arrearsFn()):uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))}},bindDateChange:function(t){this.createDate=new Date(t.target.value).getTime(),this.createDateF=t.target.value},handlersList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"employees",filed:"employees"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},dictionnaryChange:function(t){this.dictionnaryIndex=t.detail.value,this.fsId=this.dictionnaryList[this.dictionnaryIndex].id},organizationList:function(t){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"organization",filed:"organization"}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},customerList:function(){this.checkStatus&&(uni.hideKeyboard(),this.setparams({searchtype:"getCustomerKMPage",filed:"customer",typeName:"应收账款",orgId:this.organizationId}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},arrearsFn:function(){this.amount=0;for(var t=0;t<this.billList.length;t++)this.amount+=parseFloat(this.billList[t].debitAmount)},addbillList:function(){this.checkStatus&&this.billList.push({id:null,pid:this.item.id,asId:this.getKMListByAvTypeItem.id,allId:this.getKMListByAvTypeItem.allId,kmName:this.getKMListByAvTypeItem.name,zbId:this.getKMListByAvTypeItem.zbId,debitAmount:0,remarks:""})},editbillList:function(t){this.checkStatus&&(this.billListUpIndex=t,uni.hideKeyboard(),this.setparams({searchtype:"collectionAccount",filed:"billListItem",direction:"借",orgId:this.organizationId,typeName:"销售预收单",zbId:this.customerId}),uni.navigateTo({url:"/pages/index/newtoolsSearchList/toolssearchlist"}))},setItem:function(t,i,e,a){var n=this.billList[i];if("remarks"===a)n[a]=t.detail.value,this.$set(this.billList,i,n);else{var s=parseFloat(t.detail.value);n[a]!==s&&(n[a]=t.detail.value?s:0,this.$set(this.billList,i,n),this.arrearsFn())}},delectItem:function(t,i,e){this.checkStatus&&(this.billList.splice(e,1),this.arrearsFn())},creatNewDocm:function(){if(this.createDate)if(this.handleNameId)if(this.organizationId)if(this.customerId){this.arrearsFn();for(var i=[],e=0;e<this.billList.length;e++){var a=this.billList[e];i.push({id:a.id,pid:this.item.id,asId:a.asId,allId:a.allId,kmName:a.kmName,zbId:a.zbId?a.zbId:0,amount:a.debitAmount,remarks:a.remarks})}var n={id:this.item.id,date:this.createDate,abstractStr:this.abstract,avType:2,list:i,jsId:this.handleNameId,fsId:this.fsId,orgId:this.organizationId,zbId:this.customerId,typeId:8};o.default.savePreOrCollectBill(n).then((function(i){i.meta.success?(t.log(i.data),uni.showToast({title:"保存成功",icon:"none",duration:1e3}),uni.redirectTo({url:"../billSuccess/billSuccess?saleNo=".concat(i.data.av.oddCode,"&id=").concat(i.data.av.id,"&absTract=").concat(i.data.av.absTract)})):uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))}else uni.showToast({title:"请选择客户",icon:"none",duration:1e3});else uni.showToast({title:"请选择机构",icon:"none",duration:1e3});else uni.showToast({title:"请选择经手人",icon:"none",duration:1e3});else uni.showToast({title:"请选择单据日期",icon:"none",duration:1e3})}})),n);i.default=l}).call(this,e("ba7c")["default"])},fcdef:function(t,i,e){"use strict";e.r(i);var a=e("3f8e"),n=e("508a");for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(s);e("7a95");var d=e("828b"),o=Object(d["a"])(n["default"],a["b"],a["c"],!1,null,"bd0d14c4",null,!1,a["a"],void 0);i["default"]=o.exports}}]);