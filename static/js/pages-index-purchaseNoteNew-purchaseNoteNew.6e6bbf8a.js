(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-purchaseNoteNew-purchaseNoteNew"],{"07f7":function(t,e,i){var a=i("6a1c");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=i("967d").default;s("59809b14",a,!0,{sourceMap:!1,shadowMode:!1})},"28af":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAeFBMVEVHcEz/uCL/uCH/uyD/uSL/uCL/uCL/vwD/uCL/uCL/uSP//wD/uCH/uCL/uCL/uSL/uCL/vBv/uCL/tyL/uSD/vRz/gAD/uSL/uSL/xhz/uSD/tyL/vyD/tiT/sxr/uCL/uSH/vSb/vxr/uSL/uSP/uCL/uSL/uCJr7deNAAAAJ3RSTlMA07c4ePiXBOvjVwHtrbSH+ROWhzcbAtKrCVeVCBwU+uwbFJVYrJaUPC3oAAABLElEQVQ4y73V15aDIBAGYAsgWGIv2fS28/5vuEpMbAjjzc4lfIejM79oWStFed2QorJQBbJEXmpM4JLIHjAAzdIVeotFB8YYgP+o6PmRvLenGIB5C+uHn805ht1+Sj027C0w7CZnHx3QYWDjc8dWhWH0lgxMmH876IMRQ9bb+xWBaT/LAyAw5NKeLigsZKpiQGEouuwIJCbtsgtI3LTLBIu76EZYzNvlGotpuxwq8UolWzDdgvkWbAOq5DdvNTgcSUxwmEhc4LArcSUwVgTvN8wxOO7bUVKzTW6f5mVm/Ph2OuUmG56HuTxN2B9Pkektm16LO511ZlfuXqOd4zxO3uqT/HqK9D2VPbn66qym2WI6l8N9NdplPsmJiE/a319VkJfNaRLWEXED67/qD2AyrzgDNasIAAAAAElFTkSuQmCC"},"37b9":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAJ1BMVEX///8zMzP6+vpwcHCSkpJ9fX2IiIhISEjY2Njt7e2/v787OztbW1vTET4fAAAAk0lEQVQ4y82TuQ2EQBAEVwgkDq/FY584FwciIATIAEIgCgwCwMEhBEK4zEigy98xt1Wz8/SEEHsUCwh3BcCj0b0nh7yQP/KpdgI2NRY4JVvth4BLmizwV22BDoCkV/11wk8abKZZpQUyAlYAUgJQwFT8OZbLDeJIcIihpbHjoni1aAa2DxqOLRrI1HgGfDh8avHEC/ZBGXwrpcb3AAAAAElFTkSuQmCC"},"37e1":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"contain"},[a("v-uni-view",{staticClass:"head"},[a("v-uni-view",{staticClass:"header-left"},[a("v-uni-image",{attrs:{src:i("37b9"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"header-middle"},[a("v-uni-text",[t._v("采购订货单")])],1),a("v-uni-view",{staticClass:"header-right"},[a("v-uni-image",{attrs:{src:i("5bc3")},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearAllDate.apply(void 0,arguments)}}}),a("v-uni-image",{attrs:{src:"/static/img/history.png"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.toHistory.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{staticClass:"pubBlank"}),a("v-uni-view",{staticClass:"middle"},[a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 单据日期： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-picker",{attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.bindDateChange.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.date))])],1),a("v-uni-image",{attrs:{src:i("846e"),mode:""}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 供应商： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectSupplier.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择供应商"},model:{value:t.supplierName,callback:function(e){t.supplierName=e},expression:"supplierName"}}),a("v-uni-image",{attrs:{src:i("59b8"),mode:""}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 机构仓库： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectStorehouse.apply(void 0,arguments)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择机构"},model:{value:t.storehouseName,callback:function(e){t.storehouseName=e},expression:"storehouseName"}}),a("v-uni-image",{attrs:{src:i("59b8"),mode:""}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 交货日期： ")]),a("v-uni-view",{staticClass:"middle-select"},[a("v-uni-picker",{class:{colorGray:t.colorGray},attrs:{mode:"date",value:t.appointment},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.contractDate.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-input"},[t._v(t._s(t.other))])],1),a("v-uni-image",{attrs:{src:i("846e"),mode:""}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 经手人： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList(0)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择经手人"},model:{value:t.handleName,callback:function(e){t.handleName=e},expression:"handleName"}}),a("v-uni-image",{attrs:{src:i("59b8")}})],1)],1),a("v-uni-view",{staticClass:"item"},[a("v-uni-view",{staticClass:"middle-des"},[t._v(" 业务员： ")]),a("v-uni-view",{staticClass:"middle-select",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handlersList(1)}}},[a("v-uni-input",{attrs:{type:"text",placeholder:"点击选择业务员"},model:{value:t.businessName,callback:function(e){t.businessName=e},expression:"businessName"}}),a("v-uni-image",{attrs:{src:i("59b8")}})],1)],1)],1),a("v-uni-view",{staticClass:"sweepCode"},[a("v-uni-image",{attrs:{src:i("9ec0"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.commodityList.apply(void 0,arguments)}}}),a("v-uni-image",{attrs:{src:i("9796"),mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.scanning.apply(void 0,arguments)}}})],1),t._l(t.purchaseList,(function(e,s){return a("v-uni-view",{key:s,staticClass:"order-item"},[a("v-uni-view",{staticClass:"order-item-top"},[a("v-uni-image",{staticClass:"order-item-left",attrs:{src:e.picture,mode:""},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewPhoto(s)}}}),a("v-uni-view",{staticClass:"order-item-right"},[a("v-uni-view",{staticClass:"order-inside inside-left",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeOpen(e,s)}}},[a("v-uni-view",{staticClass:"order-fir-left"},[t._v(t._s(e.goodsName))]),a("v-uni-view",{staticClass:"order-sec-left"},[t._v("库存："+t._s(e.quantity))]),t.useMultUnit?a("v-uni-view",{staticClass:"order-sec-left"},[t._v("规格：1"+t._s(e.specUnit)+"*"+t._s(e.multipleUnitSpecification)+t._s(e.smallUnit))]):a("v-uni-view",{staticClass:"order-sec-left"},[t._v("规格：1"+t._s(e.largeUnit)+"* "+t._s(e.packingSpecification)+t._s(e.smallUnit))])],1),a("v-uni-view",{staticClass:"order-inside inside-right"},[a("v-uni-view",{staticClass:"order-fir-right"},[t._v("￥"+t._s(e.amount?e.amount:0))]),a("v-uni-view",{staticClass:"order-sec-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delectItem(e,s)}}},[t._v("删除")])],1)],1)],1),e.checked?a("v-uni-view",{staticClass:"order-item-bottom"},[t.useMultUnit?a("v-uni-view",{staticClass:"bottom-fir"},[a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("单价")]),a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.modePrice?e.modePrice:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("数量")]),a("v-uni-input",{attrs:{type:"number",value:e.itemQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("单位")]),a("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getSelectUnit(s)}}},[t._v(t._s(e.specUnit))])],1),a("v-uni-view",{staticClass:"bottom-input"})],1):a("v-uni-view",{staticClass:"bottom-fir"},[a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("件价")]),a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.saleIP?e.saleIP:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceIP(e,s)}}})],1),a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("件数")]),a("v-uni-input",{attrs:{type:"number",value:e.itemQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberIP(e,s)}}})],1),1!=e.packingSpecification||e.saleIP!=e.saleSP?a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("散价")]),a("v-uni-input",{attrs:{type:"digit",disabled:t.noPriceChangeAllowed,value:e.saleSP?e.saleSP:0},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.priceSP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.priceSP(e,s)}}})],1):t._e(),1!=e.packingSpecification||e.saleIP!=e.saleSP?a("v-uni-view",{staticClass:"bottom-input"},[a("v-uni-view",{staticClass:"bottom-des"},[t._v("散数")]),a("v-uni-input",{attrs:{type:"number",value:e.scatteredQuantity},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.numberSP(e,s)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.numberSP(e,s)}}})],1):t._e()],1),a("v-uni-view",{staticClass:"bottom-sec"},[a("v-uni-view",{staticClass:"bottom-sec-des"},[t._v("型号：")]),a("v-uni-view",{staticClass:"bottom-sec-num"},[t._v(t._s(e.typeSpecification))])],1)],1):t._e(),a("v-uni-view",{staticClass:"order-item-foot",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeOpen(e,s)}}},[e.checked?a("v-uni-view",{staticClass:"foot-des"},[a("v-uni-view",[t._v("点击收起")]),a("v-uni-image",{staticStyle:{transform:"rotate(180deg)"},attrs:{src:i("4fe6"),mode:""}})],1):a("v-uni-view",{staticClass:"foot-des"},[a("v-uni-view",[t._v("展开更多")]),a("v-uni-image",{attrs:{src:i("4fe6"),mode:""}})],1)],1)],1)})),a("v-uni-view",{staticClass:"blank",staticStyle:{background:"#F6F6F6"}}),t.purchaseList.length?a("v-uni-view",{staticClass:"footfixed"},[a("v-uni-view",{staticClass:"foot-bg"},[a("v-uni-view",{staticClass:"foot-bg-left"},[a("v-uni-image",{attrs:{src:i("28af"),mode:""}}),a("v-uni-view",[t._v("总金额："),a("v-uni-text",[t._v(t._s(t.total))])],1)],1),a("v-uni-view",{staticClass:"foot-bg-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.creatPurchase.apply(void 0,arguments)}}},[t._v("下单")])],1)],1):t._e()],2)},s=[]},"4fe6":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAKBAMAAACgUqiRAAAAGFBMVEWEhISAgIBHcEyAgIB6enqAgICCgoKAgIAUaalZAAAAB3RSTlMT0gDXGbcqhO85WQAAAEpJREFUCNdjSGVSAgHXBIZwARBDxTyAgbEQJOhcyMCgIC4AEhJQYFACCToXMgFZQEGgkBKQBRRMBgqDWAri5UClIBZYJYSlEAAiAOZMDmcJUYE4AAAAAElFTkSuQmCC"},"59b8":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqBAMAAAA37dRoAAAAFVBMVEVHcEyXl5ebm5uXl5eXl5eYmJiXl5dhgIfDAAAABnRSTlMAugiMpToMNkwxAAAAU0lEQVQoz2NgGOwgUAGLIGuaEBZRxrRELIqZxLApZlJMS2HAqtiBQsUMOBUbYFWcTLxiRlIUYxXFah0T5UpTiA0d0pQqEBmb2GMeeyrBnqIGIQAA2U8VBfend9IAAAAASUVORK5CYII="},"5bc3":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAABN0lEQVRoge2YMQ6DMAxFOQhzD/BtxUOvwLV6HNaOHKkSbJ3oEqSoSmjSBhKKn+SFKMiPuPSLplH+EAAdEQ1ENNkaAHSl+4qCmW9ENPuKmW+l+1vFPnlv80tVfRJ2bJanfReRVkRaZr47EkPpPoPYeZ+JaBaRdrkuIq0jMJXscRV3VFLWqkEFSqMCpVGB0qhADt6S5Gqu2bHiEu1akqylgok2JknWUt6TIE+SzDKTGYhKtBRIkrXwMdH+g8CxR+jwP+KmOfhr9O0khpJNBirt04y7OXpTZn7qQQUyoAIq8CObCNj/isn3Ps69tokAET3t9adnT9a1rQSCN829pgIqoAInFxiXzcx83VuAma/O9TFZAEDv3rhkAeiTBYwxFwCPCpp/GGMuyQKORO+O0441Aui/bl5RTsILecwmw0E3NbEAAAAASUVORK5CYII="},"6a1c":function(t,e,i){var a=i("c86c");e=a(!1),e.push([t.i,"uni-page-body[data-v-02bda258]{background-color:#f6f6f6}body.?%PAGE?%[data-v-02bda258]{background-color:#f6f6f6}.head[data-v-02bda258]{display:flex;justify-content:space-between;font-weight:590}.header-left[data-v-02bda258]{width:20%}.header-middle[data-v-02bda258]{width:25%}.head uni-image[data-v-02bda258]{width:%?48?%;height:%?48?%;margin:%?7?% %?15?%;display:block}.header-right[data-v-02bda258]{display:flex;width:20%}.middle[data-v-02bda258]{padding:%?40?%}.pubBlank[data-v-02bda258]{height:%?120?%}.item[data-v-02bda258]{display:flex;height:%?80?%;line-height:%?80?%;padding-bottom:%?20?%}.item[data-v-02bda258]:last-child{padding-bottom:0}.middle-des[data-v-02bda258]{font-size:%?32?%;width:%?160?%;text-align:right}.middle-select[data-v-02bda258]{display:flex;justify-content:space-between;background:#f7f6fb;width:%?496?%;font-size:%?30?%;border-radius:5px}uni-picker[data-v-02bda258]{padding-left:%?20?%;width:%?496?%}.middle-select uni-input[data-v-02bda258]{height:%?80?%;line-height:%?80?%;font-size:%?30?%;padding-left:%?20?%}.middle-select uni-text[data-v-02bda258]{color:#ffb822;font-size:%?26?%;width:%?200?%}.middle-select uni-image[data-v-02bda258]{width:%?40?%;height:%?40?%;padding-right:%?20?%;padding-top:%?20?%}.sweepCode[data-v-02bda258]{border-bottom:%?2?% #eee solid;display:flex;justify-content:space-between}.sweepCode uni-image[data-v-02bda258]{width:%?48?%;height:%?48?%;padding:%?26?% %?100?%}.order-item[data-v-02bda258]{padding:%?40?% %?40?% 0 %?40?%}.order-item-top[data-v-02bda258]{display:flex}.order-item-left[data-v-02bda258]{width:%?160?%;height:%?160?%}.order-inside[data-v-02bda258]{display:flex;box-sizing:border-box;flex-direction:column;justify-content:space-between}.inside-left[data-v-02bda258]{width:70%}.inside-right[data-v-02bda258]{width:30%;align-items:flex-end}.order-item-right[data-v-02bda258]{margin-left:%?20?%;\r\n\t/* width: calc( 100% - 160upx); */display:flex;flex:1;justify-content:space-between}.order-fir[data-v-02bda258]{display:flex;justify-content:space-between}.order-fir-left[data-v-02bda258]{font-size:%?32?%;font-weight:500;width:%?350?%}.order-fir-right[data-v-02bda258]{font-size:%?32?%;font-weight:500}.order-sec[data-v-02bda258]{margin-top:%?20?%;display:flex;justify-content:space-between}.order-sec-left[data-v-02bda258]{font-size:%?28?%;color:grey}.order-sec-right[data-v-02bda258]{font-size:%?28?%;color:#3378ff}.order-item-bottom[data-v-02bda258]{margin-top:%?20?%}.bottom-fir[data-v-02bda258]{padding:%?20?%;display:flex;justify-content:space-between;border-bottom:%?1?% solid #eee;border-top:%?1?% solid #eee}.bottom-des[data-v-02bda258]{font-size:%?28?%;color:grey}.bottom-input[data-v-02bda258]{display:flex;align-items:center;flex-direction:column;justify-content:space-between;flex:1}.bottom-input uni-input[data-v-02bda258]{margin-top:%?20?%;font-size:%?32?%;color:#333;text-align:center}.bottom-sec[data-v-02bda258]{height:%?70?%;line-height:%?70?%;display:flex;font-size:%?28?%}.bottom-sec-des[data-v-02bda258]{color:grey}.bottom-sec-input[data-v-02bda258]{height:%?40?%;line-height:%?40?%;margin-top:%?10?%;color:grey;font-size:%?28?%}.order-item-foot[data-v-02bda258]{margin-top:%?40?%;border-bottom:%?1?% solid #eee}.foot-des[data-v-02bda258]{margin:0 auto;display:flex;font-size:%?24?%;color:grey;width:20%;justify-content:space-between;padding:%?15?% 0;margin-bottom:%?20?%}.foot-des uni-image[data-v-02bda258]{width:%?17?%;height:%?10?%;margin-top:%?10?%}.footfixed[data-v-02bda258]{display:block;position:fixed;bottom:%?0?%;\r\n\r\n\t\t/* // bottom:100upx; */\r\nwidth:100%;height:%?100?%;background:#fff;z-index:10}.foot-bg[data-v-02bda258]{display:flex}.foot-bg-left[data-v-02bda258]{display:flex;width:70%;font-size:%?32?%;font-weight:500;text-align:center;line-height:%?100?%}.foot-bg-left uni-image[data-v-02bda258]{width:%?48?%;height:%?48?%;margin:%?25?% %?20?% 0 %?90?%}.foot-bg-right[data-v-02bda258]{width:30%;height:%?100?%;line-height:%?100?%;text-align:center;background:#ffb822;font-size:%?32?%;color:#fff}.foot-bg-left uni-text[data-v-02bda258]{color:red}\r\n\r\n/* 历史售价 */.modal-box[data-v-02bda258]{width:100%;height:100%;position:fixed;background:rgba(51,51,51,.6);top:0;left:0;z-index:999}.modal-body[data-v-02bda258]{width:%?670?%;height:%?970?%;background:#fff;margin:%?200?% auto 0 auto;border-radius:%?10?%}.modal-title[data-v-02bda258]{display:block;width:100%;height:%?120?%;line-height:%?120?%;text-align:center;font-size:%?32?%;font-weight:500;color:#333}.modal-item[data-v-02bda258]{display:flex;font-size:%?28?%;font-weight:400;color:#666;height:%?60?%;line-height:%?60?%;justify-content:space-between;padding:0 %?30?%;height:%?740?%}.modal-item-lef uni-text[data-v-02bda258]:last-child{margin-left:%?30?%}.modal-foot[data-v-02bda258]{height:%?100?%;line-height:%?100?%;text-align:center;border-top:%?1?% solid #eee;font-size:%?28?%;font-weight:400}.foot-bg-left uni-text[data-v-02bda258]{padding:5px}.colorGray[data-v-02bda258]{color:grey}",""]),t.exports=e},"7d39":function(t,e,i){"use strict";(function(t){i("6a54");var a=i("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c9b5"),i("bf0f"),i("ab80"),i("5c47"),i("a1c1"),i("d4b5"),i("fd3c"),i("aa9c"),i("8f71"),i("dd2b"),i("e838"),i("bd06"),i("c223");var s=a(i("9b1b")),n=a(i("8824")),o=i("8f59"),u={data:function(){return{date:this.timeShift.getDate({format:!0}),noPriceChangeAllowed:!1,startDate:this.timeShift.getDate("start"),endDate:this.timeShift.getDate("end"),appointment:this.timeShift.getDate({format:!0}),colorGray:!0,handleName:"",handleNameId:0,businessName:"",businessNameId:0,employees:{},supplierName:"",supplierId:0,supplier:{},storehouseName:"",storehouseId:0,storehouse:{},purchaseList:[],orderStat:!1,originalData:[],againPurchaseList:[],purchaseId:0,itemPrice:0,scatteredPrice:0,organizationName:"",organizationId:0,purchaseType:0,againPurchseId:0,other:"请选择合同交货日期",searchText:"",goodsRemark:"",saleBillId:"",saleNo:"",defaultValue:0,barcode:"",lengthVal:!1,inputValue:"",pageNum:1,scanningPage:!1,total:0,purchaseNo:"",purchaseNewNo:"",strogeobj:{},useMultUnit:!1}},methods:(0,s.default)((0,s.default)({},(0,o.mapMutations)(["setparams"])),{},{reEdit:function(e){var i=this;if(t.log("reObj",e),e){this.againPurchseId=e.id,this.supplierName=e.supplierName,this.supplierId=e.supplierId,this.storehouseName=e.storehouseName,this.storehouseId=e.storehouseId,this.other=this.timeShift.getDate(e.requireDate).toString(),this.handleName=e.operatorName,this.handleNameId=e.operatorId,this.businessName=e.salesmanName,this.businessNameId=e.salesmanId,this.purchaseNo=e.purchaseNo,this.colorGray=!1,this.orderStat=!0,uni.showLoading({title:"加载中",mask:!0}),this.get("api/purchase/detail/list?purchaseId="+this.againPurchseId,null,1).then((function(e){if(e.meta.success){uni.hideLoading(),t.log("res------",e);for(var a=e.data.list,s=0;s<a.length;s++)a[s].picture||(a[s].picture="../../../static/img/outNote/photo.png"),a[s].orderQuantity||(a[s].orderQuantity=0),i.useMultUnit&&(a[s]=Object.assign({},a[s],{modePrice:a[s].specUnitPrice,itemQuantity:a[s].specUnitQuantity,multipleUnitSpecification:a[s].conversionRate}));var n=JSON.parse(JSON.stringify(a).replace(/getIP/g,"saleIP").replace(/getSP/g,"saleSP"));i.purchaseList=n,uni.setStorageSync("purchaseNote",i.purchaseList),i.againPurchaseList=i.purchaseList}}))}},bindDateChange:function(t){this.date=t.target.value},contractDate:function(e){t.log("e-------~~~~",e),this.appointment=e.target.value,this.other=this.appointment,this.colorGray=!1},selectSupplier:function(){t.log("选择供应商"),this.setparams({searchtype:"supplier",filed:"supplier"}),uni.navigateTo({url:"../components/toolssearchlist/toolssearchlist"})},selectStorehouse:function(){t.log("选择机构仓库"),this.setparams({searchtype:"storehouse",filed:"storehouse"}),uni.navigateTo({url:"../components/toolssearchlist/toolssearchlist"})},handlersList:function(t){this.handleNum=t,this.setparams({searchtype:"employees",filed:"employees"}),uni.navigateTo({url:"../components/toolssearchlist/toolssearchlist"})},commodityList:function(){this.supplierName?this.storehouseName?(this.setparams({storehouseId:this.storehouseId,type:1,billtype:"purchaseNote",supplierId:this.supplierId}),uni.navigateTo({url:"../commodityList/commodityList"})):uni.showToast({icon:"none",title:"请选择机构仓库",duration:2e3}):uni.showToast({icon:"none",title:"请选择供应商",duration:2e3})},scanning:function(){var t=this;this.supplierName?this.storehouseName?uni.scanCode({success:function(e){t.inputValue=e.result.toString(),t.getCommodity()}}):uni.showToast({icon:"none",title:"请选择机构仓库",duration:2e3}):uni.showToast({icon:"none",title:"请选择供应商",duration:2e3})},getCommodity:function(){var t=this,e=this;this.get("api/basicData/goods/bill/list",{barCode:this.RegExp.Num13(e.inputValue)?e.inputValue:"",pageNum:this.pageNum,pageSize:10,storehouseId:e.storehouseId},1).then((function(i){if(i.meta.success){e.scanningPage=i.data.hasNextPage;var a=i.data.list;if(a.length>0){var s=[];a.map((function(t,e){s.push(Object.assign({},t,{itemQuantity:0},{scatteredQuantity:0}))}));for(var o=0;o<a.length;o++)s[o].picture||(s[o].picture="../../../static/img/outNote/photo.png"),s[o].barCode||(s[o].barCode=""),s[o].brandName||(s[o].brandName="");t.purchaseList=n.default.unique(t.purchaseList,s),t.orderStat=!0}else uni.showToast({title:"暂无该商品",icon:"none"});e.searchText=""}}))},defaultV:function(){if(0==this.purchaseList.length)uni.showToast({title:"请先添加商品",icon:"none",duration:1e3}),this.defaultValue=0;else for(var t=0;t<this.purchaseList.length;t++)this.purchaseList[t].itemQuantity=this.defaultValue},previewPhoto:function(t){n.default.previewPhoto(t,this.purchaseList)},closeOpen:function(t,e){this.purchaseList[e].checked=!this.purchaseList[e].checked,this.$forceUpdate()},delectItem:function(t,e){var i=this,a=this,s=this.againPurchaseList.filter((function(t){return t.id==a.purchaseList[e].id}));this.purchaseType&&s.length?this.del("api/purchase/detail/"+a.purchaseList[e].id,null,1).then((function(t){t.meta.success?(i.purchaseList.splice(e,1),uni.showToast({title:"该订单删除明细成功",icon:"none",duration:1e3})):uni.showToast({title:t.meta.message,icon:"none",duration:1e3})})):this.purchaseList.splice(e,1),this.purchaseList.length>0&&uni.setStorageSync("purchaseNote",this.purchaseList),0==this.purchaseList.length&&(this.orderStat=!1,uni.removeStorageSync("purchaseNote"))},priceIP:function(t,e){if(this.useMultUnit)this.getMultUnitChange(e,{modePrice:t.detail.value});else{var i=this.purchaseList[e];i.saleIP=this.RegExp.floatRound4(t.detail.value),i.saleSP=this.RegExp.floatRound4(i.saleIP/parseFloat(i.packingSpecification));var a=parseFloat(i.itemQuantity)*parseFloat(i.saleIP),s=parseFloat(i.scatteredQuantity)*parseFloat(i.saleSP);i.amount=parseFloat(a+s).toFixed(4)}},numberIP:function(t,e){if(this.useMultUnit)this.getMultUnitChange(e,{itemQuantity:t.detail.value});else{var i=this.purchaseList[e];i.itemQuantity=this.RegExp.floatRound4(t.detail.value);var a=parseFloat(i.itemQuantity)*parseFloat(i.saleIP),s=parseFloat(i.scatteredQuantity)*parseFloat(i.saleSP);i.amount=parseFloat(a+s).toFixed(4)}},priceSP:function(t,e){var i=this.purchaseList[e];i.saleSP=this.RegExp.floatRound4(t.detail.value),i.saleIP=this.RegExp.floatRound4(parseFloat(i.saleSP)*parseFloat(i.packingSpecification));var a=parseFloat(i.itemQuantity)*parseFloat(i.saleIP),s=parseFloat(i.scatteredQuantity)*parseFloat(i.saleSP);i.amount=parseFloat(a+s).toFixed(4)},numberSP:function(t,e){var i=this.purchaseList[e];i.scatteredQuantity=this.RegExp.floatRound4(t.detail.value);var a=parseFloat(i.itemQuantity)*parseFloat(i.saleIP),s=parseFloat(i.scatteredQuantity)*parseFloat(i.saleSP);i.amount=parseFloat(a+s).toFixed(4)},modifyPurchase:function(e){var i=new Date(this.appointment).getTime(),a=this.date.split("-"),s=new Date,n=a[0]==s.getFullYear(),o=a[1]==s.getMonth()+1,u=a[2]==s.getDate();a=n&&o&&u?(new Date).getTime():new Date(this.date.split("-").join("/")).getTime(),uni.showLoading({title:"加载中",mask:!0}),this.post("api/purchase/main/"+e+"?fillDate="+a+"&organizationId="+this.organizationId+"&organizationName="+this.organizationName+"&requireDate="+i+"&storehouseId="+this.storehouseId+"&storehouseName="+this.storehouseName+"&supplierId="+this.supplierId+"&supplierName="+this.supplierName,null,1).then((function(e){uni.hideLoading(),t.log("res-------2 :",e)}))},emptyPurchase:function(){var e=this;return new Promise((function(i,a){var s=e;e.storehouseId&&e.post("api/purchase/101/main",{},1).then((function(e){e.meta.success&&(t.log("res-------1 :",e),s.purchaseId=e.data.id,s.modifyPurchase(s.purchaseId),i())}))}))},creatPurchase:function(){var t=this,e=this;if(this.againPurchseId){var i=this.purchaseList.filter((function(e){return-1==t.againPurchaseList.findIndex((function(t){return e.id===t.id}))}));i.length>0?(this.originalData=this.purchaseList.filter((function(t){return-1==i.findIndex((function(e){return t.id===e.id}))})),this.useMultUnit?this.recursiveMultSubmit(-1,e.originalData):this.recursiveSubmit(-1,e.originalData),e.purchaseId=e.againPurchseId,e.latestSubmission(-1,i)):this.useMultUnit?this.recursiveMultSubmit(-1,e.purchaseList):this.recursiveSubmit(-1,e.purchaseList)}else this.emptyPurchase().then((function(){t.latestSubmission(-1,e.purchaseList)}))},recursiveSubmit:function(t,e){var i=this;++t<e.length?(uni.showLoading({title:"加载中",mask:!0}),this.post("api/purchase/detail/"+e[t].id+"?discount="+e[t].discount+"&getIP="+e[t].saleIP+"&getSP="+e[t].saleSP+"&itemQuantity="+e[t].itemQuantity+"&scatteredQuantity="+e[t].scatteredQuantity,{},1).then((function(a){uni.hideLoading(),a.meta.success&&i.recursiveSubmit(t,e)}))):(uni.showToast({title:"开单成功",icon:"none",duration:1e3}),setTimeout((function(){uni.navigateTo({url:"../../publicPage/billSuccess/billSuccess?sourceType=101&saleNo="+i.purchaseNo+"&id="+i.againPurchseId}),i.doRefresh()}),1e3))},recursiveMultSubmit:function(t,e){var i=this;++t<e.length?(uni.showLoading({title:"加载中",mask:!0}),this.patch("api/purchase/detail/"+e[t].id+"?discount="+e[t].discount+"&getIP="+e[t].saleIP+"&getSP="+e[t].saleSP+"&itemQuantity="+e[t].itemQuantity+"&scatteredQuantity="+e[t].scatteredQuantity+"&specUnitPrice="+e[t].modePrice+"&multiunitId="+e[t].multiunitId+"&specUnitQuantity="+e[t].itemQuantity+"&purchaseId="+i.againPurchseId,{},1).then((function(a){uni.hideLoading(),a.meta.success&&i.recursiveMultSubmit(t,e)}))):(uni.showToast({title:"开单成功",icon:"none",duration:1e3}),setTimeout((function(){uni.navigateTo({url:"../../publicPage/billSuccess/billSuccess?sourceType=101&saleNo="+i.purchaseNo+"&id="+i.againPurchseId}),i.doRefresh()}),1e3))},latestSubmission:function(t,e){var i=this;if(++t<e.length){uni.showLoading({title:"加载中",mask:!0});var a={discount:"0",getIP:e[t].saleIP,getSP:e[t].saleSP,goodsId:e[t].id,goodsName:e[t].goodsName,itemQuantity:e[t].itemQuantity,scatteredQuantity:e[t].scatteredQuantity,meteringType:1,sort:2,storehouseId:i.storehouseId,storehouseName:i.storehouseName};this.useMultUnit&&(a["specUnitPrice"]=e[t].modePrice,a["multiunitId"]=e[t].multiunitId,a["specUnitQuantity"]=e[t].itemQuantity),this.post("api/purchase/"+i.purchaseId+"/detail",a,1).then((function(a){uni.hideLoading(),a.meta.success?(i.latestSubmission(t,e),i.purchaseNewNo=a.data.purchaseNo):uni.showToast({title:a.meta.message,icon:"none",duration:1e3})}))}else uni.showToast({title:"开单成功",icon:"none",duration:1e3}),setTimeout((function(){uni.navigateTo({url:"../../publicPage/billSuccess/billSuccess?sourceType=101&saleNo="+i.purchaseNewNo+"&id="+i.purchaseId}),this.doRefresh()}),1e3)},goBack:function(){uni.navigateBack({delta:1})},clearAllDate:function(){var t=this;uni.showModal({title:"温馨提示",content:"是否清空当前页面数据",success:function(e){e.confirm?(t.doRefresh(!0),t.$forceUpdate(),t.orderStat=!1):e.cancel}})},doRefresh:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.storehouseName="",this.storehouseId="",this.purchaseList=[],this.$data.warehouseName="",this.handleName="",this.handleNameId="",this.businessName="",this.businessNameId="",this.businessNameId="",this.supplierName="",this.saleBillId="",this.supplierId="",this.colorGray=!0,this.other="请选择合同交货日期",uni.removeStorageSync("purchaseNote"),t&&uni.removeStorageSync("purchaseNoteTemp")},toHistory:function(){uni.setStorageSync("Type",101),uni.switchTab({url:"/pages/documentHistorys/index"})},getSelectUnit:function(e){var i=this,a=this.purchaseList[e],s={goodsId:a.goodsId?a.goodsId:a.id,supplierId:this.supplierId};i.$store.dispatch("getPurchasePrice",s).then((function(a){if(a.meta.success){if(!a.data.specUnitList.length)return void uni.showToast({icon:"none",title:"该商品没有设置多单位!",duration:2e3});var s=a.data.specUnitList;uni.showActionSheet({itemList:s.map((function(t){return"".concat(t.name," (1x").concat(t.packingSpecification,")")})),success:function(a){var n=s[a.tapIndex];t.log("selected",n),i.getMultUnitChange(e,n)},fail:function(e){t.log(e.errMsg)}})}else uni.showToast({icon:"none",title:a.meta.message,duration:2e3})}))},getMultUnitChange:function(t,e){var i=this.purchaseList[t];e.modePrice&&(i.modePrice=e.modePrice),e.itemQuantity&&(i.itemQuantity=e.itemQuantity),e.id&&(i.multiunitId=e.id,i.specUnit=e.name,i.modePrice=e.modePrice,i.multipleUnitSpecification=e.packingSpecification),i.amount=(i.modePrice*i.itemQuantity).toFixed(4),this.$set(this.purchaseList,t,i),uni.hideKeyboard()}}),onLoad:function(t){var e=uni.getStorageSync("privilegeMap");if(1==e.priceAuth&&(this.noPriceChangeAllowed=!0),t.purchaseType){if(this.purchaseType=t.purchaseType,this.orderStat=!0,uni.getStorageSync("againPurchase")){var i=uni.getStorageSync("againPurchase");this.reEdit(i),uni.removeStorageSync("againPurchase")}}else uni.removeStorageSync("purchaseNote");this.useMultUnit=uni.getStorageSync("useMultUnit")},onShow:function(){var e=uni.getStorageSync("purchaseNote");if(0!=e.length){var i=uni.getStorageSync("purchaseNote");this.purchaseList=(i||[]).map((function(t){return(0,s.default)((0,s.default)({},t),{},{modePrice:t.modePrice||t.specUnitPrice,itemQuantity:t.itemQuantity||t.specUnitQuantity||0})})),t.log("this.purchaseList:",this.purchaseList),this.orderStat=!0}else this.orderStat=!1;var a=uni.getStorageSync("purchaseNoteTemp");null!=a&&""!=a&&(this.strogeobj=a,this.storehouseName=this.strogeobj.storehouseName,this.storehouseId=this.strogeobj.storehouseId,this.organizationName=this.strogeobj.organizationName,this.organizationId=this.strogeobj.organizationId)},watch:{supplier:function(t){this.supplierName=t[0].name,this.supplierId=t[0].id},storehouse:function(t){this.storehouseName=t[0].name,this.storehouseId=t[0].id,this.organizationName=t[0].authOrganizationName,this.organizationId=t[0].organizationId,this.strogeobj.storehouseName=this.storehouseName,this.strogeobj.storehouseId=this.storehouseId,this.strogeobj.organizationName=this.organizationName,this.strogeobj.organizationId=this.organizationId,uni.setStorageSync("purchaseNoteTemp",this.strogeobj)},employees:function(t){null!=t&&t.length>0&&(this.handleNum?(this.businessName=t[0].name,this.businessNameId=t[0].id):(this.handleName=t[0].name,this.handleNameId=t[0].id))},purchaseList:{handler:function(e,i){t.log("newValue",e);for(var a=[],s=0;s<e.length;s++){e[s].amount||(e[s].amount=0),a.push(parseFloat(e[s].amount).toFixed(4));for(var n=0,o=a.length-1;o>=0;o--)n+=parseFloat(a[o]),this.total=n.toFixed(4)}},deep:!0}},onReachBottom:function(){this.scanningPage?(uni.showLoading({title:"玩命加载中...",mask:!0}),this.pageNum++,this.getCommodity(),uni.hideLoading()):uni.showToast({title:"暂无更多数据",duration:1e3,icon:"loading",mask:!0})}};e.default=u}).call(this,i("ba7c")["default"])},"846e":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoAQMAAAC2MCouAAAABlBMVEVHcEyXl5c3HTAeAAAAAXRSTlMAQObYZgAAADNJREFUCNdjYCAG8DAYwEjm////H4CRQBE4CVQAJ5HVIIsjk/w2H+AkbjUIEpcaJLuIAABy9Sm5sM//IAAAAABJRU5ErkJggg=="},8824:function(t,e,i){"use strict";i("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("fd3c"),i("c223"),i("aa9c"),i("5ef2"),i("20f3");var a={previewPhoto:function(t,e){var i=e.map((function(t,e){return t.picture}));uni.previewImage({current:i[t],urls:i})},unique:function(t,e){for(var i=t.concat(e),a={},s=[],n=0;n<i.length;n++)a["s_"+i[n].id]=i[n];for(var o in a)s.push(a[o]);return s},IsPicture:function(t){if(t&&t.indexOf(".")>-1){var e=t.lastIndexOf("."),i=t.substring(e,t.length)+"|";if(i=i.toLowerCase(),".jpeg|.gif|.jpg|.png|.bmp|.pic|.svg|".indexOf(i)>-1)return!0}return!1}};e.default=a},9796:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwBAMAAAClLOS0AAAAElBMVEVHcEz/uCL/uSP/uCL/vCL/uCJcCjI6AAAABXRSTlMA50mtJj8sjiYAAABlSURBVDjLY2AgHbAYhmIAYQeghGMoFiAClDDFJhEMlBDFJhEIlAgNxbQXLDbEJEQDMSXAYopCmBLYxAYHUAzFCoSwRyAoCnFK4DRqsHodV0ThjNphk3ZxZU6c2RlnAYCzyCAVAACHaG1xFoswbQAAAABJRU5ErkJggg=="},"9ec0":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwAgMAAAAqbBEUAAAADFBMVEVHcEz/uCL/uSP/uCITuKUYAAAAA3RSTlMA4kmZPqyEAAAALklEQVQoz2NgAAHOBAYEYL+AxOH/MKI58//DwTeGegTnLyoHRdlouGFLSNAkBgCQylhTmhAbcAAAAABJRU5ErkJggg=="},adcc:function(t,e,i){"use strict";i.r(e);var a=i("7d39"),s=i.n(a);for(var n in a)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(n);e["default"]=s.a},b1ae:function(t,e,i){"use strict";i.r(e);var a=i("37e1"),s=i("adcc");for(var n in s)["default"].indexOf(n)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(n);i("c6c3");var o=i("828b"),u=Object(o["a"])(s["default"],a["b"],a["c"],!1,null,"02bda258",null,!1,a["a"],void 0);e["default"]=u.exports},c6c3:function(t,e,i){"use strict";var a=i("07f7"),s=i.n(a);s.a}}]);