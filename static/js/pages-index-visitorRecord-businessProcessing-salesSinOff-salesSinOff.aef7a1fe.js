(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-visitorRecord-businessProcessing-salesSinOff-salesSinOff"],{"0a06":function(t,i,e){"use strict";var n=e("d4d7"),o={fxVisitCustomerPage:function(t){return(0,n.get)("fx/fxVisitCustomer/page",t,3)},fxVisitMainSave:function(t){return(0,n.post)("fx/fxVisitMain/save",t,3)},fxVisitCustomerCollectCoordinate:function(t){return(0,n.post)("fx/fxVisitCustomer/collectCoordinate",t,3)},fxVisitFilesImgCollection:function(t){return(0,n.post)("fx/fxVisitFiles/imgCollection",t,3)},fxVisitFilesExceptionReport:function(t){return(0,n.post)("fx/fxVisitFiles/exceptionReport",t,3)},getFxVisitMain:function(t,i){return(0,n.get)("fx/fxVisitMain/"+t,i,3)},fxVisitMainVisitingRecord:function(t){return(0,n.get)("fx/fxVisitMain/visitingRecord",t,3)},fxVisitMainVisitingDetails:function(t){return(0,n.get)("fx/fxVisitMain/visitingDetails",t,3)},fxVisitCustomerCustomerList:function(t){return(0,n.get)("fx/fxVisitCustomer/customerList",t,3)},fxVisitFilesDelete:function(t){return(0,n.post)("fx/fxVisitFiles/delete?ids="+t,null,3)},fxVisitCustomerImport:function(){return(0,n.post)("fx/fxVisitCustomer/customerImport",null,3)},fxVisitCustomerTargetDeleteSaveOrUpdate:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/saveOrUpdate",t,3)},fxVisitCustomerTargetDelete:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/delete?id="+t.id,null,3)},findOrderTargetByDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDate",t,3)},fxVisitCustomerTargetList:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/list",t,3)},fxVisitCustomerTargetBatchAddTarget:function(t){return(0,n.post)("fx/fxVisitCustomerTarget/batchAddTarget",t,3)},findOrderTargetByDifDate:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/findOrderTargetByDifDate",t,3)},updateSort:function(t){return(0,n.get)("fx/fxVisitCustomerTarget/updateSort",t,3)},dictionnary:function(t){return(0,n.get)("api/basedata/dictionnary/page",t,1)},category:function(t){return(0,n.get)("fx/fxVisitMain/category",t,3)},fxVisitOption:function(t){return(0,n.post)("fx/fxVisitOption",t,3)},checkCustomer:function(t){return(0,n.get)("dat/datCustomer/checkCustomer",t,9)},collectMainPage:function(t){return(0,n.get)("collect/collectMain/page",t,9)},collectMainSave:function(t){return(0,n.post)("collect/collectMain/save",t,9)},collectMainDelete:function(t){return(0,n.get)("collect/collectMain/delete",t,9)},getCollectMainById:function(t){return(0,n.get)("collect/collectMain/findInfo",t,9)},collectDetailDelete:function(t){return(0,n.get)("collect/collectDetail/delete",t,9)},fxVisitCustomerDelete:function(t){return(0,n.get)("fx/fxVisitCustomer/delete",t,3)},customerNameUnite:function(t){return(0,n.get)("fx/fxVisitMain/customerNameUnite",t,3)}};t.exports=o},"12f6":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"contain"},[e("tx-map-position",{ref:"position"}),e("v-uni-textarea",{staticClass:"textarea",style:{width:t.textareaWidth+"px",paddingLeft:t.textareaPaddingLeftWidth+"px",paddingRight:t.textareaPaddingLeftWidth+"px"},attrs:{"adjust-position":!1,placeholder:t.placeholder[t.isNormalSignOff?0:1],maxlength:"1000"},model:{value:t.textarea,callback:function(i){t.textarea=i},expression:"textarea"}}),e("v-uni-view",{staticClass:"foot-buttons"},[e("v-uni-text",{staticClass:"foot-item foot-left",on:{touchstart:function(i){arguments[0]=i=t.$handleEvent(i),t.submitConfirm.apply(void 0,arguments)}}},[t._v("确认")]),e("v-uni-text",{staticClass:"foot-item foot-right",on:{touchstart:function(i){arguments[0]=i=t.$handleEvent(i),t.goBack.apply(void 0,arguments)}}},[t._v("返回")])],1)],1)},o=[]},"208a":function(t,i,e){"use strict";e.r(i);var n=e("12f6"),o=e("ac08");for(var a in o)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return o[t]}))}(a);e("db96b");var s=e("828b"),r=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"5c04d7bc",null,!1,n["a"],void 0);i["default"]=r.exports},9040:function(t,i,e){"use strict";(function(t){e("6a54");var n=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("c223");var o=n(e("0a06")),a={components:{},data:function(){return{windowWidth:0,windowHeight:0,textareaWidth:0,textareaPaddingLeftWidth:15,visitSignIn:"",textarea:"",isNormalSignOff:!0,placeholder:["请输入你的访销总结,可输入1000字.","请提交签退异常申请,可输入1000字."],applyData:null,isBill:!1}},mounted:function(){},onLoad:function(t){var i=this;i.isBill=!(!t.isBill||"1"!==t.isBill),uni.getSystemInfo({success:function(t){i.windowWidth=t.windowWidth,i.windowHeight=t.windowHeight,i.textareaWidth=t.windowWidth-2*i.textareaPaddingLeftWidth}}),this.visitSignIn=uni.getStorageSync("visitSignIn")},created:function(){this.$scope.$getAppWebview().setStyle({softinputNavBar:"block"})},computed:{},onShow:function(){this.visitSignIn.signInId&&this.init()},methods:{init:function(){var t=this,i={id:t.visitSignIn.signInId,type:3};o.default.getFxVisitMain(t.visitSignIn.signInId,i).then((function(i){i.meta.success?t.textarea=i.data.obj.visitSummary:uni.showToast({title:i.meta.message,icon:"none",duration:1e3})}))},bindTextAreaBlur:function(t){this.textarea=t.detail.value},bindTextInput:function(t){this.textarea=t.detail.value},goBack:function(){uni.navigateBack({delta:1})},submitConfirm1:function(){var i=this;if(i.textarea){if(!i.isNormalSignOff)return i.apply();uni.showLoading({title:"获取地址中...",mask:!0}),uni.getLocation({type:"gcj02",geocode:!0,success:function(e){var n=new plus.maps.Point(e.longitude,e.latitude);plus.maps.Map.reverseGeocode(n,{},(function(n){var a={id:i.visitSignIn.signInId,singnOutCoordinate:"".concat(e.longitude,",").concat(e.latitude),singnOutAddress:n.address,type:2,longitude:e.longitude,latitude:e.latitude,visitSummary:i.textarea};t.log("params：",a),o.default.fxVisitMainSave(a).then((function(t){t.meta.success?void 0!==t.data.obj.exceptionStatus?(uni.showToast({title:"签退失败, 请提交签退异常申请",icon:"none",duration:1e3}),setTimeout((function(){uni.setNavigationBarTitle({title:"提交签退异常申请"}),i.textarea="",i.isNormalSignOff=!1,i.applyData=a}),800)):(uni.showToast({title:"保存成功",icon:"none",duration:1e3}),uni.removeStorageSync("visitSignIn"),uni.removeStorageSync("singninAddress"),uni.navigateBack({delta:i.isBill?3:1})):uni.showToast({title:t.meta.message,icon:"none",duration:1e3})}))}),(function(t){}))},fail:function(t){uni.hideLoading(),uni.showToast({title:"获取坐标失败,检查是否开启定位",icon:"none",duration:1e3})},complete:function(t){uni.hideLoading()}})}else uni.showToast({title:"请填写签退内容",icon:"none",duration:1e3})},txPosition:function(){var t=this;this.$refs.position.startPositioning((function(i){var e=i.province+i.city+i.addr,n={id:t.visitSignIn.signInId,singnOutCoordinate:"".concat(i.lng,",").concat(i.lat),singnOutAddress:e,type:2,longitude:i.lng,latitude:i.lat,visitSummary:t.textarea};o.default.fxVisitMainSave(n).then((function(i){i.meta.success?void 0!==i.data.obj.exceptionStatus?(uni.showToast({title:"签退失败, 请提交签退异常申请",icon:"none",duration:1e3}),setTimeout((function(){uni.setNavigationBarTitle({title:"提交签退异常申请"}),t.textarea="",t.isNormalSignOff=!1,t.applyData=n}),800)):(uni.showToast({title:"保存成功",icon:"none",duration:1e3}),uni.removeStorageSync("visitSignIn"),uni.removeStorageSync("singninAddress"),uni.navigateBack({delta:t.isBill?3:1})):uni.showToast({title:i.meta.message,icon:"none",duration:1e3})})),uni.hideLoading()}))},submitConfirm:function(){if(this.textarea){if(!this.isNormalSignOff)return this.apply();uni.showLoading({title:"获取地址中...",mask:!0}),this.txPosition()}else uni.showToast({title:"请填写签退内容",icon:"none",duration:1e3})},apply:function(){var t={visitId:this.visitSignIn.signInId,exceptionAddress:this.applyData.singnOutAddress,exceptionCoordinate:this.applyData.singnOutCoordinate,remark:this.textarea};o.default.fxVisitOption(t).then((function(t){t.meta.success?(uni.showToast({title:"提交成功",icon:"none",duration:1e3}),setTimeout((function(){uni.navigateBack({delta:1})}),800)):uni.showToast({title:t.meta.message,icon:"none",duration:1e3})}))}}};i.default=a}).call(this,e("ba7c")["default"])},ac08:function(t,i,e){"use strict";e.r(i);var n=e("9040"),o=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=o.a},c846:function(t,i,e){var n=e("c86c");i=n(!1),i.push([t.i,".contain[data-v-5c04d7bc]{flex:1;display:flex;flex-direction:column;height:100%;background-color:#f6f6f6}.textarea[data-v-5c04d7bc]{flex:1;width:100%;padding-top:%?20?%;padding-bottom:%?20?%;background-color:#fff}.foot-buttons[data-v-5c04d7bc]{display:flex;flex-direction:row;justify-content:center;align-items:center}.foot-item[data-v-5c04d7bc]{flex:1;display:flex;flex-direction:row;justify-content:center;align-items:center;height:%?80?%;font-size:%?32?%;line-height:%?80?%;text-align:center;color:#fff;background-color:#ffc235}.foot-left[data-v-5c04d7bc]{background-color:#f13a3a}",""]),t.exports=i},db96b:function(t,i,e){"use strict";var n=e("e10c"),o=e.n(n);o.a},e10c:function(t,i,e){var n=e("c846");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=e("967d").default;o("dc821048",n,!0,{sourceMap:!1,shadowMode:!1})}}]);